<html>
<head>
<meta name=vsisbn content="067231486x">
<meta name=vstitle content="Programming Microsoft Windows 2000 Unleashed">
<meta name=vsauthor content="MICKEY WILLIAMS">
<meta name=vsimprint content="Sams">
<meta name=vspublisher content="Macmillan Computer Publishing">
<meta name=vspubdate content="06/21/99">
<meta name=vscategory content="Operations Systems: Windows 2000">



<title>Programming Microsoft Windows 2000 Unleashed:Windows 2000 Debugging</TITLE>
<!-- BEGIN HEADER -->
<meta name="ROBOTS" content="NOINDEX, NOFOLLOW">
<script>
<!--
function displayWindow(url, width, height) {
        var Win = window.open(url,"displayWindow",'width=' + width +
',height=' + height + ',resizable=1,scrollbars=yes');
}
//--></SCRIPT>

<!-- HEADER -->
<style type="text/css">
<!--
A:hover { color:red }
-->
</STYLE>

<!-- HEADER -->
<style type="text/css"> 
 <!--
 A:hover  {
 	color : Red;
 }
 -->
 </STYLE>

</HEAD>
<BODY bgcolor=#FFFFFF><FONT size=2 face="Arial, verdana, helvetica"><table width=100% border=0 cellspacing=0 cellpadding=2><tr bgcolor=#000000><td width=100% align=right><b><font color=#FFFFFF>Gotcha</font></b></td></tr></table><br><!--Begin Content Column -->

<table border=0 cellspacing=0 cellpadding=0>
<tr>
<td width=75 valign=top>
<img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/images/sm_covers/067231486x.gif" width=60 height=73 alt="Programming Microsoft Windows 2000 Unleashed" border="1">
</td>
<td align="left">
    <font face="arial, helvetica" size="-1" color="#336633"><b>Programming Microsoft Windows 2000 Unleashed</b></font>
    <br>
    <font face="arial, helvetica" size="-1"><i>by MICKEY WILLIAMS</i>
    <br>
    Sams,&nbsp;Macmillan Computer Publishing
    <br>
    <b>ISBN:</b>&nbsp;067231486x<b>&nbsp;&nbsp;&nbsp;Pub Date:</b>&nbsp;06/21/99</font>
</td>
</tr>
</table>
<p>
<!-- Empty Reference Subhead-->

<!--ISBN=067231486x//-->
<!--TITLE=Programming Microsoft Windows 2000 Unleashed//-->
<!--AUTHOR=Mickey Williams//-->
<!--PUBLISHER=Macmillan Computer Publishing//-->
<!--IMPRINT=sams//-->
<!--CHAPTER=08//-->
<!--PAGES=276-278//-->
<!--UNASSIGNED1//-->
<!--UNASSIGNED2//-->

<center>
<table border>
<tr>
<td><a href="08-04.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="08-06.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<p><br></P>
<p>As you can see, some entries in <small>AUTOEXP.DAT</SMALL> provide formatting information, and some do not. In general, the formatting information is ignored by the debugger, which uses the formatting options set for the Watch window and Variables window. In any case, the documented values for formatting information are prided in Table 8.1.</P>
<table width="100%"><caption align="LEFT" colspan="3"><b>Table 8.1</B> Values for Auto-expanding Formatting Information
<tr>
<td colspan="3"><hr>
<tr>
<th valign="TOP" width="33%" align="LEFT"><i>Data Type</I>
<th valign="TOP" width="33%" align="LEFT"><i>Description</I>
<th valign="TOP" align="LEFT"><i>Example</I>
<tr>
<td colspan="3"><hr>
<tr>
<td valign="TOP" align="LEFT"><small>d</SMALL>, <small>i</SMALL>
<td valign="TOP" align="LEFT">Signed <small>int</SMALL>
<td valign="TOP" align="LEFT">-5, 20000
<tr>
<td valign="TOP" align="LEFT"><small>u</SMALL>
<td valign="TOP" align="LEFT">Unsigned <small>int</SMALL>
<td valign="TOP" align="LEFT">234345
<tr>
<td valign="TOP" align="LEFT"><small>o</SMALL>
<td valign="TOP" align="LEFT">Unsigned octal <small>int</SMALL>
<td valign="TOP" align="LEFT">0324563
<tr>
<td valign="TOP" align="LEFT"><small>x</SMALL>
<td valign="TOP" align="LEFT">Lowercase hex
<td valign="TOP" align="LEFT">0x3a
<tr>
<td valign="TOP" align="LEFT"><small>X</SMALL>
<td valign="TOP" align="LEFT">Uppercase hex
<td valign="TOP" align="LEFT">0X3ADE
<tr>
<td valign="TOP" align="LEFT"><small>l</SMALL>
<td valign="TOP" align="LEFT">Long prefix
<td valign="TOP" align="LEFT">0x32454345
<tr>
<td valign="TOP" align="LEFT"><small>h</SMALL>
<td valign="TOP" align="LEFT">Short prefix
<td valign="TOP" align="LEFT">0xABCD
<tr>
<td valign="TOP" align="LEFT"><small>f</SMALL>
<td valign="TOP" align="LEFT">Signed floating point
<td valign="TOP" align="LEFT">-1.32
<tr>
<td valign="TOP" align="LEFT"><small>e</SMALL>
<td valign="TOP" align="LEFT">Signed scientific notation
<td valign="TOP" align="LEFT">5.300000e&#43;000
<tr>
<td valign="TOP" align="LEFT"><small>g</SMALL>
<td valign="TOP" align="LEFT">Shorter of either <small>f</SMALL> or <small>e</SMALL>
<td valign="TOP" align="LEFT">5.3
<tr>
<td valign="TOP" align="LEFT"><small>c</SMALL>
<td valign="TOP" align="LEFT">Single character
<td valign="TOP" align="LEFT">a
<tr>
<td valign="TOP" align="LEFT"><small>s</SMALL>
<td valign="TOP" align="LEFT">String
<td valign="TOP" align="LEFT">&#147;Ali&#148;
<tr>
<td valign="TOP" align="LEFT"><small>su</SMALL>
<td valign="TOP" align="LEFT">Unicode string
<td valign="TOP" align="LEFT">&#147;Kenzie&#148;
<tr>
<td valign="TOP" align="LEFT"><small>st</SMALL>
<td valign="TOP" align="LEFT">Generic string
<td valign="TOP" align="LEFT">&#147;Ace&#148;
<tr>
<td colspan="3"><hr>
</TABLE>
<p>As an example of an entry that you might add for your own types, consider the following structure:
</P>
<!-- CODE SNIP //-->
<pre>
// Listing information for a sailboat
struct SailBoat{
     LPTSTR pszName;  // name of the boat
     int    length;   // length of the boat
     int    sailArea; // sail area
};
</PRE>
<!-- END CODE SNIP //-->
<p>Normally, the Visual C<small>&#43;&#43;</SMALL> debugger would not display any information about a <small>SailBoat</SMALL> variable. Adding the following line to <small>AUTOEXP.DAT</SMALL> enables the Visual C<small>&#43;&#43;</SMALL> debugger to provide a DataTip for <small>SailBoat</SMALL> variables as well as automatically display additional information in the Watch and Variables windows:</P>
<!-- CODE SNIP //-->
<pre>
Boat = name=&ltpszName,st&gt length=&ltlength,d&gt sail area=&ltsailArea,d&gt
</PRE>
<!-- END CODE SNIP //-->
<p>After modifying the value of the <small>AUTOEXP.DAT</SMALL> file, you must quit and restart Visual C<small>&#43;&#43;</SMALL> to take advantage of any changed entries.</P>
<h3><a name="Heading14"></A><font color="#000077">Using WINDBG, the Windows Debugger</FONT></H3>
<p>WINDBG is a GUI-based debugger that ships with the Platform SDK. In many ways, it resembles the Visual Studio debugger:
</P>
<dl>
<dd><b>&#149;</B>&nbsp;&nbsp;It can be used to debug at the source level.
<dd><b>&#149;</B>&nbsp;&nbsp;Memory, Watch, Variable, and Call Stack windows are displayed as MDI client windows.
<dd><b>&#149;</B>&nbsp;&nbsp;You can set a variety of breakpoints.
<dd><b>&#149;</B>&nbsp;&nbsp;You can single-step through your code using the same functions and key combinations that the Visual C<small>&#43;&#43;</SMALL> debugger uses.
</DL>
<p>However, unlike the Visual C<small>&#43;&#43;</SMALL> debugger, WINDBG allows you to use kernel debugger commands while debugging. Unfortunately, these commands are not well documented. Some documentation exists in the WINDBG online Help, but it&#146;s not complete.</P>
<h3><a name="Heading15"></A><font color="#000077">Using SoftIce to Debug Programs</FONT></H3>
<p>SoftIce is a third-party debugger that can be used to debug both kernel mode drivers and application programs. Unlike the kernel mode debuggers supplied by Microsoft in the Platform SDK, SoftIce does not require you to dedicate a second computer for debugging&#151;you can debug in kernel mode using a single computer.
</P>
<p>SoftIce allows you to define when it&#146;s loaded. The choice you make depends on the type of debugging support you require from SoftIce. The options are as follows:</P>
<dl>
<dd><b>&#149;</B>&nbsp;&nbsp;<i>Boot</I>. SoftIce is loaded immediately after all boot drivers. This is the earliest possible load option for SoftIce.
<dd><b>&#149;</B>&nbsp;&nbsp;<i>System</I>. SoftIce is loaded after all system drivers have been loaded.
<dd><b>&#149;</B>&nbsp;&nbsp;<i>Automatic</I>. SoftIce is loaded during the last phases of system startup. Use this option if you aren&#146;t debugging core device drivers but need to debug drivers or services.
<dd><b>&#149;</B>&nbsp;&nbsp;<i>On Demand</I>. SoftIce is launched as needed. This mode is typically used when you don&#146;t need to use SoftIce while the system is booting.
</DL>
<p>SoftIce has a number of features that make it the Ferrari of debugging tools. Here are some of my favorite features:
</P>
<dl>
<dd><b>&#149;</B>&nbsp;&nbsp;You can step into Windows 2000 components just as though you were debugging your own code.
<dd><b>&#149;</B>&nbsp;&nbsp;It contains debugging commands that aren&#146;t offered in the Platform SDK debuggers&#151;for example, one-shot breakpoints, which are breakpoints that are automatically removed after they&#146;re used once.
<dd><b>&#149;</B>&nbsp;&nbsp;Best of all, SoftIce comes with a great tutorial and command reference, unlike the tools provided with the Platform SDK.
</DL>
<p>If you&#146;re using SoftIce with a Beta version of Windows 2000, check out the NuMega Web site at <a href="www.numega.com">www.numega.com</A> to determine the proper version of SoftIce to use with your particular build of Windows 2000. SoftIce is tightly coupled to the operating system, and service packs and new operating system releases require an updated copy of SoftIce.</P>
<h3><a name="Heading16"></A><font color="#000077">Using Dr. Watson to Find the Cause of Crashes</FONT></H3>
<p>Dr. Watson is a tool that has long been shipped with Windows operating systems. Dr. Watson is used to generate trace information that can be used to determine the cause of an application crash.
</P>
<p>On Windows 2000 installations that do not have development tools installed, Dr. Watson is installed as the default debugger. When an application crashes, Dr. Watson is launched as the just-in-time debugger, and it creates a log file that contains a number of useful pieces of information, such as information about currently running applications, threads running in the failing process, and call stack information for the calling process.</P>
<p>To install Dr. Watson as the default debugger on a development station, use the following command in a DOS window:</P>
<!-- CODE SNIP //-->
<pre>
drwtsn32 -i
</PRE>
<!-- END CODE SNIP //-->
<p><br></P>
<center>
<table border>
<tr>
<td><a href="08-04.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="08-06.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>


</font></BODY></HTML>