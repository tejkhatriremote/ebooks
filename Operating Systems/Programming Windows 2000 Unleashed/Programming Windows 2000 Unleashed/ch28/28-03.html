<html>
<head>
<meta name=vsisbn content="067231486x">
<meta name=vstitle content="Programming Microsoft Windows 2000 Unleashed">
<meta name=vsauthor content="MICKEY WILLIAMS">
<meta name=vsimprint content="Sams">
<meta name=vspublisher content="Macmillan Computer Publishing">
<meta name=vspubdate content="06/21/99">
<meta name=vscategory content="Operations Systems: Windows 2000">



<title>Programming Microsoft Windows 2000 Unleashed:Using MSMQ</TITLE>
<!-- BEGIN HEADER -->
<meta name="ROBOTS" content="NOINDEX, NOFOLLOW">
<script>
<!--
function displayWindow(url, width, height) {
        var Win = window.open(url,"displayWindow",'width=' + width +
',height=' + height + ',resizable=1,scrollbars=yes');
}
//--></SCRIPT>

<!-- HEADER -->
<style type="text/css">
<!--
A:hover { color:red }
-->
</STYLE>

<!-- HEADER -->
<style type="text/css"> 
 <!--
 A:hover  {
 	color : Red;
 }
 -->
 </STYLE>

</HEAD>
<BODY bgcolor=#FFFFFF><FONT size=2 face="Arial, verdana, helvetica"><table width=100% border=0 cellspacing=0 cellpadding=2><tr bgcolor=#000000><td width=100% align=right><b><font color=#FFFFFF>Gotcha</font></b></td></tr></table><br><!--Begin Content Column -->

<table border=0 cellspacing=0 cellpadding=0>
<tr>
<td width=75 valign=top>
<img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/images/sm_covers/067231486x.gif" width=60 height=73 alt="Programming Microsoft Windows 2000 Unleashed" border="1">
</td>
<td align="left">
    <font face="arial, helvetica" size="-1" color="#336633"><b>Programming Microsoft Windows 2000 Unleashed</b></font>
    <br>
    <font face="arial, helvetica" size="-1"><i>by MICKEY WILLIAMS</i>
    <br>
    Sams,&nbsp;Macmillan Computer Publishing
    <br>
    <b>ISBN:</b>&nbsp;067231486x<b>&nbsp;&nbsp;&nbsp;Pub Date:</b>&nbsp;06/21/99</font>
</td>
</tr>
</table>
<p>
<!-- Empty Reference Subhead-->

<!--ISBN=067231486x//-->
<!--TITLE=Programming Microsoft Windows 2000 Unleashed//-->
<!--AUTHOR=Mickey Williams//-->
<!--PUBLISHER=Macmillan Computer Publishing//-->
<!--IMPRINT=sams//-->
<!--CHAPTER=28//-->
<!--PAGES=935-937//-->
<!--UNASSIGNED1//-->
<!--UNASSIGNED2//-->

<center>
<table border>
<tr>
<td><a href="28-02.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="28-04.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<p><br></P>
<p>Here are the available properties:
</P>
<dl>
<dd><b>&#149;</B>&nbsp;&nbsp;<small>PROPID_Q_AUTHENTICATE</SMALL>. An unsigned char (<small>VT_UI1</SMALL>) that indicates whether the queue requires authenticated messages. A value of <small>MQ_AUTHENTICATE</SMALL> indicates that the queue will pass only authenticated messages. A value of <small>MQ_AUTHENTICATE_NONE</SMALL> indicates that the queue will support authenticated and nonauthenticated messages. If this property is not explicitly set, a value of <small>MQ_AUTHENTICATE_NONE</SMALL> is used.
<dd><b>&#149;</B>&nbsp;&nbsp;<small>PROPID_Q_BASEPRIORITY</SMALL>. A short int (<small>VT_I2</SMALL>) that specifies the base priority for messages placed in the queue. The property applies only to public queues. The range of values for this property is <small>-32768</SMALL> through <small>32767</SMALL>. If this property isn&#146;t set, a default value of <small>0</SMALL> is assumed.
<dd><b>&#149;</B>&nbsp;&nbsp;<small>PROPID_Q_CREATE_TIME</SMALL>. A long int (<small>VT_I4</SMALL>) that indicates the time the queue was created. The time returned is based on the number of seconds after January 1, 1970. This can be used in functions that expect a <small>time_t</SMALL> variable, such as <small>ctime</SMALL>. This property is read-only because it&#146;s set by the operating system.
<dd><b>&#149;</B>&nbsp;&nbsp;<small>PROPID_Q_INSTANCE</SMALL>. A GUID (<small>VT_CLSID</SMALL>) that identifies the queue instance. This property applies only to public queues. This value is set by the operating system when the queue is created and is read-only.
<dd><b>&#149;</B>&nbsp;&nbsp;<small>PROPID_Q_JOURNAL</SMALL>. An unsigned char (<small>VT_UI1</SMALL>) that specifies whether a queue maintains a journal queue. A value of <small>MQ_JOURNAL</SMALL> indicates that an entry is placed into a journal queue for each message successfully removed from the queue. A value of <small>MQ_JOURNAL_NONE</SMALL> indicates that no journal is maintained. If this property isn&#146;t set by the application, the default value is <small>MQ_JOURNAL_NONE</SMALL>.
<dd><b>&#149;</B>&nbsp;&nbsp;<small>PROPID_Q_JOURNAL_QUOTA</SMALL>. An unsigned long int (<small>VT_UI4</SMALL>) that specifies the maximum size, in kilobytes, for the journal queue. The default value for this property is <small>INFINITE</SMALL>, which allows for an unlimited journal size.
<dd><b>&#149;</B>&nbsp;&nbsp;<small>PROPID_Q_LABEL</SMALL>. A Unicode string (<small>VT_LPWSTR</SMALL>) that describes the queue. The label can be used as search criteria when you&#146;re browsing for queues, and it&#146;s also displayed in the MSMQ portion of the Active Directory Computers and Users MMC snap-in. If no label is specified, the queue will have an empty string as a label.
<dd><b>&#149;</B>&nbsp;&nbsp;<small>PROPID_Q_MODIFY_TIME</SMALL>. A long int (<small>VT_I4</SMALL>) that indicates the most recent time queue properties were modified. The time returned is based on the number of seconds after January 1, 1970. This can be used in functions that expect a <small>time_t</SMALL> variable, such as <small>ctime</SMALL>. This property is read-only because it&#146;s set by the operating system.
<dd><b>&#149;</B>&nbsp;&nbsp;<small>PROPID_Q_PATHNAME</SMALL>. A Unicode string (<small>VT_LPWSTR</SMALL>) that&#146;s the message queue pathname to the queue. The total length of the pathname cannot exceed 124 characters, but names longer than 64 characters may cause performance problems. This is the only property that&#146;s mandatory for a message queue.
<dd><b>&#149;</B>&nbsp;&nbsp;<small>PROPID_Q_PRIV_LEVEL</SMALL>. An unsigned long int (<small>VT_UI4</SMALL>) that specifies the privacy level required by the queue. There are three possible values for this property: <small>MQ_PRIV_LEVEL_NONE</SMALL> indicates that the message queue will accept only nonprivate messages. <small>MQ_PRIV_LEVEL_BODY</SMALL> indicates that the queue will accept only private, encrypted messages. The default value, <small>MQ_PRIV_LEVEL_OPTIONAL</SMALL>, indicates that the queue will accept either type of message.
<dd><b>&#149;</B>&nbsp;&nbsp;<small>PROPID_Q_QUOTA</SMALL>. An unsigned long int (<small>VT_UI4</SMALL>) that specifies the maximum size, in kilobytes, for the message queue. The default value is <small>INFINITE</SMALL>, which allows for an unlimited queue size.
<dd><b>&#149;</B>&nbsp;&nbsp;<small>PROPID_Q_TRANSACTION</SMALL>. An unsigned char (<small>VT_UI1</SMALL>) that specifies how the queue participates in transactions. There are two possible values: A value of <small>MQ_TRANSACTIONAL</SMALL> indicates that the message must be defined as part of a message queue transaction. A value of <small>MQ_TRANSACTIONAL_NONE</SMALL> indicates that the queue cannot participate in transactions. If this property isn&#146;t explicitly set by an application, the default value is <small>MQ_TRANSACTIONAL_NONE</SMALL>.
<dd><b>&#149;</B>&nbsp;&nbsp;<small>PROPID_Q_TYPE</SMALL>. A GUID (<small>VT_CLSID</SMALL>) that identifies the queue type. This property is used by applications that need to apply a family type identifier to multiple queues. If no value is set by an application, the default value is <small>NULL_GUID</SMALL>.
</DL>
<p>Application-specific properties are defined when the message queue is created. Messages can be changed with the <small>MQSetQueueProperties</SMALL> function and retrieved with the <small>MQGetQueueProperties</SMALL> function. An example of defining queue properties when a queue is created is provided later in this chapter.</P>
<h4 align="LEFT"><a name="Heading9"></A><font color="#000077">Message Properties</FONT></H4>
<p>Each message sent through the message queue includes a number of properties. Some properties are set by the application, and other properties are set by MSMQ as the message proceeds through the message queue. A lot of properties are available for messages. For a complete list, consult the Platform SDK documentation. Here are the most commonly used properties:
</P>
<dl>
<dd><b>&#149;</B>&nbsp;&nbsp;<small>PROPID_M_BODY</SMALL>. An array of bytes (<small>VT_VECTOR|VTUI1</SMALL>) that contains the body of the message. The maximum size of the message body is 4MB.
<dd><b>&#149;</B>&nbsp;&nbsp;<small>PROPID_M_BODY_SIZE</SMALL>. An unsigned long int (<small>VT_UI4</SMALL>) that indicates the number of bytes in the message body.
<dd><b>&#149;</B>&nbsp;&nbsp;<small>PROPID_M_BODY_TYPE</SMALL>. An unsigned char (<small>VT_U1</SMALL>) that specifies the type of data contained in the message body. The default value is <small>0</SMALL>, in which case the receiving application should assume that the data is an array of bytes.
<dd><b>&#149;</B>&nbsp;&nbsp;<small>PROPID_M_DELIVERY</SMALL>. An unsigned char (<small>VT_U1</SMALL>) that specifies the message delivery type. There are two possible values for this property: <small>MQMSG_DELIVERY_RECOVERABLE</SMALL> specifies that the message is stored in a backup file until it&#146;s delivered, and <small>MQMSG_DELIVERY_EXPRESS</SMALL> specifies that the message is not stored in a backup file. Messages marked as <small>MQMSG_DELIVERY_EXPRESS</SMALL> are transmitted more quickly but may be lost in case of computer failure. If no value is specified for this property, the default value is <small>MSMQ_DELIVERY_EXPRESS</SMALL>.
<dd><b>&#149;</B>&nbsp;&nbsp;<small>PROPID_M_LABEL</SMALL>. A Unicode string (<small>VT_LPWSTR</SMALL>) of up to 250 Unicode characters that specifies the message label.
<dd><b>&#149;</B>&nbsp;&nbsp;<small>PROPID_M_LABEL_LEN</SMALL>. An unsigned long int (<small>VT_UI4</SMALL>) that contains the length of the message label.
<dd><b>&#149;</B>&nbsp;&nbsp;<small>PROPID_M_PRIORITY</SMALL>. An unsigned char (<small>VT_U1</SMALL>) that specifies the priority level for the message. Messages with a higher priority will be processed before lower-priority messages. The priority level must be between 0 and 7, with a default value of 3.
<dd><b>&#149;</B>&nbsp;&nbsp;<small>PROPID_M_TIME_TO_BE_RECEIVED</SMALL>. An unsigned long int (<small>VT_UI4</SMALL>) that specifies the number of seconds the message can wait before it must be delivered or removed from the message queue. If no value is specified for this property, the default value is <small>INFINITE</SMALL>, which allows the message to wait indefinitely to be delivered.
</DL>
<p><br></P>
<center>
<table border>
<tr>
<td><a href="28-02.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="28-04.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>


</font></BODY></HTML>