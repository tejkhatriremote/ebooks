<html>
<head>
<meta name=vsisbn content="067231486x">
<meta name=vstitle content="Programming Microsoft Windows 2000 Unleashed">
<meta name=vsauthor content="MICKEY WILLIAMS">
<meta name=vsimprint content="Sams">
<meta name=vspublisher content="Macmillan Computer Publishing">
<meta name=vspubdate content="06/21/99">
<meta name=vscategory content="Operations Systems: Windows 2000">



<title>Programming Microsoft Windows 2000 Unleashed:An Introduction to COM[TITLE]#43; Services</TITLE>
<!-- BEGIN HEADER -->
<meta name="ROBOTS" content="NOINDEX, NOFOLLOW">
<script>
<!--
function displayWindow(url, width, height) {
        var Win = window.open(url,"displayWindow",'width=' + width +
',height=' + height + ',resizable=1,scrollbars=yes');
}
//--></SCRIPT>

<!-- HEADER -->
<style type="text/css">
<!--
A:hover { color:red }
-->
</STYLE>

<!-- HEADER -->
<style type="text/css"> 
 <!--
 A:hover  {
 	color : Red;
 }
 -->
 </STYLE>

</HEAD>
<BODY bgcolor=#FFFFFF><FONT size=2 face="Arial, verdana, helvetica"><table width=100% border=0 cellspacing=0 cellpadding=2><tr bgcolor=#000000><td width=100% align=right><b><font color=#FFFFFF>Gotcha</font></b></td></tr></table><br><!--Begin Content Column -->

<table border=0 cellspacing=0 cellpadding=0>
<tr>
<td width=75 valign=top>
<img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/images/sm_covers/067231486x.gif" width=60 height=73 alt="Programming Microsoft Windows 2000 Unleashed" border="1">
</td>
<td align="left">
    <font face="arial, helvetica" size="-1" color="#336633"><b>Programming Microsoft Windows 2000 Unleashed</b></font>
    <br>
    <font face="arial, helvetica" size="-1"><i>by MICKEY WILLIAMS</i>
    <br>
    Sams,&nbsp;Macmillan Computer Publishing
    <br>
    <b>ISBN:</b>&nbsp;067231486x<b>&nbsp;&nbsp;&nbsp;Pub Date:</b>&nbsp;06/21/99</font>
</td>
</tr>
</table>
<p>
<!-- Empty Reference Subhead-->

<!--ISBN=067231486x//-->
<!--TITLE=Programming Microsoft Windows 2000 Unleashed//-->
<!--AUTHOR=Mickey Williams//-->
<!--PUBLISHER=Macmillan Computer Publishing//-->
<!--IMPRINT=sams//-->
<!--CHAPTER=21//-->
<!--PAGES=695-699//-->
<!--UNASSIGNED1//-->
<!--UNASSIGNED2//-->

<center>
<table border>
<tr>
<td><a href="21-04.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="21-06.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<p><br></P>
<p>This error indicates that the component is not entirely capable yet of running within the COM&#43; application. To solve this problem, you first need to compile the component using the File, Make VBBookStore.dll menu. Next, open the Project, VBBookstore Properties menu and set the project to &#147;binary compatibility&#148; in the Component tab. The last step is to register the component within the COM&#43; application.
</P>
<p><a name="Fig8"></A><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/067231486x/ch21/images/21-08.jpg',287,54 )"><img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/reference/pro/067231486x/ch21/images/21-08t.jpg"></A>
<br><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/067231486x/ch21/images/21-08.jpg',287,54)"><font color="#000077"><b>Figure 21.8</B></FONT></A>&nbsp;&nbsp;Visual Basic binary compatibility problem.</P>
<p><font size="+1"><b>Using Stored Procedures and Views</B></FONT></P>
<p>In the simple component, the database is accessed using Active Data Objects (ADO). ADO is the preferred data-access technology within the Visual Basic development environment.
</P>
<p>In the past, ODBC has been used to access relational databases. Although it has worked well, it does have some problems. The biggest problem is that it only works well with relational databases. A spreadsheet or document does not fit the model well, even though there are ODBC drivers available for them. OLE DB is an extension of the ODBC architecture in that it&#146;s used for accessing any kind of data. The data can be object oriented, relational, in spreadsheet format, and so on.</P>
<p>However, you can only use the OLE DB COM interfaces within the Visual C&#43;&#43; environment. Within Visual Basic, a simplification layer called <i>ADO</I> is used. In the sample component, a simple ADO command is shown. In a production development environment, this will not do. The reason is that ADO solves a problem generically, yet specific to a vertical application domain. The solution that will be proposed is for enterprise application developers.</P>
<p><font size="+1"><b>Stored Procedure and View Architecture</B></FONT></P>
<p>In our production development situations, we developed a stored procedure and view architecture. For the adding, deleting, and manipulating of data, stored procedures are used. For the reading and retrieving of data, views are used. The reasons for this type of architecture are Abstraction, Security, Let the database folks do their work, and Performance.
</P>
<p><font size="+1"><b><i>Reason #1: Abstraction</I></B></FONT></P>
<p>COM works well because it creates usable interfaces. The interface is an intention of how the implementation works. The details of the implementation are of no concern to the consumer of the interface. The same logic applies to the resource, except that the interface is a stored procedure or a view. Using either of these techniques, you can update or change the database schema without adversely affecting the application. In the age of data warehousing, this ability will become invaluable. Coding to the underlying resource schema is like using global variables.
</P>
<p><font size="+1"><b><i>Reason #2: Security</I></B></FONT></P>
<p>The problem with implementing security in a SQL-based database is that it&#146;s only implemented on a per-user basis, regardless of the application calling it. Consider the diagram shown in Figure 21.9.
</P>
<p><a name="Fig9"></A><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/067231486x/ch21/images/21-09.jpg',200,145 )"><img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/reference/pro/067231486x/ch21/images/21-09t.jpg"></A>
<br><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/067231486x/ch21/images/21-09.jpg',200,145)"><font color="#000077"><b>Figure 21.9</B></FONT></A>&nbsp;&nbsp;An example of using ISQL to bypass application database security.</P>
<p>In Figure 21.9, a traditional fat client is used to access the database. As a side note, a fat client is not necessarily bad. Even with the multitiered architecture proposed, a fat client can still access the business objects. The key, really, is in designing to the proper layers. Now, back to the security issue. The client communicates to the database through the database layer and asks for information. Suppose that this information is the salary income for all employees. If the person who logged in has a ranking of <i>x</I> and the <small>SELECT</SMALL> returns a record of employee <i>x</I> &#43; 1, then this other employee has a lower rank and therefore should not have direct access to that record. This sort of security is called <i>need to know</I>. All SQL databases, with one exception, do not support this (Oracle is that exception). Another problem is that the database can be viewed and manipulated using any application. To the client application, it does not matter whether it&#146;s the client program or the fat client that connects and queries the database. Using a stored procedure approach makes it possible to implement a need-to-know security framework&#151;one that restricts anyone to simply browse the database.</P>
<p><font size="+1"><b><i>Reason #3: Let the Database Folks Do Their Work</I></B></FONT></P>
<p>A view and stored procedure architecture makes it simpler to build a complex architecture. Let&#146;s be honest; very often program developers have no idea of what a good database design is. It&#146;s not that they cannot program, they simply aren&#146;t database developers. Administrators, on the other hand, work with databases everyday and need to be able to manage large amounts of data. They will know what makes a good database design and how to optimally extract the data.
</P>
<p><font size="+1"><b><i>Reason #4: Performance</I></B></FONT></P>
<p>If some of the logic is placed into the stored procedure, the performance is enhanced because the statement is already precompiled. With SQL 6.5, the stored procedure is compiled the first time it&#146;s loaded. However, you can preload a stored procedure so that it has a higher performance factor. With performance, there&#146;s an added benefit&#151;database-specific SQL. However, this may make it more difficult to port the SQL code to another database.
</P>
<p><font size="+1"><b>ADO and Helper Objects</B></FONT></P>
<p>To make it easier to use the ADO objects, you should create a few helper objects. This way, the code is centralized and easier to change if needed. To use ADO, you need to reference the ADO library, as shown in Figure 21.10. This can be a very interesting situation because there are various ADO libraries. This is because the versions have been incremented, and programs often install older editions.
</P>
<p><a name="Fig10"></A><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/067231486x/ch21/images/21-10.jpg',161,128 )"><img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/reference/pro/067231486x/ch21/images/21-10t.jpg"></A>
<br><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/067231486x/ch21/images/21-10.jpg',161,128)"><font color="#000077"><b>Figure 21.10</B></FONT></A>&nbsp;&nbsp;An ADO library reference needed in a Visual Basic project.</P>
<p><b>ADO Architecture</B></P>
<p>The ADO architecture is very simple.</P>
<p>Figure 21.11 shows the hierarchy, but with ADO, this hierarchy is not necessary. For example, to run a simple query, you can execute it directly on the <small>Recordset</SMALL> object without explicitly creating the <small>Connection</SMALL> object. This does not mean a <small>Connection</SMALL> object is not created. Instead, the creation of the <small>Connection</SMALL> object is managed within the <small>Recordset</SMALL> object.</P>
<p><a name="Fig11"></A><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/067231486x/ch21/images/21-11.jpg',199,203 )"><img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/reference/pro/067231486x/ch21/images/21-11t.jpg"></A>
<br><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/067231486x/ch21/images/21-11.jpg',199,203)"><font color="#000077"><b>Figure 21.11</B></FONT></A>&nbsp;&nbsp;ADO architecture.</P>
<p>There are three main objects: Connection, Command, and Recordset. The root object is the <small>Connection</SMALL> object. It manages the connection to the resource. From the <small>Connection</SMALL> object, a <small>Command</SMALL> object can be executed or a <small>Recordset</SMALL> object can be retrieved.</P>
<p><b>Accessing a View</B></P>
<p>Starting with the simpler task first, let&#146;s access a client view. We could issue the command <small>SELECT * FROM viewFullClient</SMALL>. This would be like the ADO code in the simple component. What&#146;s not optimal with this solution is that the connection programming code is in the method code. This makes it very difficult to update the code if the driver changes.</P><p><br></P>
<center>
<table border>
<tr>
<td><a href="21-04.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="21-06.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>


</font></BODY></HTML>