<html>
<head>
<meta name=vsisbn content="067231486x">
<meta name=vstitle content="Programming Microsoft Windows 2000 Unleashed">
<meta name=vsauthor content="MICKEY WILLIAMS">
<meta name=vsimprint content="Sams">
<meta name=vspublisher content="Macmillan Computer Publishing">
<meta name=vspubdate content="06/21/99">
<meta name=vscategory content="Operations Systems: Windows 2000">



<title>Programming Microsoft Windows 2000 Unleashed:An Introduction to COM[TITLE]#43; Services</TITLE>
<!-- BEGIN HEADER -->
<meta name="ROBOTS" content="NOINDEX, NOFOLLOW">
<script>
<!--
function displayWindow(url, width, height) {
        var Win = window.open(url,"displayWindow",'width=' + width +
',height=' + height + ',resizable=1,scrollbars=yes');
}
//--></SCRIPT>

<!-- HEADER -->
<style type="text/css">
<!--
A:hover { color:red }
-->
</STYLE>

<!-- HEADER -->
<style type="text/css"> 
 <!--
 A:hover  {
 	color : Red;
 }
 -->
 </STYLE>

</HEAD>
<BODY bgcolor=#FFFFFF><FONT size=2 face="Arial, verdana, helvetica"><table width=100% border=0 cellspacing=0 cellpadding=2><tr bgcolor=#000000><td width=100% align=right><b><font color=#FFFFFF>Gotcha</font></b></td></tr></table><br><!--Begin Content Column -->

<table border=0 cellspacing=0 cellpadding=0>
<tr>
<td width=75 valign=top>
<img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/images/sm_covers/067231486x.gif" width=60 height=73 alt="Programming Microsoft Windows 2000 Unleashed" border="1">
</td>
<td align="left">
    <font face="arial, helvetica" size="-1" color="#336633"><b>Programming Microsoft Windows 2000 Unleashed</b></font>
    <br>
    <font face="arial, helvetica" size="-1"><i>by MICKEY WILLIAMS</i>
    <br>
    Sams,&nbsp;Macmillan Computer Publishing
    <br>
    <b>ISBN:</b>&nbsp;067231486x<b>&nbsp;&nbsp;&nbsp;Pub Date:</b>&nbsp;06/21/99</font>
</td>
</tr>
</table>
<p>
<!-- Empty Reference Subhead-->

<!--ISBN=067231486x//-->
<!--TITLE=Programming Microsoft Windows 2000 Unleashed//-->
<!--AUTHOR=Mickey Williams//-->
<!--PUBLISHER=Macmillan Computer Publishing//-->
<!--IMPRINT=sams//-->
<!--CHAPTER=21//-->
<!--PAGES=721-725//-->
<!--UNASSIGNED1//-->
<!--UNASSIGNED2//-->

<center>
<table border>
<tr>
<td><a href="21-10.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="../ch22/22-01.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<p><br></P>
</P>
<p><b>Activation Tab</B></P>
<p>The next tab is the Activation tab. Figure 21.23 shows the following features:</P>
<dl>
<dd><b>&#149;</B>&nbsp;&nbsp;<i>Object Pooling</I>. Object pooling can be enabled only for COM objects that are stateless. An optimization would be to implement the <small>IObjectControl</SMALL> interface. This is shown in the next chapter. If object pooling can be used, you can specify the minimum pool size. This determines that whenever the application starts, that number of COM objects will be instantiated. The maximum size defines the maximum number of objects that will be created. The text box Creation Timeout specifies how much time the COM object waits before it instantiates another COM object.
<dd><b>&#149;</B>&nbsp;&nbsp;<i>Object Construction</I>. When a COM object is instantiated within the COM&#43; application, you can specify a string that&#146;s passed to the construction method. Using this string, dynamic database connections or any other dynamic administration features can be implemented.
<dd><b>&#149;</B>&nbsp;&nbsp;<i>Enable Just In Time Activation</I>. This enables the object only when the client needs it.
<dd><b>&#149;</B>&nbsp;&nbsp;<i>Component supports dynamic load balancing</I>. Checking this box allows the component to be dynamically load-balanced across various machines. Dynamic load balancing reads the response time and, if necessary, references a component in another location.
<dd><b>&#149;</B>&nbsp;&nbsp;<i>Component supports events and statistics</I>. This option makes it possible for the COM object to accept events and COM&#43; application statistics.
<dd><b>&#149;</B>&nbsp;&nbsp;<i>Must be activated in caller&#146;s context</I>. At the time of this writing, this feature was not fully documented. It will be documented in the COM&#43; SDK when Windows 2000 is released.
</DL>
<p><b>Security Tab</B></P>
<p>The next tab you see is the Security tab. Its features are shown in Figure 21.24:</P>
<dl>
<dd><b>&#149;</B>&nbsp;&nbsp;<i>Enforce component-level access checks</I>. Enables role-based security for the component. Role-based security can be implemented within the COM object, or it can be specified in this tab.
<dd><b>&#149;</B>&nbsp;&nbsp;<i>Roles explicitly set for selected items</I>. You can specify specific roles from the available roles in the COM&#43; application. To select a role, you need to check it from the list box.
</DL>
<p><a name="Fig23"></A><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/067231486x/ch21/images/21-23.jpg',404,448 )"><img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/reference/pro/067231486x/ch21/images/21-23t.jpg"></A>
<br><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/067231486x/ch21/images/21-23.jpg',404,448)"><font color="#000077"><b>Figure 21.23</B></FONT></A>&nbsp;&nbsp;COM&#43; object activation properties.</P>
<p><a name="Fig24"></A><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/067231486x/ch21/images/21-24.jpg',403,446 )"><img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/reference/pro/067231486x/ch21/images/21-24t.jpg"></A>
<br><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/067231486x/ch21/images/21-24.jpg',403,446)"><font color="#000077"><b>Figure 21.24</B></FONT></A>&nbsp;&nbsp;COM&#43; object security properties.</P>
<p><b>Advanced Tab</B></P>
<p>The last tab is the Advanced tab. This tab, as shown in Figure 21.25, has one feature:</P>
<dl>
<dd><b>&#149;</B>&nbsp;&nbsp;<i>Queuing exception class</I>. At the time of this writing, this feature was not fully documented. In the release version of Windows 2000, it is documented in the COM&#43; SDK.
</DL>
<p><a name="Fig25"></A><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/067231486x/ch21/images/21-25.jpg',403,447 )"><img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/reference/pro/067231486x/ch21/images/21-25t.jpg"></A>
<br><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/067231486x/ch21/images/21-25.jpg',403,447)"><font color="#000077"><b>Figure 21.25</B></FONT></A>&nbsp;&nbsp;COM&#43; object advanced properties.</P>
<p><font size="+1"><b>Implementing a Test Client</B></FONT></P>
<p>Developing COM components is one part of the development process. The other part is the actual testing. The testing of a component needs to occur in isolation, which means that only specific situations are tested. This does not mean including the component in the project and then testing it. The problem with testing a component within a project is that the coverage will not be adequate.
</P>
<p>Visual Studio supports debugging across environments and layers. For example, client to browser to Web server to component and to database. To test the client properly and in an easy manner requires quite a bit of work. A better way to test and implement the client is to use the scripting interface. In Windows 2000, scripting is integrated into the operating system. Using a language such as JScript, you can call various COM objects. This is the preferred solution. For the sample COM components, the following script was used:</P>
<!-- CODE //-->
<pre>
function tstClient() {
    var tmpObject;

    tmpObject = WScript.CreateObject(&#147;VBBookstore.clsClient&#148;);

    tmpObject.companyName = &#147;euSOFT&#148;;
    tmpObject.street = &#147;Muehlweg 1&#148;;
    tmpObject.city = &#147;Freudenberg&#148;;
    if( tmpObject.add() == true) {
        WScript.Echo( &#147;Add worked ok&#148;);
    } else {
        WScript.Echo( &#147;Add did not work&#148;);
    }
}

function tstGetClient() {
    var tmpObject;

    tmpObject = WScript.CreateObject(&#147;VBBookstore.clsClient&#148;);
    if( tmpObject.GetClient( 1) != false) {
        WScript.Echo(&#147;Client info is &#148; &#43; tmpObject.companyName);
    } else {
        WScript.Echo(&#147;Could not get the client&#148;);
    }

}

function tstSPClient() {
    var tmpObject;

    tmpObject = WScript.CreateObject(&#147;VBBookstore.clsClient&#148;);

    tmpObject.companyName = &#147;euSOFT 2&#148;;
    tmpObject.street = &#147;Muehlweg 1&#148;;
    tmpObject.city = &#147;Freudenberg&#148;;
    if( tmpObject.AddNew() == true) {
        WScript.Echo( &#147;Add worked ok&#148;);
    } else {
        WScript.Echo( &#147;Add did not work&#148;);
    }
}


//tstGetClient();
//tstClient();
tstSPClient();
</PRE>
<!-- END CODE //-->
<p>Three tests are used in this script:
</P>
<dl>
<dd><b>&#149;</B>&nbsp;&nbsp;<small>tstGetClient</SMALL>. Retrieves the client and outputs it to the console
<dd><b>&#149;</B>&nbsp;&nbsp;<small>tstClient</SMALL>. Adds a client using the <small>INSERT</SMALL> SQL statement
<dd><b>&#149;</B>&nbsp;&nbsp;<small>tstSPClient</SMALL>. Adds a client using the stored procedure
</DL>
<p>Using this script as a basis, you can build a testing scenario that can be used in regression tests for correctness. Scripting also requires less programming expertise than using Visual Basic or Visual C&#43;&#43;.
</P>
<h3><a name="Heading12"></A><font color="#000077">Summary</FONT></H3>
<p>The purpose of this chapter is to provide you with a basic understanding of how transactions and COM&#43; transactions function. You learned about transactions and how they function. You built a simple component and accessed a database using a stored procedure and view architecture. You also learned how to write a stateless component. When you went through the simple component example, a stateless component was written by default. Finally, you learned how to register a component.
</P><p><br></P>
<center>
<table border>
<tr>
<td><a href="21-10.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="../ch22/22-01.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>


</font></BODY></HTML>