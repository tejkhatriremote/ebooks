<html>
<head>
<meta name=vsisbn content="067231486x">
<meta name=vstitle content="Programming Microsoft Windows 2000 Unleashed">
<meta name=vsauthor content="MICKEY WILLIAMS">
<meta name=vsimprint content="Sams">
<meta name=vspublisher content="Macmillan Computer Publishing">
<meta name=vspubdate content="06/21/99">
<meta name=vscategory content="Operations Systems: Windows 2000">



<title>Programming Microsoft Windows 2000 Unleashed:Files</TITLE>
<!-- BEGIN HEADER -->
<meta name="ROBOTS" content="NOINDEX, NOFOLLOW">
<script>
<!--
function displayWindow(url, width, height) {
        var Win = window.open(url,"displayWindow",'width=' + width +
',height=' + height + ',resizable=1,scrollbars=yes');
}
//--></SCRIPT>

<!-- HEADER -->
<style type="text/css">
<!--
A:hover { color:red }
-->
</STYLE>

<!-- HEADER -->
<style type="text/css"> 
 <!--
 A:hover  {
 	color : Red;
 }
 -->
 </STYLE>

</HEAD>
<BODY bgcolor=#FFFFFF><FONT size=2 face="Arial, verdana, helvetica"><table width=100% border=0 cellspacing=0 cellpadding=2><tr bgcolor=#000000><td width=100% align=right><b><font color=#FFFFFF>Gotcha</font></b></td></tr></table><br><!--Begin Content Column -->

<table border=0 cellspacing=0 cellpadding=0>
<tr>
<td width=75 valign=top>
<img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/images/sm_covers/067231486x.gif" width=60 height=73 alt="Programming Microsoft Windows 2000 Unleashed" border="1">
</td>
<td align="left">
    <font face="arial, helvetica" size="-1" color="#336633"><b>Programming Microsoft Windows 2000 Unleashed</b></font>
    <br>
    <font face="arial, helvetica" size="-1"><i>by MICKEY WILLIAMS</i>
    <br>
    Sams,&nbsp;Macmillan Computer Publishing
    <br>
    <b>ISBN:</b>&nbsp;067231486x<b>&nbsp;&nbsp;&nbsp;Pub Date:</b>&nbsp;06/21/99</font>
</td>
</tr>
</table>
<p>
<!-- Empty Reference Subhead-->

<!--ISBN=067231486x//-->
<!--TITLE=Programming Microsoft Windows 2000 Unleashed//-->
<!--AUTHOR=Mickey Williams//-->
<!--PUBLISHER=Macmillan Computer Publishing//-->
<!--IMPRINT=sams//-->
<!--CHAPTER=4//-->
<!--PAGES=04-03//-->
<!--UNASSIGNED1//-->
<!--UNASSIGNED2//-->

<center>
<table border>
<tr>
<td><a href="04-02.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="04-04.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<p><br></P>
<p>The most flexible of the <small>CreateFile</SMALL> parameters are the flags that specify how the file will be created. Table 4.1 lists the possible values for <small>CreateFile</SMALL>.</P>
<table width="100%"><caption valign="TOP" align="LEFT" colspan="2"><b>Table 4.1</B> Parameters for <small>CreateFile</SMALL>
<tr>
<td colspan="2"><hr>
<tr>
<th align="LEFT" valign="TOP" width="30%"><i>Flag</I>
<th valign="TOP" align="LEFT"><i>Function</I>
<tr>
<td colspan="2"><hr>
<tr>
<td valign="TOP" align="LEFT"><small>CREATE_ALWAYS</SMALL>
<td valign="TOP" align="LEFT">Creates a new file and overwrites the specified file if it exists.
<tr>
<td valign="TOP" align="LEFT"><small>CREATE_NEW</SMALL>
<td valign="TOP" align="LEFT">Creates a new file. This flag fails if the specified file already exists.
<tr>
<td valign="TOP" align="LEFT"><small>OPEN_ALWAYS</SMALL>
<td valign="TOP" align="LEFT">Opens the file, creating it first, if necessary.
<tr>
<td valign="TOP" align="LEFT"><small>OPEN_EXISTING</SMALL>
<td valign="TOP" align="LEFT">Opens the specified file. This flag fails if the specified file does not exist.
<tr>
<td valign="TOP" align="LEFT"><small>TRUNCATE_EXISTING</SMALL>
<td valign="TOP" align="LEFT">Opens the file and truncates its size to 0 bytes. The file must have been opened with write access.
<tr>
<td colspan="2"><hr>
</TABLE>
<p>The file attribute parameter can be a combination of one or more of the values shown in Table 4.2.
</P>
<table width="100%"><caption align="LEFT" valign="TOP" colspan="2"><b>Table 4.2</B> File Attribute Parameter Values
<tr>
<td colspan="2"><hr>
<tr>
<th align="LEFT" valign="TOP" align="40%"><i>Parameter</I>
<th valign="TOP" align="LEFT"><i>Function</I>
<tr>
<td colspan="2"><hr>
<tr>
<td valign="TOP" align="LEFT"><small>FILE_ATTRIBUTE_ARCHIVE</SMALL>
<td valign="TOP" align="LEFT">Indicates that the file is an archive file.
<tr>
<td valign="TOP" align="LEFT"><small>FILE_ATTRIBUTE_ENCRYPTED</SMALL>
<td valign="TOP" align="LEFT">Indicates that the file is encrypted, unless <small>FILE_ATTRIBUTE_SYSTEM</SMALL> is also set, in which case this flag is ignored. For directories, this flag indicates that files are encrypted by default.
<tr>
<td valign="TOP" align="LEFT"><small>FILE_ATTRIBUTE_HIDDEN</SMALL>
<td valign="TOP" align="LEFT">Creates a hidden file or directory.
<tr>
<td valign="TOP" align="LEFT"><small>FILE_ATTRIBUTE_NORMAL</SMALL>
<td valign="TOP" align="LEFT">Used when no other flags apply. This flag is ignored if it&#146;s combined with any other flags.
<tr>
<td valign="TOP" align="LEFT"><small>FILE_ATTRIBUTE_OFFLINE</SMALL>
<td valign="TOP" align="LEFT">Indicates that the file data is located in offline storage that&#146;s not immediately available.
<tr>
<td valign="TOP" align="LEFT"><small>FILE_ATTRIBUTE_READONLY</SMALL>
<td valign="TOP" align="LEFT">Creates a read-only file.
<tr>
<td valign="TOP" align="LEFT"><small>FILE_ATTRIBUTE_SYSTEM</SMALL>
<td valign="TOP" align="LEFT">Marks a file as used by the operating system.
<tr>
<td valign="TOP" align="LEFT"><small>FILE_ATTRIBUTE_TEMPORARY</SMALL>
<td valign="TOP" align="LEFT">Marks the file as being used for temporary storage. Windows 2000 will try to cache the file in RAM.
<tr>
<td valign="TOP" align="LEFT"><small>FILE_FLAG_BACKUP_SEMANTICS</SMALL>
<td valign="TOP" align="LEFT">Used during backups or restore operations. An application also can set this flag to obtain a handle to a directory, which can be passed to some Win32 functions in place of a file handle.
<tr>
<td valign="TOP" align="LEFT"><small>FILE_FLAG_DELETE_ON_CLOSE</SMALL>
<td valign="TOP" align="LEFT">Notifies the operating system that it must delete the file immediately after all its handles have been closed.
<tr>
<td valign="TOP" align="LEFT"><small>FILE_FLAG_NO_BUFFERING</SMALL>
<td valign="TOP" align="LEFT">Specifies that the file must be opened with no intermediate buffering or caching, which can improve performance. If this flag is used, you must access the file in multiples of the file&#146;s sector size. You can get the sector size used by a volume with the <small>GetDiskFreeSpace</SMALL> function.
<tr>
<td valign="TOP" align="LEFT"><small>FILE_FLAG_OPEN_NO_RECALL</SMALL>
<td valign="TOP" align="LEFT">Indicates that data should remain in remote storage, rather than being moved to the local drive in the case of Hierarchical Storage Management (HSM) file systems. An HSM file system moves infre-quently accessed files to long-term storage and retrieves them as needed.
<tr>
<td valign="TOP" align="LEFT"><small>FILE_FLAG_OPEN_REPARSE_POINT</SMALL>
<td valign="TOP" align="LEFT">Immediately returns a file handle without involving the filter that controls the reparse point.
<tr>
<td valign="TOP" align="LEFT"><small>FILE_FLAG_OVERLAPPED</SMALL>
<td valign="TOP" align="LEFT">Indicates that <small>ReadFile</SMALL> and <small>WriteFile</SMALL> operations will use an <small>OVERLAPPED</SMALL> structure, and asynchronous file I/O will be performed using this file. This topic is covered in detail later in this chapter.
<tr>
<td valign="TOP" align="LEFT"><small>FILE_FLAG_POSIX_SEMANTICS</SMALL>
<td valign="TOP" align="LEFT">Indicates that the file will be accessed according to POSIX rules, which include case sensitivity on file systems that support case-sensitive naming. Files created with this flag might not be accessible by applications written for Windows 2000.
<tr>
<td valign="TOP" align="LEFT"><small>FILE_FLAG_RANDOM_ACCESS</SMALL>
<td valign="TOP" align="LEFT">Indicates that the file will be accessed randomly. This flag gives Windows 2000 a chance to optimize file caching.
<tr>
<td valign="TOP" align="LEFT"><small>FILE_FLAG_SEQUENTIAL_SCAN</SMALL>
<td valign="TOP" align="LEFT">Indicates that the file is to be accessed sequentially from beginning to end. This flag gives Windows 2000 a chance to optimize file caching.
<tr>
<td valign="TOP" align="LEFT"><small>FILE_FLAG_WRITE_THROUGH</SMALL>
<td valign="TOP" align="LEFT">Indicates that the operating system must write through any intermediate cache and write directly to the file. The file might be cached, but the file can&#146;t be placed into a lazy cache&#151;bits must actually be touched out on the disk.
<tr>
<td colspan="2"><hr>
</TABLE>
<p>To close a file, use the <small>CloseHandle</SMALL> function, like this:</P>
<!-- CODE SNIP //-->
<pre>
CloseHandle(hReadFile);
</PRE>
<!-- END CODE SNIP //-->
<p>After all open handles for a file have been closed, you can delete the file using the <small>DeleteFile</SMALL> function:</P>
<!-- CODE SNIP //-->
<pre>
DeleteFile(_T(&#147;Foo.txt&#148;));
</PRE>
<!-- END CODE SNIP //-->
<h4 align="LEFT"><a name="Heading8"></A><font color="#000077">Writing to Files</FONT></H4>
<p>You use the <small>WriteFile</SMALL> function to write to files. Here&#146;s an example of using the <small>WriteFile</SMALL> function:</P>
<!-- CODE SNIP //-->
<pre>
WriteFile(hWriteFile, szBuff, dwRead, &ampdwWritten, NULL);
</PRE>
<!-- END CODE SNIP //-->
<p><small>WriteFile</SMALL> has five parameters:</P>
<dl>
<dd><b>&#149;</B>&nbsp;&nbsp;The file handle to be written to.
<dd><b>&#149;</B>&nbsp;&nbsp;The address of a buffer containing the data to be written.
<dd><b>&#149;</B>&nbsp;&nbsp;The number of bytes to be written.
<dd><b>&#149;</B>&nbsp;&nbsp;A pointer to a <small>DWORD</SMALL> that will contain the number of bytes actually written after <small>WriteFile</SMALL> returns.
<dd><b>&#149;</B>&nbsp;&nbsp;An optional <small>OVERLAPPED</SMALL> structure used for asynchronous write requests. (This parameter is discussed later in this chapter.)
</DL>
<p><br></P>
<center>
<table border>
<tr>
<td><a href="04-02.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="04-04.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>


</font></BODY></HTML>