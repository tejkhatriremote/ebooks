<html>
<head>
<meta name=vsisbn content="067231486x">
<meta name=vstitle content="Programming Microsoft Windows 2000 Unleashed">
<meta name=vsauthor content="MICKEY WILLIAMS">
<meta name=vsimprint content="Sams">
<meta name=vspublisher content="Macmillan Computer Publishing">
<meta name=vspubdate content="06/21/99">
<meta name=vscategory content="Operations Systems: Windows 2000">



<title>Programming Microsoft Windows 2000 Unleashed:COM and OLE Concepts</TITLE>
<!-- BEGIN HEADER -->
<meta name="ROBOTS" content="NOINDEX, NOFOLLOW">
<script>
<!--
function displayWindow(url, width, height) {
        var Win = window.open(url,"displayWindow",'width=' + width +
',height=' + height + ',resizable=1,scrollbars=yes');
}
//--></SCRIPT>

<!-- HEADER -->
<style type="text/css">
<!--
A:hover { color:red }
-->
</STYLE>

<!-- HEADER -->
<style type="text/css"> 
 <!--
 A:hover  {
 	color : Red;
 }
 -->
 </STYLE>

</HEAD>
<BODY bgcolor=#FFFFFF><FONT size=2 face="Arial, verdana, helvetica"><table width=100% border=0 cellspacing=0 cellpadding=2><tr bgcolor=#000000><td width=100% align=right><b><font color=#FFFFFF>Gotcha</font></b></td></tr></table><br><!--Begin Content Column -->

<table border=0 cellspacing=0 cellpadding=0>
<tr>
<td width=75 valign=top>
<img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/images/sm_covers/067231486x.gif" width=60 height=73 alt="Programming Microsoft Windows 2000 Unleashed" border="1">
</td>
<td align="left">
    <font face="arial, helvetica" size="-1" color="#336633"><b>Programming Microsoft Windows 2000 Unleashed</b></font>
    <br>
    <font face="arial, helvetica" size="-1"><i>by MICKEY WILLIAMS</i>
    <br>
    Sams,&nbsp;Macmillan Computer Publishing
    <br>
    <b>ISBN:</b>&nbsp;067231486x<b>&nbsp;&nbsp;&nbsp;Pub Date:</b>&nbsp;06/21/99</font>
</td>
</tr>
</table>
<p>
<!-- Empty Reference Subhead-->

<!--ISBN=067231486x//-->
<!--TITLE=Programming Microsoft Windows 2000 Unleashed//-->
<!--AUTHOR=Mickey Williams//-->
<!--PUBLISHER=Macmillan Computer Publishing//-->
<!--IMPRINT=sams//-->
<!--CHAPTER=13//-->
<!--PAGES=407-414//-->
<!--UNASSIGNED1//-->
<!--UNASSIGNED2//-->

<center>
<table border>
<tr>
<td><a href="../ch12/12-06.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="13-02.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<p><br></P>
<h2 align="CENTER"><font color="#000077"><i>Part III<br>COM and ActiveX
</I></FONT></H2>
<p><big><b>In This Part</B></BIG></P>
<dl>
<dd><b>&#149;</B>&nbsp;&nbsp;<b>COM and OLE Concepts <i>0</I></B>
<dd><b>&#149;</B>&nbsp;&nbsp;<b>Automation <i>0</I></B>
<dd><b>&#149;</B>&nbsp;&nbsp;<b>OLE Drag and Drop <i>0</I></B>
<dd><b>&#149;</B>&nbsp;&nbsp;<b>COM Threading Models <i>0</I></B>
<dd><b>&#149;</B>&nbsp;&nbsp;<b>Custom COM Objects <i>0</I></B>
<dd><b>&#149;</B>&nbsp;&nbsp;<b>Developing ActiveX Controls <i>0</I></B>
<dd><b>&#149;</B>&nbsp;&nbsp;<b>Asynchronous COM <i>0</I></B>
<dd><b>&#149;</B>&nbsp;&nbsp;<b>DCOM <i>0</I></B>
</DL>
<h2><a name="Heading1"></A><font color="#000077">Chapter 13<br>COM and OLE Concepts
</FONT></H2>
<p><big><b>In This Chapter</B></BIG></P>
<dl>
<dd><b>&#149;</B>&nbsp;&nbsp;<b>Looking at an Overview of OLE and DDE <i>410</I></B>
<dd><b>&#149;</B>&nbsp;&nbsp;<b>Examining Commonly Used COM and OLE Technologies <i>410</I></B>
<dd><b>&#149;</B>&nbsp;&nbsp;<b>Programming with COM and OLE <i>415</I></B>
<dd><b>&#149;</B>&nbsp;&nbsp;<b>Looking at an Example of a COM Component <i>427</I></B>
</DL>
<p>COM (component object model) is the interprocess communication method of choice when building applications for Windows. OLE is the Microsoft technology that enables GUI-centric applications to work together seamlessly. This chapter focuses on the concepts behind these communications methods and presents sample programs that demonstrate how they are used.
</P>
<h3><a name="Heading2"></A><font color="#000077">Looking at an Overview of COM and OLE</FONT></H3>
<p>COM is a specification for communication between software components. It was originally introduced by Microsoft in 1993 as the communication mechanism that laid the foundation for OLE 2.0. The previous version of OLE, OLE 1.0, was a much simpler method of interprocess communication that wasn&#146;t based on COM. The current version of COM is known simply as <i>COM</I>, with no version numbers (although some recently added technologies are known collectively as <i>COM&#43;</I>).</P>
<p>As mentioned earlier, COM is the foundation on which OLE rests. COM is a binary specification for a number of technologies that define how objects and systems can interact with each other in an open and scalable manner.</P>
<h3><a name="Heading3"></A><font color="#000077">Examining Commonly Used COM and OLE Technologies</FONT></H3>
<p>COM and OLE define several technologies that can be used to create component-based software. Here&#146;s a list of the most commonly used COM and OLE technologies:
</P>
<dl>
<dd><b>&#149;</B>&nbsp;&nbsp;Data transfer
<dd><b>&#149;</B>&nbsp;&nbsp;Drag and drop
<dd><b>&#149;</B>&nbsp;&nbsp;Compound documents
<dd><b>&#149;</B>&nbsp;&nbsp;Visual editing, also known as <i>in-place activation</I>
<dd><b>&#149;</B>&nbsp;&nbsp;Automation
<dd><b>&#149;</B>&nbsp;&nbsp;Integration with other applications
</DL>
<p>Each of these technologies is discussed in the following sections.
</P>
<h4 align="LEFT"><a name="Heading4"></A><font color="#000077">Compound Documents</FONT></H4>
<p>One of the original big-ticket items that came with OLE 2.0 was <i>compound documents</I>. A compound document can be used to integrate content from multiple component servers&#151;including text, graphics, audio, and any other data that might be generated. Each document stores unique identifiers known as <i>Class Identifiers</I>, or <i>CLSID</I>s that identify the servers used to create and manage individual portions of the document. A CLSID is just one example of a <i>Globally Unique Identifier</I>, or <i>GUID</I>, a unique 128-bit identifier used to identify different types of COM components. More information about GUIDs, CLSIDs, and other COM identifiers is provided later in the section, &#147;Identifying COM Interfaces and Objects.&#148;</P>
<p>Storing information in a compound document enables a user to focus on the document rather than on each application used to create the content stored in the document. Because a component object in the compound document requires editing, the server for that object can be activated automatically using the CLSID for the object&#146;s server. Of course, this happens without the user needing to understand the underlying mechanism involved.</P>
<p>A component object can be stored in a compound document in two ways: by linking and by embedding.</P>
<p>A <i>linked</I> component resides outside the compound document, and the compound document keeps a reference known as a <i>moniker</I> that points to the linked component&#146;s location. This reduces the size of the compound document and is very useful when a single item is &#147;owned&#148; by another user, or when a single item is shared among multiple documents, as shown in Figure 13.1.</P>
<p><a name="Fig1"></A><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/067231486x/ch13/images/13-01.jpg',415,420 )"><img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/reference/pro/067231486x/ch13/images/13-01t.jpg"></A>
<br><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/067231486x/ch13/images/13-01.jpg',415,420)"><font color="#000077"><b>Figure 13.1</B></FONT></A>&nbsp;&nbsp;A linked object is physically located outside the compound document.</P>
<p>An <i>embedded</I> component object is stored inside the compound document, as shown in Figure 13.2. Using embedding is useful when a document must be transferred or relocated, because all the information is stored inside the compound document. In addition, embedded objects can take advantage of visual editing, which is discussed in the next section.</P>
<p><a name="Fig2"></A><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/067231486x/ch13/images/13-02.jpg',415,420 )"><img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/reference/pro/067231486x/ch13/images/13-02t.jpg"></A>
<br><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/067231486x/ch13/images/13-02.jpg',415,420)"><font color="#000077"><b>Figure 13.2</B></FONT></A>&nbsp;&nbsp;An embedded object is physically stored inside the compound document.</P>
<h4 align="LEFT"><a name="Heading5"></A><font color="#000077">Visual Editing</FONT></H4>
<p>Visual editing, also known as <i>in-place activation</I>, allows an OLE container to activate a server for an embedded component object &#147;in place.&#148; The container and the server share the user interface, thus enabling a user to interact with a component object without switching applications. This greatly simplifies the user&#146;s view of how a document is managed. From the user&#146;s perspective, the entire document seems to be edited within a single application.</P>
<p>As an example, consider a spreadsheet object embedded in a word processing compound document, as shown in Figure 13.3.</P>
<p>If the spreadsheet object is edited, the server for the spreadsheet object, Microsoft Excel, activates in place, as shown in Figure 13.4.</P>
<p>As you can see in Figure 13.4, the container and server have merged various elements of their user interfaces. Although the container has not changed, it now hosts many of the menus and toolbar items that belong to the Excel spreadsheet.</P>
<p>After editing is complete, the container resumes control of the user interface, as shown in Figure 13.3.</P>
<p><a name="Fig3"></A><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/067231486x/ch13/images/13-03.jpg',800,600 )"><img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/reference/pro/067231486x/ch13/images/13-03t.jpg"></A>
<br><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/067231486x/ch13/images/13-03.jpg',800,600)"><font color="#000077"><b>Figure 13.3</B></FONT></A>&nbsp;&nbsp;An Excel spreadsheet embedded in a Word document.</P>
<p><a name="Fig4"></A><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/067231486x/ch13/images/13-04.jpg',800,600 )"><img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/reference/pro/067231486x/ch13/images/13-04t.jpg"></A>
<br><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/067231486x/ch13/images/13-04.jpg',800,600)"><font color="#000077"><b>Figure 13.4</B></FONT></A>&nbsp;&nbsp;Microsoft Excel activated inside the Word container.</P>
<h4 align="LEFT"><a name="Heading6"></A><font color="#000077">Automation</FONT></H4>
<p>Automation, formerly known as <i>OLE Automation</I>, enables programs and components to expose programmable interfaces that can be controlled by other processes. Automation always involves an Automation controller&#151;usually a programming environment such as Visual Basic or a scripting host such as the Windows Scripting Host (WSH)&#151;and an Automation server that exposes a set of programmable interfaces.</P>
<p>Automation is a large topic&#151;in fact, Chapter 14, &#147;Automation,&#148; is devoted entirely to this topic.</P>
<h4 align="LEFT"><a name="Heading7"></A><font color="#000077">OLE Data Transfer</FONT></H4>
<p>OLE includes an extendable data transfer technology that provides a flexible and efficient method for transferring data from a data source to a consumer. Instead of depending on a single representation of a data object transferred through the Clipboard using a global memory handle, COM and OLE data objects that are aware of the OLE data transfer mechanism can negotiate the most appropriate method for transferring data, depending on the needs and capabilities of the consumer.
</P>
<p>When the Clipboard is used, data must be transferred via a global memory handle, which is extremely inefficient for large items such as bitmaps or multimedia clips. The COM data transfer mechanism, sometimes called <i>Uniform Data Transfer</I>, or <i>UDT</I>, allows data to be transferred as a reference to a file or other storage object, thus speeding up the transfer operation.</P>
<p>Uniform data transfer also supports the idea of notifications when a data source changes its representation of a data object.</P><p><br></P>
<center>
<table border>
<tr>
<td><a href="../ch12/12-06.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="13-02.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>


</font></BODY></HTML>