<html>
<head>
<meta name=vsisbn content="1882419685">
<meta name=vstitle content="1001 Secrets for Windows NT Registry">
<meta name=vsauthor content="Tim Daniels">
<meta name=vspublisher content="29th Street Press">
<meta name=vspubdate content="12/01/97">
<meta name=vscategory content="Operating Systems: Windows NT">





<title>1001 Secrets for Windows NT Registry:Security</TITLE>
<!-- BEGIN HEADER -->
<meta name="ROBOTS" content="NOINDEX, NOFOLLOW">
<script>
<!--
function displayWindow(url, width, height) {
        var Win = window.open(url,"displayWindow",'width=' + width +
',height=' + height + ',resizable=1,scrollbars=yes');
}
//--></SCRIPT>

<!-- HEADER -->
<style type="text/css"> 
 <!--
 A:hover  {
 	color : Red;
 }
 -->
 </STYLE>

</HEAD>
<BODY bgcolor=#FFFFFF><FONT size=2 face="Arial, verdana, helvetica"><table width=100% border=0 cellspacing=0 cellpadding=2><tr bgcolor=#000000><td width=100% align=right><b><font color=#FFFFFF>Gotcha</font></b></td></tr></table><br><!--Begin Content Column -->

<table border=0 cellspacing=0 cellpadding=0>
<tr>
<td width=75 valign=top>
<img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/images/sm_covers/1882419685.gif" width=60 height=73 alt="1001 Secrets for Windows NT Registry" border="1">
</td>
<td align="left">
    <font face="arial, helvetica" size="-1" color="#336633"><b>1001 Secrets for Windows NT Registry</b></font>
    <br>
    <font face="arial, helvetica" size="-1"><i>by Tim Daniels</i>
    <br>
    29th Street Press
    <br>
    <b>ISBN:</b>&nbsp;1882419685<b>&nbsp;&nbsp;&nbsp;Pub Date:</b>&nbsp;12/01/97</font>
</td>
</tr>
</table>
<p>
<!-- Empty Reference Subhead-->

<!--ISBN=1882419685//-->
<!--TITLE=1001 Secrets for Windows NT Registry//-->
<!--AUTHOR=Tim Daniels//-->
<!--PUBLISHER=29th Street Press//-->
<!--CHAPTER=5//-->
<!--PAGES=270-272//-->
<!--UNASSIGNED1//-->
<!--UNASSIGNED2//-->

<center>
<table border>
<tr>
<td><a href="267-270.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="../ch06/273-275.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<p><br></P>
<h3><a name="Heading4"></A><font color="#000077">Print Driver Installation</FONT></H3>
<table width="100%">
<tr>
<td width="10%"><b>V-27</B>
<td width="20%" align="RIGHT"><b>Hive:</B>
<td width="70%">HKEY_LOCAL_MACHINE
<tr>
<td>
<td align="RIGHT" valign="TOP"><b>Key:</B>
<td>System\CurrentControlSet\Control\Print\Providers\ LanMan Print Services
<tr>
<td>
<td align="RIGHT"><b>Value Name:</B>
<td>AddPrinterDrivers
<tr>
<td>
<td align="RIGHT"><b>Data Type:</B>
<td>Dword
<tr>
<td>
<td align="RIGHT"><b>Value:</B>
<td>1
</TABLE>
<p>This value prevents users from adding printers on the local machine. It does not prevent additions from the network.
</P>
<h3><a name="Heading5"></A><font color="#000077">Removable Media</FONT></H3>
<p><b>V-28</B> <big>T</BIG>his registry entry restricts access to the floppy disk drives on a system to only those users who are logged on interactively.</P>
<table width="100%"><tr>
<td width="30%" align="RIGHT"><b>Hive:</B>
<td width="70%">HKEY_LOCAL_MACHINE
<tr>
<td align="RIGHT" valign="TOP"><b>Key:</B>
<td>SOFTWARE\Microsoft\WindowsNT\CurrentVersion\ Winlogon
</TABLE>
<p>Add the following value under the WinLogon key:
</P>
<table width="100%"><tr>
<td width="10%">
<td width="20%" align="RIGHT"><b>Value Name:</B>
<td width="70%">AllocateFloppies
<tr>
<td>
<td align="RIGHT"><b>Data Type:</B>
<td>REG_SZ
<tr>
<td>
<td align="RIGHT"><b>Value:</B>
<td>1
</TABLE>
<p><b>V-29</B> <big>Y</BIG>ou can restrict the CD-ROMs as well.</P>
<table width="100%"><tr>
<td width="30%" align="RIGHT"><b>Hive:</B>
<td width="70%">HKEY_LOCAL_MACHINE
<tr>
<td align="RIGHT" valign="TOP"><b>Key:</B>
<td>SOFTWARE\Microsoft\WindowsNT\CurrentVersion\ Winlogon
</TABLE>
<p>Add the following value under the WinLogon key:
</P>
<table width="100%"><tr>
<td width="10%">
<td width="20%" align="RIGHT"><b>Value Name:</B>
<td width="70%">AllocateCDRoms
<tr>
<td>
<td align="RIGHT"><b>Data Type:</B>
<td>REG_SZ
<tr>
<td>
<td align="RIGHT"><b>Value:</B>
<td>1
</TABLE>
<p>If either of these registry entries doesn&#146;t exist or is set to a value other than 1, all floppy and CD-ROM devices are available for shared use to all processes on the system.
</P>
<h3><a name="Heading6"></A><font color="#000077">Auditing Base System Objects</FONT></H3>
<p><b>V-30</B> <big>I</BIG>f you need to audit the base system objects on your Windows NT Server or Workstation, add the following registry value.</P>
<table width="100%"><tr>
<td width="30%" align="RIGHT"><b>Hive:</B>
<td width="70%">HKEY_LOCAL_MACHINE
<tr>
<td align="RIGHT"><b>Key:</B>
<td>System\CurrentControlSet\Control\Lsa:
</TABLE>
<p>Add the following value under the Lsa key:
</P>
<table width="100%"><tr>
<td width="10%">
<td width="20%" align="RIGHT"><b>Value Name:</B>
<td width="70%">AuditBaseObjects
<tr>
<td>
<td align="RIGHT"><b>Data Type:</B>
<td>REG_DWORD
<tr>
<td>
<td align="RIGHT"><b>Value:</B>
<td>1
</TABLE>
<p>You need to turn on auditing in User Manager for the &#147;Object Access&#148; category to actually begin auditing.
</P>
<h3><a name="Heading7"></A><font color="#000077">Full Privilege Auditing</FONT></H3>
<p><b>V-31</B> <big>N</BIG>ot all privileges are audited by Windows NT by default. Modifying this registry entry lets you audit these additional privileges.</P>
<table width="100%"><tr>
<td width="30%" align="RIGHT"><b>Hive:</B>
<td width="70%">HKEY_LOCAL_MACHINE
<tr>
<td align="RIGHT"><b>Key:</B>
<td>System\CurrentControlSet\Control\Lsa:
</TABLE>
<p>Add the following value under the Lsa key:
</P>
<table width="100%"><tr>
<td width="10%">
<td width="20%" align="RIGHT"><b>Value Name:</B>
<td width="70%">FullPrivilegeAuditing
<tr>
<td>
<td align="RIGHT"><b>Data Type:</B>
<td>REG_BINARY
<tr>
<td>
<td align="RIGHT"><b>Value:</B>
<td>1
</TABLE>
<p>The additional privileges audited are bypass traverse checking, debug programs, create a token object, replace process level token, generate security audits, back up files and directories, and restore files and directories.
</P>
<h3><a name="Heading8"></A><font color="#000077">Shutdown on Full Audit Log</FONT></H3>
<p><b>V-32</B> <big>I</BIG>f you monitor your logs closely, you may want to enable this feature. When the security log is full, Windows NT shuts down. The registry value is then set to 2, and when the system reboots, only administrators can log on. The administrator must clean out the log, reset the value to 1, and reboot the system before users can log on.</P>
<table width="100%"><tr>
<td width="30%" align="RIGHT"><b>Hive:</B>
<td width="70%">HKEY_LOCAL_MACHINE
<tr>
<td align="RIGHT"><b>Key:</B>
<td>System\CurrentControlSet\Control\Lsa:
</TABLE>
<p>Add the following value under the Lsa key:
</P>
<table width="100%"><tr>
<td width="10%">
<td width="20%" align="RIGHT"><b>Value Name:</B>
<td width="70%">CrashOnAuditFail
<tr>
<td>
<td align="RIGHT"><b>Data Type:</B>
<td>REG_DWORD
<tr>
<td>
<td align="RIGHT"><b>Value:</B>
<td>1
</TABLE>
<p><br></P>
<center>
<table border>
<tr>
<td><a href="267-270.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="../ch06/273-275.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>


</font></BODY></HTML>