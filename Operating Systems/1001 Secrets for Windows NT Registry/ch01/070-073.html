<html>
<head>
<meta name=vsisbn content="1882419685">
<meta name=vstitle content="1001 Secrets for Windows NT Registry">
<meta name=vsauthor content="Tim Daniels">
<meta name=vspublisher content="29th Street Press">
<meta name=vspubdate content="12/01/97">
<meta name=vscategory content="Operating Systems: Windows NT">





<title>1001 Secrets for Windows NT Registry:General System</TITLE>
<!-- BEGIN HEADER -->
<meta name="ROBOTS" content="NOINDEX, NOFOLLOW">
<script>
<!--
function displayWindow(url, width, height) {
        var Win = window.open(url,"displayWindow",'width=' + width +
',height=' + height + ',resizable=1,scrollbars=yes');
}
//--></SCRIPT>

<!-- HEADER -->
<style type="text/css"> 
 <!--
 A:hover  {
 	color : Red;
 }
 -->
 </STYLE>

</HEAD>
<BODY bgcolor=#FFFFFF><FONT size=2 face="Arial, verdana, helvetica"><table width=100% border=0 cellspacing=0 cellpadding=2><tr bgcolor=#000000><td width=100% align=right><b><font color=#FFFFFF>Gotcha</font></b></td></tr></table><br><!--Begin Content Column -->

<table border=0 cellspacing=0 cellpadding=0>
<tr>
<td width=75 valign=top>
<img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/images/sm_covers/1882419685.gif" width=60 height=73 alt="1001 Secrets for Windows NT Registry" border="1">
</td>
<td align="left">
    <font face="arial, helvetica" size="-1" color="#336633"><b>1001 Secrets for Windows NT Registry</b></font>
    <br>
    <font face="arial, helvetica" size="-1"><i>by Tim Daniels</i>
    <br>
    29th Street Press
    <br>
    <b>ISBN:</b>&nbsp;1882419685<b>&nbsp;&nbsp;&nbsp;Pub Date:</b>&nbsp;12/01/97</font>
</td>
</tr>
</table>
<p>
<!-- Empty Reference Subhead-->

<!--ISBN=1882419685//-->
<!--TITLE=1001 Secrets for Windows NT Registry//-->
<!--AUTHOR=Tim Daniels//-->
<!--PUBLISHER=29th Street Press//-->
<!--CHAPTER=1//-->
<!--PAGES=070-073//-->
<!--UNASSIGNED1//-->
<!--UNASSIGNED2//-->

<center>
<table border>
<tr>
<td><a href="067-070.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="073-076.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<p><br></P>
<h3><a name="Heading17"></A><font color="#000077">Uninstallation</FONT></H3>
<p><b>I-260</B> <big>H</BIG>ave you ever installed some trial software and removed it at the end of the demo period, only to be plagued by the annoying message &#147;Cannot find file C:\filename&#148; (or one of its components)? Try this registry entry to correct the problem.</P>
<table width="100%"><tr>
<td width="30%" align="RIGHT"><b>Hive:</B>
<td width="70%">HKEY_CURRENT_USER
<tr>
<td align="RIGHT"><b>Key:</B>
<td>Software\Microsoft\Windows\CurrentVersion
<tr>
<td align="RIGHT"><b>Value Name:</B>
<td>Run
<tr>
<td align="RIGHT"><b>Data Type:</B>
<td>REG_SZ
<tr>
<td align="RIGHT"><b>Value:</B>
<td>&lt;filename&gt;
</TABLE>
<h3><a name="Heading18"></A><font color="#000077">Registry</FONT></H3>
<p><b>I-261</B> <big>P</BIG>roblem: Windows NT 4.0 Server requires that people who can remotely access the registry on a given machine belong to the Administrator group. However, someone is still tampering with your registry. To change the permissions, modify this registry entry.</P>
<table width="100%"><tr>
<td width="30%" align="RIGHT"><b>Hive:</B>
<td width="70%">HKEY_LOCAL_MACHINE
<tr>
<td align="RIGHT" valign="TOP"><b>Key:</B>
<td>System\CurrentControlSet\Control\ SecurePipeServers\winreg
</TABLE>
<p>Change the permissions on this key to whomever you wish to give access to. The default is Administrators Full Control.
</P>
<p><b>I-262</B> <big>I</BIG>n Windows NT Workstation, the Winreg key is not in the registry by default. If you add this key to the registry, you must also add the subkey Allowedpaths. Here is the AllowedPaths key under a clean install of Windows NT Server 4.0</P>
<table width="100%"><tr>
<td width="30%" align="RIGHT"><b>Hive:</B>
<td width="70%">HKEY_LOCAL_MACHINE
<tr>
<td align="RIGHT" valign="TOP"><b>Key:</B>
<td>System\CurrentControlSet\Control\SecurePipeServers\ winreg\AllowedPaths
<tr>
<td align="RIGHT"><b>Value Name:</B>
<td>Machine
<tr>
<td align="RIGHT"><b>DataType:</B>
<td>REG_MULTI_SZ
<tr>
<td align="RIGHT"><b>Value:</B>
<td>System\CurrentControlSet\Control\ProductOptions
</TABLE>
<p>
</P>
<table width="100%"><tr>
<td width="10%"><b>I-263</B>
<td width="20%" align="RIGHT"><b>Value:</B>
<td width="70%">System\CurrentControlSet\Control\Print\Printers
</TABLE>
<p>
</P>
<table width="100%"><tr>
<td width="10%"><b>I-264</B>
<td width="20%" align="RIGHT"><b>Value:</B>
<td width="70%">System\CurrentControlSet\Services\Eventlog
</TABLE>
<p>
</P>
<table width="100%"><tr>
<td width="10%"><b>I-265</B>
<td width="20%" align="RIGHT"><b>Value:</B>
<td width="70%">Software\Microsoft\Windows NT\CurrentVersion
</TABLE>
<p>Restart your machine for these new values to take effect.
</P>
<p><b>I-266</B> <big>D</BIG>id you ever wonder where the registry files are stored? Well, where else would you expect to find the answer but in the registry itself?</P>
<table width="100%"><tr>
<td width="30%" align="RIGHT"><b>Hive:</B>
<td width="70%">HKEY_LOCAL_MACHINE
<tr>
<td align="RIGHT"><b>Key:</B>
<td>System\CurrentControlSet\Control\Hivelist
<tr>
<td align="RIGHT"><b>Value Name:</B>
<td>Registry\Machine\Clone
<tr>
<td align="RIGHT"><b>Data Type:</B>
<td>REG_SZ
<tr>
<td align="RIGHT"><b>Value:</B>
<td>
</TABLE>
<p>This registry entry stores the clone hive information.
</P>
<table width="100%"><tr>
<td width="10%"><b>I-267</B>
<td width="20%" align="RIGHT"><b>Value Name:</B>
<td width="70%">Registry\Machine\Hardware
<tr>
<td>
<td align="RIGHT"><b>Data Type:</B>
<td>REG_SZ
<tr>
<td>
<td align="RIGHT"><b>Value:</B>
<td>
</TABLE>
<p>This registry entry stores hardware hive information.
</P>
<table width="100%"><tr>
<td width="10%"><b>I-268</B>
<td width="20%" align="RIGHT"><b>Value Name:</B>
<td width="70%">Registry\Machine\SAM
<tr>
<td>
<td align="RIGHT"><b>Data Type:</B>
<td>REG_SZ
<tr>
<td>
<td align="RIGHT"><b>Value:</B>
<td>Device\Harddisk0\Partition1\NTS40\System32\Config\SAM
</TABLE>
<p>This registry entry stores all the SAM information.
</P>
<table width="100%"><tr>
<td width="10%"><b>I-269</B>
<td width="20%" align="RIGHT"><b>Value Name:</B>
<td width="70%">Registry\Machine\Security
<tr>
<td>
<td align="RIGHT"><b>Data Type:</B>
<td>REG_SZ
<tr>
<td>
<td align="RIGHT"><b>Value:</B>
<td>Device\Harddisk0\Partition1\NTS40\System32\Config\Security
</TABLE>
<p>This file stores information for the grayed-out Security hive.
</P>
<table width="100%"><tr>
<td width="10%"><b>I-270</B>
<td width="20%" align="RIGHT"><b>Value Name:</B>
<td width="70%">Registry\Machine\Software
<tr>
<td>
<td align="RIGHT"><b>Data Type:</B>
<td>REG_SZ
<tr>
<td>
<td align="RIGHT"><b>Value:</B>
<td>Device\Harddisk0\Partition1\NTS40\System32\Config\ Software
</TABLE>
<p>This file contains the value for the Software hive.
</P>
<table width="100%"><tr>
<td width="10%"><b>I-271</B>
<td width="20%" align="RIGHT"><b>Value Name:</B>
<td width="70%">Registry\Machine\System
<tr>
<td>
<td align="RIGHT"><b>Data Type:</B>
<td>REG_SZ
<tr>
<td>
<td align="RIGHT"><b>Value:</B>
<td>Device\Harddisk0\Partition1\NTS40\System32\Config\System
</TABLE>
<p>This entry shows where the System hive is stored.
</P>
<table width="100%"><tr>
<td width="10%"><b>I-272</B>
<td width="20%" align="RIGHT"><b>Value Name:</B>
<td width="70%">Registry\User\Default
<tr>
<td>
<td align="RIGHT"><b>Data Type:</B>
<td>REG_SZ
<tr>
<td>
<td align="RIGHT"><b>Value:</B>
<td>Device\Harddisk0\Partition1\NTS40\System32\Config\Default
</TABLE>
<p>This entry shows where the default values for the user hive are stored.
</P>
<table width="100%"><tr>
<td width="10%"><b>I-273</B>
<td width="20%" align="RIGHT"><b>Value Name:</B>
<td width="70%">Registry\User\&lt;big long user id number&gt;
<tr>
<td>
<td align="RIGHT"><b>Data Type:</B>
<td>REG_SZ
<tr>
<td>
<td align="RIGHT"><b>Value:</B>
<td>Device\Harddisk0\Partition1\NTS40\Profiles\&lt;username&gt;\ Ntuser.dat
</TABLE>
<p>This entry shows the user data for the current logged-on user.
</P><p><br></P>
<center>
<table border>
<tr>
<td><a href="067-070.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="073-076.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>


</font></BODY></HTML>