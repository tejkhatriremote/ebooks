<html>
<head>
<meta name=vsisbn content="1882419685">
<meta name=vstitle content="1001 Secrets for Windows NT Registry">
<meta name=vsauthor content="Tim Daniels">
<meta name=vspublisher content="29th Street Press">
<meta name=vspubdate content="12/01/97">
<meta name=vscategory content="Operating Systems: Windows NT">





<title>1001 Secrets for Windows NT Registry:General System</TITLE>
<!-- BEGIN HEADER -->
<meta name="ROBOTS" content="NOINDEX, NOFOLLOW">
<script>
<!--
function displayWindow(url, width, height) {
        var Win = window.open(url,"displayWindow",'width=' + width +
',height=' + height + ',resizable=1,scrollbars=yes');
}
//--></SCRIPT>

<!-- HEADER -->
<style type="text/css"> 
 <!--
 A:hover  {
 	color : Red;
 }
 -->
 </STYLE>

</HEAD>
<BODY bgcolor=#FFFFFF><FONT size=2 face="Arial, verdana, helvetica"><table width=100% border=0 cellspacing=0 cellpadding=2><tr bgcolor=#000000><td width=100% align=right><b><font color=#FFFFFF>Gotcha</font></b></td></tr></table><br><!--Begin Content Column -->

<table border=0 cellspacing=0 cellpadding=0>
<tr>
<td width=75 valign=top>
<img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/images/sm_covers/1882419685.gif" width=60 height=73 alt="1001 Secrets for Windows NT Registry" border="1">
</td>
<td align="left">
    <font face="arial, helvetica" size="-1" color="#336633"><b>1001 Secrets for Windows NT Registry</b></font>
    <br>
    <font face="arial, helvetica" size="-1"><i>by Tim Daniels</i>
    <br>
    29th Street Press
    <br>
    <b>ISBN:</b>&nbsp;1882419685<b>&nbsp;&nbsp;&nbsp;Pub Date:</b>&nbsp;12/01/97</font>
</td>
</tr>
</table>
<p>
<!-- Empty Reference Subhead-->

<!--ISBN=1882419685//-->
<!--TITLE=1001 Secrets for Windows NT Registry//-->
<!--AUTHOR=Tim Daniels//-->
<!--PUBLISHER=29th Street Press//-->
<!--CHAPTER=1//-->
<!--PAGES=097-100//-->
<!--UNASSIGNED1//-->
<!--UNASSIGNED2//-->

<center>
<table border>
<tr>
<td><a href="095-097.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="100-103.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<p><br></P>
<p><b>I-347</B> <big>I</BIG>f you need to see what a client&#146;s DHCP parameters were before the most recent changes, you can find them in the following registry entries. Note that you find this out by looking at the ControlSet001 value, which is different from the CurrentControlSet value. To go back one more revision, you can look at ControlSet002 value.</P>
<table width="100%"><tr>
<td width="30%" align="RIGHT"><b>Hive:</B>
<td width="70%">HKEY_LOCAL_MACHINE
<tr>
<td align="RIGHT" valign="TOP"><b>Key:</B>
<td>System\ControlSet001\Services\&lt;adapter name&gt;\ Parameters\Tcpip
</TABLE>
<p>The following list of DHCP values is available under the Tcpip key:
</P>
<table width="100%"><tr>
<td width="30%" align="RIGHT"><b>Value Name:</B>
<td width="70%">DefaultGateway
<tr>
<td align="RIGHT"><b>Data Type:</B>
<td>REG_MULTI_SZ
<tr>
<td align="RIGHT"><b>Value:</B>
<td>0.0.0.0
</TABLE>
<p>
</P>
<table width="100%"><tr>
<td width="10%"><b>I-348</B>
<td width="20%" align="RIGHT"><b>Value Name:</B>
<td width="70%">EnableDHCP
<tr>
<td>
<td align="RIGHT"><b>Data Type:</B>
<td>REG_DWORD
<tr>
<td>
<td align="RIGHT"><b>Value:</B>
<td>0x1
</TABLE>
<p>
</P>
<table width="100%"><tr>
<td width="10%"><b>I-349</B>
<td width="20%" align="RIGHT"><b>Value Name:</B>
<td width="70%">IPAddress
<tr>
<td>
<td align="RIGHT"><b>Data Type:</B>
<td>REG_MULTI_SZ
<tr>
<td>
<td align="RIGHT"><b>Value:</B>
<td>0.0.0.0
</TABLE>
<p>
</P>
<table width="100%"><tr>
<td width="10%"><b>I-350</B>
<td width="20%" align="RIGHT"><b>Value Name:</B>
<td width="70%">PPTPFiltering
<tr>
<td>
<td align="RIGHT"><b>Data Type:</B>
<td>REG_DWORD
<tr>
<td>
<td align="RIGHT"><b>Value:</B>
<td>0
</TABLE>
<p>
</P>
<table width="100%"><tr>
<td width="10%"><b>I-351</B>
<td width="20%" align="RIGHT"><b>Value Name:</B>
<td width="70%">SubnetMask
<tr>
<td>
<td align="RIGHT"><b>Data Type:</B>
<td>REG_MULTI_SZ
<tr>
<td>
<td align="RIGHT"><b>Value:</B>
<td>0.0.0.0
</TABLE>
<p>
</P>
<table width="100%"><tr>
<td width="10%"><b>I-352</B>
<td width="20%" align="RIGHT"><b>Value Name:</B>
<td width="70%">UseZeroBroadcast
<tr>
<td>
<td align="RIGHT"><b>Data Type:</B>
<td>REG_DWORD
<tr>
<td>
<td align="RIGHT"><b>Value:</B>
<td>0
</TABLE>
<p>You can edit any of these values. Reboot the machine for changes to take effect.
</P>
<h3><a name="Heading24"></A><font color="#000077">NETBIOS over TCP (NetBT)</FONT></H3>
<p><b>I-353</B> <big>I</BIG>f a client is having trouble with its NetBT configuration on Windows NT (see the Appendix for instructions for Windows 95) and you want to change or verify some of the settings, you can use the remote capability of Regedt32.exe. Using the Select Computer option, choose the computer you need to access and use these registry keys to view NetBT-related information. Generally, you set these with the Network Control Panel Application; however, it is very useful to be able to view these values remotely.</P>
<table width="100%"><tr>
<td width="30%" align="RIGHT"><b>Hive:</B>
<td width="70%">HKEY_LOCAL_MACHINE
<tr>
<td align="RIGHT"><b>Key:</B>
<td>System\CurrentControlSet\Services\NetBt\Parameters
<tr>
<td align="RIGHT"><b>Value Name:</B>
<td>EnableLmhosts
<tr>
<td align="RIGHT"><b>Data Type:</B>
<td>REG_DWORD
<tr>
<td align="RIGHT"><b>Value:</B>
<td>1
</TABLE>
<p>When this registry entry is set to 1, NetBT uses the LMHOSTS file to resolve any outstanding queries that couldn&#146;t be resolved using WINS or broadcasts.
</P>
<table width="100%"><tr>
<td width="10%"><b>I-354</B>
<td width="20%" align="RIGHT"><b>Hive:</B>
<td width="70%">HKEY_LOCAL_MACHINE
<tr>
<td>
<td align="RIGHT" valign="TOP"><b>Key:</B>
<td>System\CurrentControlSet\Services\LanmanServer\ Parameters
</TABLE>
<p>Add the following value under the Parameters key:
</P>
<table width="100%"><tr>
<td width="30%" align="RIGHT"><b>Value Name:</B>
<td width="70%">OptionalNames
<tr>
<td align="RIGHT"><b>Data Type:</B>
<td>REG_SZ
<tr>
<td align="RIGHT"><b>Value:</B>
<td>&lt; any name you want as an alias&gt;
</TABLE>
<p>You can then use this alias for any command that requires a server, such as Net Use.
</P>
<table width="100%"><tr>
<td width="10%"><b>I-355</B>
<td width="20%" align="RIGHT"><b>Hive:</B>
<td width="70%">HKEY_LOCAL_MACHINE
<tr>
<td>
<td align="RIGHT"><b>Key:</B>
<td>System\CurrentControlSet\Services\NetBt\Parameters
<tr>
<td>
<td align="RIGHT"><b>Value Name:</B>
<td>EnableDns
<tr>
<td>
<td align="RIGHT"><b>Data Type:</B>
<td>REG_DWORD
<tr>
<td>
<td align="RIGHT"><b>Value:</B>
<td>0
</TABLE>
<p>When this registry entry is set to 1, NetBT uses DNS to resolve queries that it could not resolve with WINS, broadcast, or the LMHOSTS file.
</P>
<table width="100%"><tr>
<td width="10%"><b>I-356</B>
<td width="20%" align="RIGHT"><b>Hive:</B>
<td width="70%">HKEY_LOCAL_MACHINE
<tr>
<td>
<td align="RIGHT"><b>Key:</B>
<td>System\CurrentControlSet\Services\NetBt\Parameters
<tr>
<td>
<td align="RIGHT"><b>Value Name:</B>
<td>EnableProxy
<tr>
<td>
<td align="RIGHT"><b>Data Type:</B>
<td>REG_DWORD
<tr>
<td>
<td align="RIGHT"><b>Value:</B>
<td>0
</TABLE>
<p>When this registry entry is set to 1, the machine acts as a proxy name server for networks that are bound to NetBT. A proxy name server answers other clients&#146; name queries for system names it has resolved via WINS.
</P>
<table width="100%"><tr>
<td width="10%"><b>I-357</B>
<td width="20%" align="RIGHT"><b>Hive:</B>
<td width="70%">HKEY_LOCAL_MACHINE
<tr>
<td>
<td align="RIGHT"><b>Key:</B>
<td>System\CurrentControlSet\Services\NetBt\Parameters
<tr>
<td>
<td align="RIGHT"><b>Value Name:</B>
<td>NameServer
<tr>
<td>
<td align="RIGHT"><b>Data Type:</B>
<td>REG_DWORD
<tr>
<td>
<td align="RIGHT"><b>Value:</B>
<td>&lt;any valid IP address&gt;
</TABLE>
<p>This value is the address of the machine that the client machine uses for WINS queries. The default value is blank.
</P>
<table width="100%"><tr>
<td width="10%"><b>I-358</B>
<td width="20%" align="RIGHT"><b>Hive:</B>
<td width="70%">HKEY_LOCAL_MACHINE
<tr>
<td>
<td align="RIGHT"><b>Key:</B>
<td>System\CurrentControlSet\Services\NetBt\Parameters
<tr>
<td>
<td align="RIGHT"><b>Value Name:</B>
<td>NameServerBackup
<tr>
<td>
<td align="RIGHT"><b>Data Type:</B>
<td>REG_DWORD
<tr>
<td>
<td align="RIGHT"><b>Value:</B>
<td>&lt;any valid IP address&gt;
</TABLE>
<p>This is the address of the secondary WINS server. If the machine whose value is stored in NameServer cannot be reached, the machine at this address is queried.
</P>
<table width="100%"><tr>
<td width="10%"><b>I-359</B>
<td width="20%" align="RIGHT"><b>Hive:</B>
<td width="70%">HKEY_LOCAL_MACHINE
<tr>
<td>
<td align="RIGHT"><b>Key:</B>
<td>System\CurrentControlSet\Services\NetBt\Parameters
<tr>
<td>
<td align="RIGHT"><b>Value Name:</B>
<td>ScopeID
<tr>
<td>
<td align="RIGHT"><b>Data Type:</B>
<td>REG_DWORD
<tr>
<td>
<td align="RIGHT"><b>Value:</B>
<td>&lt;any valid DNS domain name&gt; Example: Winntmag.com
</TABLE>
<p>This value governs the NetBios name scope. Any valid DNS domain name automatically overrides the DHCP-assigned equivalent.
</P><p><br></P>
<center>
<table border>
<tr>
<td><a href="095-097.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="100-103.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>


</font></BODY></HTML>