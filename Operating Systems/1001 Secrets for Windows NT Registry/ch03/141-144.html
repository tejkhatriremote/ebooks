<html>
<head>
<meta name=vsisbn content="1882419685">
<meta name=vstitle content="1001 Secrets for Windows NT Registry">
<meta name=vsauthor content="Tim Daniels">
<meta name=vspublisher content="29th Street Press">
<meta name=vspubdate content="12/01/97">
<meta name=vscategory content="Operating Systems: Windows NT">





<title>1001 Secrets for Windows NT Registry:Applications</TITLE>
<!-- BEGIN HEADER -->
<meta name="ROBOTS" content="NOINDEX, NOFOLLOW">
<script>
<!--
function displayWindow(url, width, height) {
        var Win = window.open(url,"displayWindow",'width=' + width +
',height=' + height + ',resizable=1,scrollbars=yes');
}
//--></SCRIPT>

<!-- HEADER -->
<style type="text/css"> 
 <!--
 A:hover  {
 	color : Red;
 }
 -->
 </STYLE>

</HEAD>
<BODY bgcolor=#FFFFFF><FONT size=2 face="Arial, verdana, helvetica"><table width=100% border=0 cellspacing=0 cellpadding=2><tr bgcolor=#000000><td width=100% align=right><b><font color=#FFFFFF>Gotcha</font></b></td></tr></table><br><!--Begin Content Column -->

<table border=0 cellspacing=0 cellpadding=0>
<tr>
<td width=75 valign=top>
<img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/images/sm_covers/1882419685.gif" width=60 height=73 alt="1001 Secrets for Windows NT Registry" border="1">
</td>
<td align="left">
    <font face="arial, helvetica" size="-1" color="#336633"><b>1001 Secrets for Windows NT Registry</b></font>
    <br>
    <font face="arial, helvetica" size="-1"><i>by Tim Daniels</i>
    <br>
    29th Street Press
    <br>
    <b>ISBN:</b>&nbsp;1882419685<b>&nbsp;&nbsp;&nbsp;Pub Date:</b>&nbsp;12/01/97</font>
</td>
</tr>
</table>
<p>
<!-- Empty Reference Subhead-->

<!--ISBN=1882419685//-->
<!--TITLE=1001 Secrets for Windows NT Registry//-->
<!--AUTHOR=Tim Daniels//-->
<!--PUBLISHER=29th Street Press//-->
<!--CHAPTER=3//-->
<!--PAGES=141-144//-->
<!--UNASSIGNED1//-->
<!--UNASSIGNED2//-->

<center>
<table border>
<tr>
<td><a href="../ch02/137-140.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="144-147.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<p><br></P>
<h2><a name="Heading1"></A><font color="#000077">Section III<br>Applications
</FONT></H2>
<p>This section contains registry entries for all types of software, from Microsoft SQL Server to Netscape to Windows NT system information. Office 97 applications have their own section.
</P>
<h3><a name="Heading2"></A><font color="#000077">SMS 1.2</FONT></H3>
<p><b>III-1</B> <big>W</BIG>hen SMS creates a package for distribution, it first compresses all the files in the package and then sends the package to the site server. The site server expands the compressed package into a Temp directory. By default, SMS creates the Temp directory on the biggest drive with at least 100 megabytes of available space. Changing this registry value lets you specify which drive SMS uses as the preferred drive. If the minimum conditions aren&#146;t met (100 MB and NTFS), SMS searches for a more suitable drive.</P>
<table width="100%"><tr>
<td width="30%" align="RIGHT"><b>Hive:</B>
<td width="70%">HKEY_LOCAL_MACHINE
<tr>
<td align="RIGHT"><b>Key:</B>
<td>Software\Microsoft\SMS\Components\SMS_DESPOOLER
<tr>
<td align="RIGHT"><b>Value Name:</B>
<td>PreferredDriveForTempDirectory
<tr>
<td align="RIGHT"><b>Data Type:</B>
<td>REG_SZ
<tr>
<td align="RIGHT"><b>Value:</B>
<td>&lt; valid drive letter &gt;
</TABLE>
<p>Restart the machine for these values to take effect.
</P>
<p><b>III-2</B> <big>S</BIG>MS needs a directory to copy the decompressed package to. By default, it looks at the drive that contains the SMS_SHR and determines whether that drive has at least 100 MB of free space. If it does, SMS creates the SMS_PKGx directory there. SMS by default uses the NTFS volume with the most free space. To change the minimum drive space required for this process, change the following registry entry.</P>
<table width="100%"><tr>
<td width="30%" align="RIGHT"><b>Hive:</B>
<td width="70%">HKEY_LOCAL_MACHINE
<tr>
<td align="RIGHT"><b>Key:</B>
<td>Software\Microsoft\SMS\Components\SMS_DESPOOLER
<tr>
<td align="RIGHT"><b>Value Name:</B>
<td>SMSDriveMinimumFreeSpaceinMBytes
<tr>
<td align="RIGHT"><b>Data Type:</B>
<td>REG_DWORD
<tr>
<td align="RIGHT"><b>Value:</B>
<td>0x64
</TABLE>
<p>The value is in hexadecimal. Restart the machine for these values to take effect.
</P>
<p><b>III-3</B> <big>Y</BIG>our most effective tools for troubleshooting SMS performance problems are the different service logs. These registry entries let you maximize the amount of logging SMS performs. By analyzing these logs, you can get a pretty good picture of where the SMS bottlenecks are on your system.</P>
<table width="100%"><tr>
<td width="30%" align="RIGHT"><b>Hive:</B>
<td width="70%">HKEY_LOCAL_MACHINE
<tr>
<td align="RIGHT"><b>Key:</B>
<td>Software\Microsoft\SMS\Tracing
<tr>
<td align="RIGHT"><b>Value Name:</B>
<td>SQLEnabled
<tr>
<td align="RIGHT"><b>Data Type:</B>
<td>REG_DWORD
<tr>
<td align="RIGHT"><b>Value:</B>
<td>1
</TABLE>
<p>This value enables SMS to log its interactions with SQL Server. Restart the SMS Executive for this change to take effect.
</P>
<table width="100%"><tr>
<td width="10%"><b>III-4</B>
<td width="20%" align="RIGHT"><b>Hive:</B>
<td width="70%">HKEY_LOCAL_MACHINE
<tr>
<td>
<td align="RIGHT"><b>Key:</B>
<td>Software\Microsoft\SMS\Tracing
<tr>
<td>
<td align="RIGHT"><b>Value Name:</B>
<td>Enabled
<tr>
<td>
<td align="RIGHT"><b>Data Type:</B>
<td>REG_DWORD
<tr>
<td>
<td align="RIGHT"><b>Value:</B>
<td>1
<tr>
</TABLE>
<p>This value enables SMS logging. When this value is set to 1, SMS logs the results for all SMS services. Setting this value to 0 disables logging. Restart the SMS Executive for this change to take effect.
</P>
<p><b>III-5</B> <big>S</BIG>MS stores individual packages in compressed form before it ships them for distribution. This entry gives you the location of important information about these packages. This information is incredibly useful when debugging site distribution problems.</P>
<table width="100%"><tr>
<td width="30%" align="RIGHT"><b>Hive:</B>
<td width="70%">HKEY_LOCAL_MACHINE
<tr>
<td align="RIGHT" valign="TOP"><b>Key:</B>
<td>Software\Microsoft\SMS\Components\SMS_DESPOOLER\ MasterPackages
<tr>
<td align="RIGHT"><b>Key:</B>
<td>&lt; Package Name &gt;
</TABLE>
<p>SMS creates a key for each package. This key stays in the registry of the site server until the package is removed from the site server. See III-19 for more about SMS packages.
</P>
<table width="100%"><tr>
<td width="10%"><b>III-6</B>
<td width="20%" align="RIGHT"><b>Hive:</B>
<td width="70%">HKEY_LOCAL_MACHINE
<tr>
<td>
<td align="RIGHT" valign="TOP"><b>Key:</B>
<td>Software\Microsoft\SMS\Components\SMS_DESPOOLER\ MasterPackages
<tr>
<td>
<td align="RIGHT"><b>Value Name:</B>
<td>FileName
<tr>
<td>
<td align="RIGHT"><b>Data Type:</B>
<td>REG_DWORD
<tr>
<td>
<td align="RIGHT"><b>Value:</B>
<td>&lt; fully qualified path to the compressed package file &gt;
</TABLE>
<p>This value is the location where the compressed file for each job is stored; along with the directory, the value includes the filename in the format of JobID.wks. An example value is \\Machine_Name\SMS_SHRD\site.srv\ despoolr.box\store\&lt; JobID &gt;.wks.
</P><p><br></P>
<center>
<table border>
<tr>
<td><a href="../ch02/137-140.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="144-147.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>


</font></BODY></HTML>