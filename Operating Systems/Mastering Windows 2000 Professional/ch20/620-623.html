<html>
<head>
<meta name=vsisbn content="0782124488">
<meta name=vstitle content="Mastering Windows 2000 Professional">
<meta name=vsauthor content="Mark Minasi, Todd Phillips">
<meta name=vspublisher content="Sybex, Inc.">
<meta name=vspubdate content="01/01/00">
<meta name=vscategory content="Operations Systems: Windows 2000">



<title>Mastering Windows 2000 Professional:Installing Windows 2000 (and Automating Installation)</TITLE>
<!-- BEGIN HEADER -->
<meta name="ROBOTS" content="NOINDEX, NOFOLLOW">
<script>
<!--
function displayWindow(url, width, height) {
        var Win = window.open(url,"displayWindow",'width=' + width +
',height=' + height + ',resizable=1,scrollbars=yes');
}
//--></SCRIPT>

<!-- HEADER -->
<style type="text/css">
<!--
A:hover { color:red }
-->
</STYLE>

<!-- HEADER -->
<style type="text/css"> 
 <!--
 A:hover  {
 	color : Red;
 }
 -->
 </STYLE>

<script language="JavaScript1.2">
<!--
function checkForQuery(fm) {
  /* get the query value */
  var i = escape(fm.query.value);
  if (i == "") {
      alert('Please enter a search word or phrase');
      return false;
  }                  /* query is blank, dont run the .jsp file */
  else return true;  /* execute the .jsp file */
}
//--></script>

</HEAD>
<BODY bgcolor=#FFFFFF><FONT size=2 face="Arial, verdana, helvetica"><table width=100% border=0 cellspacing=0 cellpadding=2><tr bgcolor=#000000><td width=100% align=right><b><font color=#FFFFFF>Gotcha</font></b></td></tr></table><br><!--Begin Content Column -->

<table border=0 cellspacing=0 cellpadding=0>
<tr>
<td width=75 valign=top>
<img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/images/sm_covers/0782124488.gif" width=60 height=73 alt="Mastering Windows 2000 Professional" border="1">
</td>
<td align="left">
    <font face="arial, helvetica" size="-1" color="#336633"><b>Mastering Windows 2000 Professional</b></font>
    <br>
    <font face="arial, helvetica" size="-1"><i>by Mark Minasi, Todd Phillips</i>
    <br>
    Sybex, Inc.
    <br>
    <b>ISBN:</b>&nbsp;0782124488<b>&nbsp;&nbsp;&nbsp;Pub Date:</b>&nbsp;01/01/00</font>
</td>
</tr>
</table>
<p>
<!-- Empty Reference Subhead-->

<!--ISBN=0782124488//-->
<!--TITLE=Mastering Windows 2000 Professional//-->
<!--AUTHOR=Mark Minasi//-->
<!--AUTHOR=Todd Phillips//-->
<!--PUBLISHER=SYBEX//-->
<!--CHAPTER=20//-->
<!--PAGES=620-623//-->
<!--UNASSIGNED1//-->
<!--UNASSIGNED2//-->

<center>
<table border>
<tr>
<td><a href="617-620.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="623-624.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<p><br></P>
<h4 align="LEFT"><a name="Heading11"></A><font color="#000077">DHCP Service</FONT></H4>
<p>The installation program asks you if you have a DHCP server on your network. If so, it should provide the IP address for your workstation. If you don&#146;t have a DHCP server, or if you don&#146;t wish to use it, then enter a static IP address. If you&#146;re not sure what the static address should be, ask your system administrator. You&#146;re probably thinking, &#147;Are you kidding?&#148; but this time we mean it. Make sure that this address isn&#146;t already in use by another computer; otherwise, either your workstation or the one that is using the same IP address will not have full access to the network. If that happens, then you&#146;ll definitely have to see your system administrator, and she won&#146;t be happy. Please note that a full discussion of TCP/IP networking with NT can be found in Mark Minasi&#146;s <i>Mastering Windows 2000 Server</I> (Sybex, 2000). The ability to automatically configure your computer to use a reserved IP address if your computer is unable to locate a DHCP server on the network is new to Windows 2000. In this case, Windows 2000 will attempt to use a Class C reserved address to at least get on the network. Chances are, if you&#146;re using static addressing, this won&#146;t be the correct address for your network. Consult your network administrator for help in getting the correct address.</P>
<h4 align="LEFT"><a name="Heading12"></A><font color="#000077">Network Card</FONT></H4>
<p>Windows 2000 Professional will automatically detect your network card during Setup. If either your card can be recognized by Plug and Play, or if it&#146;s on the PCI bus, Setup will find it. Setup will then ask you if you want to install network support with Typical Settings or Custom Settings. If your card isn&#146;t detected, choose the Custom Settings where you can install the Microsoft Loopback adapter, which is an imitation network adapter. The benefit is that you can install all your network services here during Setup and install the correct drivers later.
</P>
<p><font size="+1"><b>Network Protocol</B></FONT></P>
<p>Windows 2000 will automatically install TCP/IP as your network protocol. You can easily add another protocol, or remove TCP/IP if your network uses a different protocol. To add another protocol, click the Install button and select Protocol as the type of component to add.
</P>
<p>Click the network protocol or protocols used in your network. Add all the protocols your machine will use. Your choices are as follows:</P>
<dl>
<dd><b>&#149;</B>&nbsp;&nbsp;TCP/IP (default)
<dd><b>&#149;</B>&nbsp;&nbsp;AppleTalk Protocol
<dd><b>&#149;</B>&nbsp;&nbsp;DLC Protocol
<dd><b>&#149;</B>&nbsp;&nbsp;NetBEUI Protocol
<dd><b>&#149;</B>&nbsp;&nbsp;NWlink IPX/SPX Compatible Transport Protocol
<dd><b>&#149;</B>&nbsp;&nbsp;OSI-LAN Protocol
</DL>
<blockquote>
<p><font size="-1"><hr><b>NOTE:&nbsp;&nbsp;</B>Because network protocols use resources such as memory, it&#146;s a good idea to install only the protocol(s) you need. Excess protocols also contribute to network congestion. Try to resist the temptation to install all of them just because you can.<hr></FONT>
</BLOCKQUOTE>
<p><font size="+1"><b>Creating a Domain Account</B></FONT></P>
<p>On the Workgroup or Computer Domain page of the Setup wizard, you are asked to decide whether this computer will be part of a workgroup or a domain. The first option is used to make the computer part of a workgroup. The second will make your computer part of a domain.
</P>
<p>Remember: To create a domain account, you must already possess a valid user ID on the domain that has administrative permissions. Without this ID, you won&#146;t be able to add the computer to the network yourself. Instead, you&#146;ll have to ask an administrator to create an account for you to use. The WINNT32 command remedies this problem by allowing the Administrator ID to run the Setup program. If you try to run WINNT32 under any other ID, you&#146;ll get an error message like the following:</P>
<p><a name="Fig3"></A><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/0782124488/ch20/images/20-03.jpg',317,119)"><img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/reference/pro/0782124488/ch20/images/20-03t.jpg"></A></P>
<p><font size="+1"><b>Last Step</B></FONT></P>
<p>The last thing that Setup does is install all of the components that you&#146;ve selected along the way. Once the file operations are completed, Setup will clean up after itself by deleting temporary files, setting the Registry, and restarting the computer.
</P>
<h3><a name="Heading13"></A><font color="#000077">Using Setup Manager to Automate Installation for Multiple Machines</FONT></H3>
<p>Installing Windows 2000 Professional is time-consuming. With an installation time of 20 to 30 minutes per machine, installing Windows 2000 on 20 machines can take a full day. Fortunately, you can use Windows 2000&#146;s Setup Manager to create a batch file called <tt>unattend.txt</TT> that will do a lot of the dirty work for you by automating the process. When you install Windows 2000 on the machines you&#146;ve selected, you would run an automatic installation from this file rather than from a typical setup boot floppy or CD-ROM by simply typing the <b>/unattend</B> switch with the WINNT32 command. The installation program then looks for the <tt>unattend</TT> file in a distribution server directory rather than on a floppy disk, copies it to a temporary directory called <tt>\$win_nt$.&#8764;ls</TT>, and runs from there.</P>
<p>To automate user input, you must of course provide Setup Manager with all the answers that would normally be required from users during a regular setup. (Otherwise, the installation program pauses for user input, even when the program is running in unattended mode, and just sits there waiting for someone to notice and deal with the situation.) Fortunately, Setup Manager offers all the options you&#146;d run into during almost any type of installation; moreover, using information already available to it via your network server, Setup Manager performs some of the browsing necessary for suggesting likely defaults.</P>
<p>Setup Manager is easy to run; just find <tt>setupmgr.exe</TT> in the Windows 2000 Resource Kit, run the program, and check all the options appropriate for each machine on which you&#146;d like to install Windows 2000. The options are available through Setup Manager&#146;s three main sets of dialog boxes: General Setup, Networking Setup, and Advanced Setup. Be sure to look through all the tab pages of each of these sets of dialog boxes to ensure that you don&#146;t miss some important settings, and remember to save the <tt>unattend.txt</TT> answer file that is created as a result of your input.</P>
<p><font size="+1"><b>Running the Unattended Installation</B></FONT></P>
<p>When using the WINNT32/unattend command or the WINNT/unattend command, by default, files are installed on the same drive as the temporary directory that your computer created. However, you can override the default location by specifying a <tt>/t</TT> parameter in the unattended Setup mode command.</P>
<p>To override the default location of a new installation on a computer running Windows NT Workstation, type the following command at the command prompt:</P>
<!-- CODE SNIP //-->
<pre>
   <b>WINNT32 /unattend:&lt;answerfile&gt; /t:&lt;destination&gt; /s:&lt;source&gt;</B>
</PRE>
<!-- END CODE SNIP //-->
<dl>
<dd><tt>&lt;<i>destination</I>&gt;</TT>&nbsp;&nbsp;Indicates the path where Windows 2000 Professional temporary files should be stored.
<dd><tt>&lt;<i>source</I>&gt;</TT>&nbsp;&nbsp;Indicates the path where the Windows 2000 files are located. Usually, these files are found the I386 directory.
</DL>
<p>In place of WINNT32, you can use the WINNT command if you are starting Setup from a 16-bit operating system such as MS-DOS or Windows 3.<i>x</I>.</P><p><br></P>
<center>
<table border>
<tr>
<td><a href="617-620.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="623-624.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>


</font></BODY></HTML>