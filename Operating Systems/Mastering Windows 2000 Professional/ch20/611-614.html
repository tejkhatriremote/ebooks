<html>
<head>
<meta name=vsisbn content="0782124488">
<meta name=vstitle content="Mastering Windows 2000 Professional">
<meta name=vsauthor content="Mark Minasi, Todd Phillips">
<meta name=vspublisher content="Sybex, Inc.">
<meta name=vspubdate content="01/01/00">
<meta name=vscategory content="Operations Systems: Windows 2000">



<title>Mastering Windows 2000 Professional:Installing Windows 2000 (and Automating Installation)</TITLE>
<!-- BEGIN HEADER -->
<meta name="ROBOTS" content="NOINDEX, NOFOLLOW">
<script>
<!--
function displayWindow(url, width, height) {
        var Win = window.open(url,"displayWindow",'width=' + width +
',height=' + height + ',resizable=1,scrollbars=yes');
}
//--></SCRIPT>

<!-- HEADER -->
<style type="text/css">
<!--
A:hover { color:red }
-->
</STYLE>

<!-- HEADER -->
<style type="text/css"> 
 <!--
 A:hover  {
 	color : Red;
 }
 -->
 </STYLE>

<script language="JavaScript1.2">
<!--
function checkForQuery(fm) {
  /* get the query value */
  var i = escape(fm.query.value);
  if (i == "") {
      alert('Please enter a search word or phrase');
      return false;
  }                  /* query is blank, dont run the .jsp file */
  else return true;  /* execute the .jsp file */
}
//--></script>

</HEAD>
<BODY bgcolor=#FFFFFF><FONT size=2 face="Arial, verdana, helvetica"><table width=100% border=0 cellspacing=0 cellpadding=2><tr bgcolor=#000000><td width=100% align=right><b><font color=#FFFFFF>Gotcha</font></b></td></tr></table><br><!--Begin Content Column -->

<table border=0 cellspacing=0 cellpadding=0>
<tr>
<td width=75 valign=top>
<img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/images/sm_covers/0782124488.gif" width=60 height=73 alt="Mastering Windows 2000 Professional" border="1">
</td>
<td align="left">
    <font face="arial, helvetica" size="-1" color="#336633"><b>Mastering Windows 2000 Professional</b></font>
    <br>
    <font face="arial, helvetica" size="-1"><i>by Mark Minasi, Todd Phillips</i>
    <br>
    Sybex, Inc.
    <br>
    <b>ISBN:</b>&nbsp;0782124488<b>&nbsp;&nbsp;&nbsp;Pub Date:</b>&nbsp;01/01/00</font>
</td>
</tr>
</table>
<p>
<!-- Empty Reference Subhead-->

<!--ISBN=0782124488//-->
<!--TITLE=Mastering Windows 2000 Professional//-->
<!--AUTHOR=Mark Minasi//-->
<!--AUTHOR=Todd Phillips//-->
<!--PUBLISHER=SYBEX//-->
<!--CHAPTER=20//-->
<!--PAGES=611-614//-->
<!--UNASSIGNED1//-->
<!--UNASSIGNED2//-->

<center>
<table border>
<tr>
<td><a href="608-611.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="614-617.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<p><br></P>
<h4 align="LEFT"><a name="Heading9"></A><font color="#000077">Using the Installation Command</FONT></H4>
<p>The initial command used to start the installation process depends on what kind of operating system you are using. If you are using a 32-bit operating system such as Windows 9<i>x</I> or Windows NT, you need to use WINNT32. Otherwise, on systems such as Windows 3.<i>x</I> or DOS, you&#146;ll have to use the WINNT command. Table 20.1 lists the parameters for these commands.</P>
<blockquote>
<p><font size="-1"><hr><b>NOTE:&nbsp;&nbsp;</B>The WINNT and WINNT32 commands both use the same switches displayed in the table below.<hr></FONT>
</BLOCKQUOTE>
<table width="100%">
<caption align=LEFT><b>Table 20.1</B> Parameters for WINNT32 Commands
<tr>
<th colspan="2"><hr>
<tr>
<th width="30%" align="LEFT">Parameter
<th width="70%" align=LEFT>Description
<tr>
<th colspan="2"><hr>
<tr>
<td valign="TOP"><tt>/s:sourcepath</TT>
<td>Specifies the source location of Windows NT files. <i>Sourcepath</I> must be a full path in the form of <tt>x:\[path]</TT> or <tt>\\server\share[\path]</TT>.
<tr>
<td valign="TOP"><tt>/tempdrive:<i>drive_letter</I></TT>
<td>Specifies a drive to contain temporary setup files. If not specified, Setup attempts to locate a drive for you. This is usually the C drive. If your C drive doesn&#146;t have enough space (about 300MB), you&#146;ll have to choose another drive or start the install with boot floppies.
<tr>
<td valign="TOP"><tt>/checkupgradeonly</TT>
<td>Checks your computer to see if it complies with the minimum setup requirements for Windows 2000 Professional.
<tr>
<td valign="TOP"><tt>/cmd:<i>command_line</I></TT>
<td>Tells Setup to open a command prompt and execute the command listed before Setup completes the final phase.
<tr>
<td valign="TOP"><tt>/cmdcons</TT>
<td>Adds the Recovery Console option to the Setup options screen to help recover a failed installation.
<tr>
<td valign="TOP"><tt>/copydir:<i>folder_name</I></TT> or <tt>copysource:<i>folder_name</I></TT>
<td>Both of these switches allow you to copy an additional folder to the Winnt folder during Setup, and use the drivers contained in that folder during Setup. The difference is that <tt>/copydir</TT> keeps the subfolder permanently, while <tt>/copysource</TT> deletes the subfolder after Setup completes.
<tr>
<td valign="TOP"><tt>/m</TT>
<td>Tells Setup to copy files from an alternative location. This is useful if you need to provide newer drivers for a specific device. Setup will look for files first in the folder you specify with the <tt>/m</TT> switch, then in the distribution folder.
<tr>
<td valign="TOP"><tt>/makelocalsource</TT>
<td>Instructs Setup to make a local source folder for all of the installation files. This switch replaces the old <tt>/b</TT> switch to perform a floppyless install.
<tr>
<td valign="TOP"><tt>noreboot</TT>
<td>Tells Setup not to reboot after the file copy phase is complete so that you can execute another command first.
<tr>
<td valign="TOP"><tt>/syspart:<i>drive_letter</I></TT>
<td>Tells Setup that you want to copy the startup files for installation to a specific hard drive, mark the partition as active, and then move the drive to a different computer. This enables you to create disks for new computers, which will then complete Setup once they are booted in the new machine.
<tr>
<td valign="TOP"><tt>/unattend</TT>
<td>Tells Setup that you wish to upgrade your previous installation of Windows 2000 in unattended mode. In this case, Setup will take all of its settings from the existing version and won&#146;t prompt the user for any settings.
<tr>
<td valign="TOP"><tt>/unattend<i>[num]:[answer file name]</I></TT>
<td>This switch has replaced the old <tt>/u</TT> unattended setup switch. This unattended mode setup requires an answer file to provide all of the necessary parameters to successfully complete Windows 2000 setup. The <i>Num</I> parameter specifies the number of seconds to wait after copying files and before rebooting. This is only available on Windows 2000 computers.
<tr>
<td valign="TOP"><tt>/udf<i>:id,UDF_file</I></TT>
<td>Specifies the station <i>id</I> for an unattended setup, and the name of the Uniqueness Database File (UDF) that will provide the variables for this particular computer.
<tr>
<td colspan="2"><hr>
</TABLE>
<blockquote>
<p><font size="-1"><hr><b>WARNING:&nbsp;&nbsp;</B>If you are starting Windows 2000 Setup from Windows 9<i>x</I>, you may need to issue the Lock command for the hard drive. This enables the Windows 2000 Setup program to write directly to the hard disk without Windows 9<i>x</I>&#146;s intervention. Failure to do so may hang your computer.<hr></FONT>
</BLOCKQUOTE>
<p>For example, if you are running Windows 95 and want to install Windows 2000 Professional using a floppyless installation with the installation files residing on your hard disk, then you would type the following command from the command prompt:
</P>
<!-- CODE SNIP //-->
<pre>
   <b>Winnt32 /makelocalsource /s:c:\i386</B>
</PRE>
<!-- END CODE SNIP //-->
<p>If you wanted to accomplish the same thing from a DOS workstation, simply replace the Winnt32 with Winnt.
</P>
<p>The first thing that Setup will prompt you to do is to decide whether you are upgrading or installing a fresh copy to a new folder. Though upgrading works fine, you really do get the very best install when you use a new directory. The Setup will prompt you with the License Agreement. You must accept this agreement in order to continue with Setup. Figure 20.1 shows the next dialog box, where you can select any special option you need for the installation.</P>
<p><a name="Fig1"></A><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/0782124488/ch20/images/20-01.jpg',504,387)"><img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/reference/pro/0782124488/ch20/images/20-01t.jpg"></A>
<br><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/0782124488/ch20/images/20-01.jpg',504,387)"><font color="#000077"><b>Figure 20.1</B></FONT></A>&nbsp;&nbsp;The Select Special Options dialog box lets you set Language or Accessibility options.</P>
<p>Setup will want to know if you want to upgrade your drive to use NTFS. This is actually a good way to describe it since this is a newer version of the NT File System than you may be currently using if you are running NT 4. Definitely do not upgrade, though, if you are planning to multiboot with Windows 9<i>x</I> on FAT or FAT32.</P>
<p>Setup copies the Windows 2000 Professional files to a temporary directory on your hard drive and then asks you to restart your computer to continue Windows 2000 Setup. If you are in DOS mode, just press Enter and Setup automatically restarts. If you are in Windows 95 or NT, close the command prompt window and restart the computer.</P>
<p>When the computer restarts, the screen displays the current NT Workstation version (if any) and the available memory, and welcomes you to Setup. You have several options at this point. You can:</P>
<dl>
<dd><b>&#149;</B>&nbsp;&nbsp;Set up Windows 2000.
<dd><b>&#149;</B>&nbsp;&nbsp;Repair a damaged Windows 2000 Professional installation.
<dd><b>&#149;</B>&nbsp;&nbsp;Quit Setup without installing Windows 2000.
</DL>
<p>For now, you&#146;ll want to set up Windows 2000. (For more information about the option of repairing a damaged Windows 2000 Professional installation, see &#147;Repairing Windows 2000&#148; later in this chapter.) Setup continues with the installation and asks you a variety of questions.
</P><p><br></P>
<center>
<table border>
<tr>
<td><a href="608-611.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="614-617.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>


</font></BODY></HTML>