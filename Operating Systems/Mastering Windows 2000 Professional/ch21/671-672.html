<html>
<head>
<meta name=vsisbn content="0782124488">
<meta name=vstitle content="Mastering Windows 2000 Professional">
<meta name=vsauthor content="Mark Minasi, Todd Phillips">
<meta name=vspublisher content="Sybex, Inc.">
<meta name=vspubdate content="01/01/00">
<meta name=vscategory content="Operations Systems: Windows 2000">



<title>Mastering Windows 2000 Professional:The Registry</TITLE>
<!-- BEGIN HEADER -->
<meta name="ROBOTS" content="NOINDEX, NOFOLLOW">
<script>
<!--
function displayWindow(url, width, height) {
        var Win = window.open(url,"displayWindow",'width=' + width +
',height=' + height + ',resizable=1,scrollbars=yes');
}
//--></SCRIPT>

<!-- HEADER -->
<style type="text/css">
<!--
A:hover { color:red }
-->
</STYLE>

<!-- HEADER -->
<style type="text/css"> 
 <!--
 A:hover  {
 	color : Red;
 }
 -->
 </STYLE>

<script language="JavaScript1.2">
<!--
function checkForQuery(fm) {
  /* get the query value */
  var i = escape(fm.query.value);
  if (i == "") {
      alert('Please enter a search word or phrase');
      return false;
  }                  /* query is blank, dont run the .jsp file */
  else return true;  /* execute the .jsp file */
}
//--></script>

</HEAD>
<BODY bgcolor=#FFFFFF><FONT size=2 face="Arial, verdana, helvetica"><table width=100% border=0 cellspacing=0 cellpadding=2><tr bgcolor=#000000><td width=100% align=right><b><font color=#FFFFFF>Gotcha</font></b></td></tr></table><br><!--Begin Content Column -->

<table border=0 cellspacing=0 cellpadding=0>
<tr>
<td width=75 valign=top>
<img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/images/sm_covers/0782124488.gif" width=60 height=73 alt="Mastering Windows 2000 Professional" border="1">
</td>
<td align="left">
    <font face="arial, helvetica" size="-1" color="#336633"><b>Mastering Windows 2000 Professional</b></font>
    <br>
    <font face="arial, helvetica" size="-1"><i>by Mark Minasi, Todd Phillips</i>
    <br>
    Sybex, Inc.
    <br>
    <b>ISBN:</b>&nbsp;0782124488<b>&nbsp;&nbsp;&nbsp;Pub Date:</b>&nbsp;01/01/00</font>
</td>
</tr>
</table>
<p>
<!-- Empty Reference Subhead-->

<!--ISBN=0782124488//-->
<!--TITLE=Mastering Windows 2000 Professional//-->
<!--AUTHOR=Mark Minasi//-->
<!--AUTHOR=Todd Phillips//-->
<!--PUBLISHER=SYBEX//-->
<!--CHAPTER=21//-->
<!--PAGES=671-672//-->
<!--UNASSIGNED1//-->
<!--UNASSIGNED2//-->

<center>
<table border>
<tr>
<td><a href="668-670.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="../ch22/673-678.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<p><br></P>
<h3><a name="Heading12"></A><font color="#000077">Modifying a Remote Registry</FONT></H3>
<p>You can modify another computer&#146;s Registry&#151;perhaps to repair it or to do some simple kind of remote maintenance&#151;by loading that computer&#146;s hive. You do that with the Registry Editor by using the Load Hive or Unload Hive commands.
</P>
<p>You can only load or unload the hives for HKEY_USERS and HKEY_LOCAL_MACHINE. The Load Hive option appears only if you&#146;ve selected one of those two subtrees; Unload Hive is available only if you&#146;ve selected a subkey of one of those two subtrees.</P>
<p>Why specifically would you load a hive or a remote Registry?</P>
<p>First, you might load a hive to get to a user&#146;s profile. Suppose a user has set up all the screen colors as black on black, rendering the screen impossible to read. You can load the hive that corresponds to that user, modify it, and then unload it.</P>
<p>Second, you can use the remote feature to view basically <i>anything</I> on a remote system. Suppose you want to do something as simple as change screen colors. You&#146;d do that on a local system by running the Control Panel, but the Control Panel won&#146;t work for remote systems. Answer: Load the Registry remotely.</P>
<p>You could load and save hive files to floppy disk, walk the floppy over to a malfunctioning machine, and load the hive onto the machine&#146;s hard disk, potentially repairing a system problem. Unfortunately, this technique isn&#146;t possible if you&#146;re using NTFS unless you have multiple copies of Windows 2000 on your system, something most of us don&#146;t have. But if you have a Windows 2000 workstation running a FAT file system, then you can always boot from DOS, replace the hive files under DOS, and then reboot under Windows 2000.</P>
<p>When you boot under Windows 2000, you see the reference to a <i>Last Known Good</I> menu because Windows 2000 keeps track not only of the current control set but also of the <i>previous</I> control set. Therefore, if you messed up your system, you can always roll back to the previous configuration. Those control sets reside in the same key as the CurrentControlSet. Within <tt>HKEY_LOCAL_MACHINE\SYSTEM\Select\Current,</TT> the values <tt>\Default</TT>, <tt>\Failed</TT>, and <tt>\LastKnownGood</TT> are numbers indicating which of the two kept control sets are failed, current, good, and the like.</P>
<h3><a name="Heading13"></A><font color="#000077">Backing Up and Restoring the Registry</FONT></H3>
<p>By now, you should agree that the Registry contains important information and should be protected. It protects itself pretty well with its <tt>.log</TT> files, but how can you back it up?</P>
<p>Unfortunately, because Registry hive files are always open, backing up the Registry is tough; most backup utilities are stymied by open files. The Windows Backup program that comes with Windows 2000 works well. If you use Windows Backup&#151;and it&#146;s pretty good, particularly for its price&#151;then you should tell it to back up your Registry.</P>
<p>In addition to Windows Backup, you have several other protection possibilities, including a program named <tt>rdisk.exe</TT> that creates emergency repair disks and will back up your Registry to the directory <tt>\Winnt\Repair</TT>; you can learn about it in Chapter 29, &#147;Fixing Windows 2000 Professional When It Breaks.&#148; The Resource Kit also includes two useful utilities. The <tt>regback.exe</TT> program enables you to back up a Registry file; <tt>regrest.exe</TT> restores it.</P>
<h3><a name="Heading14"></A><font color="#000077">Summary</FONT></H3>
<p>Windows 2000&#146;s Registry centralizes configuration information into just a few hive files. That structure simplifies backup, but the Registry&#146;s extremely hierarchical structure means that you shouldn&#146;t mess with it at random&#151;be sure you know what you&#146;re changing before you try to change it!
</P><p><br></P>
<center>
<table border>
<tr>
<td><a href="668-670.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="../ch22/673-678.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>


</font></BODY></HTML>