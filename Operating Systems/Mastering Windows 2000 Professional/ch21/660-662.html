<html>
<head>
<meta name=vsisbn content="0782124488">
<meta name=vstitle content="Mastering Windows 2000 Professional">
<meta name=vsauthor content="Mark Minasi, Todd Phillips">
<meta name=vspublisher content="Sybex, Inc.">
<meta name=vspubdate content="01/01/00">
<meta name=vscategory content="Operations Systems: Windows 2000">



<title>Mastering Windows 2000 Professional:The Registry</TITLE>
<!-- BEGIN HEADER -->
<meta name="ROBOTS" content="NOINDEX, NOFOLLOW">
<script>
<!--
function displayWindow(url, width, height) {
        var Win = window.open(url,"displayWindow",'width=' + width +
',height=' + height + ',resizable=1,scrollbars=yes');
}
//--></SCRIPT>

<!-- HEADER -->
<style type="text/css">
<!--
A:hover { color:red }
-->
</STYLE>

<!-- HEADER -->
<style type="text/css"> 
 <!--
 A:hover  {
 	color : Red;
 }
 -->
 </STYLE>

<script language="JavaScript1.2">
<!--
function checkForQuery(fm) {
  /* get the query value */
  var i = escape(fm.query.value);
  if (i == "") {
      alert('Please enter a search word or phrase');
      return false;
  }                  /* query is blank, dont run the .jsp file */
  else return true;  /* execute the .jsp file */
}
//--></script>

</HEAD>
<BODY bgcolor=#FFFFFF><FONT size=2 face="Arial, verdana, helvetica"><table width=100% border=0 cellspacing=0 cellpadding=2><tr bgcolor=#000000><td width=100% align=right><b><font color=#FFFFFF>Gotcha</font></b></td></tr></table><br><!--Begin Content Column -->

<table border=0 cellspacing=0 cellpadding=0>
<tr>
<td width=75 valign=top>
<img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/images/sm_covers/0782124488.gif" width=60 height=73 alt="Mastering Windows 2000 Professional" border="1">
</td>
<td align="left">
    <font face="arial, helvetica" size="-1" color="#336633"><b>Mastering Windows 2000 Professional</b></font>
    <br>
    <font face="arial, helvetica" size="-1"><i>by Mark Minasi, Todd Phillips</i>
    <br>
    Sybex, Inc.
    <br>
    <b>ISBN:</b>&nbsp;0782124488<b>&nbsp;&nbsp;&nbsp;Pub Date:</b>&nbsp;01/01/00</font>
</td>
</tr>
</table>
<p>
<!-- Empty Reference Subhead-->

<!--ISBN=0782124488//-->
<!--TITLE=Mastering Windows 2000 Professional//-->
<!--AUTHOR=Mark Minasi//-->
<!--AUTHOR=Todd Phillips//-->
<!--PUBLISHER=SYBEX//-->
<!--CHAPTER=21//-->
<!--PAGES=660-662//-->
<!--UNASSIGNED1//-->
<!--UNASSIGNED2//-->

<center>
<table border>
<tr>
<td><a href="657-660.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="662-666.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<p><br></P>
<h4 align="LEFT"><a name="Heading3"></A><font color="#000077">Subtrees</FONT></H4>
<p>If you ever supported Windows 3.1, then you&#146;ll recall that it had two essential <tt>.ini</TT> files: <tt>win.ini</TT> and <tt>system.ini</TT>. It was roughly true that <tt>win.ini</TT> contained settings specific to a user, and <tt>system.ini</TT> contained settings specific to the machine. Windows 2000&#146;s Registry is divided as well.</P>
<p>The Registry stores all information about a computer and its users by dividing them into five <i>subtrees</I>. These subtrees provide a rough division of the kinds of Registry information:</P>
<dl>
<dt><b>HKEY_LOCAL_MACHINE</B>
<dd>Contains information about the hardware installed in the machine and the programs and systems running on the machine. You&#146;ll do most of your work in this subtree.
<dt><b>HKEY_CLASSES_ROOT</B>
<dd>Holds the file associations, information that tells the system, &#147;Whenever the user double-clicks a file with the extension <tt>.bmp</TT> in Explorer, start up <tt>pbrush.exe</TT> to view this file.&#148; It also contains the OLE registration database, the old <tt>reg.dat</TT> from Windows 3.<i>x</I>. Most of the information in this subtree is concerned with registering Dynamic Link Libraries (<tt>.dll</TT>) files so that multiple programs can call them. This subtree is actually redundant because the HKEY_LOCAL_MACHINE subtree contains all the information in this subtree.
<dt><b>HKEY_USERS</B>
<dd>Contains two user profiles: a default profile used for someone logging on who hasn&#146;t logged on before, and a profile with a name like S-228372162..., which is the profile of a user already known to the system. The long number starting with the <i>S</I> is the Security ID of the user.
<dt><b>HKEY_CURRENT_USER</B>
<dd>Contains the user profile for the person currently logged on to the Windows 2000 Professional machine.
<dt><b>HKEY_CURRENT_CONFIG</B>
<dd>Contains configuration information for the particular hardware configuration that you booted up with.
</DL>

<p>Sometimes these subtrees contain conflicting information. For example, data in HKEY_CURRENT_USER may include some of the same parameters as HKEY_LOCAL_MACHINE; in that case, HKEY_CURRENT_USER takes precedence.
</P>
<h4 align="LEFT"><a name="Heading4"></A><font color="#000077">Registry Keys</FONT></H4>
<p>The Registry Editor in Figure 21.1 displays five cascaded windows, one for each subtree. HKEY_LOCAL_MACHINE is in the back, but if you click it to bring it to the front, you will see the other four subtree windows behind it. The HKEY_LOCAL_ MACHINE window has a right and left pane. The left pane looks a little like a screen from Explorer or the old Windows 3.1 File Manager.
</P>
<p>In the File Manager, those folders represented <i>subdirectories</I>. Here, however, they separate information into <i>sections</I>, somewhat reminiscent of the way in which old Windows <tt>.ini</TT> files have sections whose names are surrounded by square brackets, names such as [386enh], [network], and [boot]. Let&#146;s compare the HKEY_LOCAL_MACHINE in Figure 21.2 to an <tt>.ini</TT> file. If this were an <tt>.ini</TT> file, then the name of its sections would be [hardware], [sam], [security], [software], and [system]. Each of those folders or sections are called <i>keys</I> in the Registry.</P>
<p><a name="Fig2"></A><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/0782124488/ch21/images/21-02.jpg',712,483)"><img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/reference/pro/0782124488/ch21/images/21-02t.jpg"></A>
<br><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/0782124488/ch21/images/21-02.jpg',712,483)"><font color="#000077"><b>Figure 21.2</B></FONT></A>&nbsp;&nbsp;The SYSTEM key contains numerous subkeys.</P>
<p>But here&#146;s where the analogy to <tt>.ini</TT> files fails: You can have keys within keys, called <i>subkeys</I> (and sub-subkeys and sub-sub-subkeys and so on). In Figure 21.2, the SYSTEM key has been opened, and you can see that it contains subkeys named ControlSet001, ControlSet002, CurrentControlSet, Disk, Mounted Devices, Select, and Setup, and that CurrentControlSet is further subkeyed into Control, Enum, Hardware Profiles, and Services.</P>
<blockquote>
<p><font size="-1"><hr><b>NOTE:&nbsp;&nbsp;</B>Notice again the key called CurrentControlSet in Figure 21.2. It&#146;s very important. Almost any time that you modify your system&#146;s configuration, you&#146;ll be doing it with a subkey within the CurrentControlSet subkey.<hr></FONT>
</BLOCKQUOTE>
<h4 align="LEFT"><a name="Heading5"></A><font color="#000077">Key Naming Conventions</FONT></H4>
<p>The tree of keys gets pretty big as you drill down through the many layers. CurrentControlSet, for example, has dozens of subkeys, and each of <i>those</I> subkeys can have subkeys. Identifying a given subkey is important, so Microsoft has adopted a naming convention that looks just like directory trees. CurrentControlSet&#146;s fully specified name is <tt>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet</TT>.</P><p><br></P>
<center>
<table border>
<tr>
<td><a href="657-660.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="662-666.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>


</font></BODY></HTML>