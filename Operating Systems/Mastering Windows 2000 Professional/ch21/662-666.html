<html>
<head>
<meta name=vsisbn content="0782124488">
<meta name=vstitle content="Mastering Windows 2000 Professional">
<meta name=vsauthor content="Mark Minasi, Todd Phillips">
<meta name=vspublisher content="Sybex, Inc.">
<meta name=vspubdate content="01/01/00">
<meta name=vscategory content="Operations Systems: Windows 2000">



<title>Mastering Windows 2000 Professional:The Registry</TITLE>
<!-- BEGIN HEADER -->
<meta name="ROBOTS" content="NOINDEX, NOFOLLOW">
<script>
<!--
function displayWindow(url, width, height) {
        var Win = window.open(url,"displayWindow",'width=' + width +
',height=' + height + ',resizable=1,scrollbars=yes');
}
//--></SCRIPT>

<!-- HEADER -->
<style type="text/css">
<!--
A:hover { color:red }
-->
</STYLE>

<!-- HEADER -->
<style type="text/css"> 
 <!--
 A:hover  {
 	color : Red;
 }
 -->
 </STYLE>

<script language="JavaScript1.2">
<!--
function checkForQuery(fm) {
  /* get the query value */
  var i = escape(fm.query.value);
  if (i == "") {
      alert('Please enter a search word or phrase');
      return false;
  }                  /* query is blank, dont run the .jsp file */
  else return true;  /* execute the .jsp file */
}
//--></script>

</HEAD>
<BODY bgcolor=#FFFFFF><FONT size=2 face="Arial, verdana, helvetica"><table width=100% border=0 cellspacing=0 cellpadding=2><tr bgcolor=#000000><td width=100% align=right><b><font color=#FFFFFF>Gotcha</font></b></td></tr></table><br><!--Begin Content Column -->

<table border=0 cellspacing=0 cellpadding=0>
<tr>
<td width=75 valign=top>
<img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/images/sm_covers/0782124488.gif" width=60 height=73 alt="Mastering Windows 2000 Professional" border="1">
</td>
<td align="left">
    <font face="arial, helvetica" size="-1" color="#336633"><b>Mastering Windows 2000 Professional</b></font>
    <br>
    <font face="arial, helvetica" size="-1"><i>by Mark Minasi, Todd Phillips</i>
    <br>
    Sybex, Inc.
    <br>
    <b>ISBN:</b>&nbsp;0782124488<b>&nbsp;&nbsp;&nbsp;Pub Date:</b>&nbsp;01/01/00</font>
</td>
</tr>
</table>
<p>
<!-- Empty Reference Subhead-->

<!--ISBN=0782124488//-->
<!--TITLE=Mastering Windows 2000 Professional//-->
<!--AUTHOR=Mark Minasi//-->
<!--AUTHOR=Todd Phillips//-->
<!--PUBLISHER=SYBEX//-->
<!--CHAPTER=21//-->
<!--PAGES=662-666//-->
<!--UNASSIGNED1//-->
<!--UNASSIGNED2//-->

<center>
<table border>
<tr>
<td><a href="660-662.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="666-668.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<p><br></P>
<h4 align="LEFT"><a name="Heading6"></A><font color="#000077">Value Entries, Names, Values, and Data Types</FONT></H4>
<p>If you drill down through CurrentControlSet, you will find the subkey Services, and within Services are many subkeys. In Figure 21.3, you can see some of the subkeys of <tt>CurrentControlSet\Services</TT>.</P>
<p><a name="Fig3"></A><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/0782124488/ch21/images/21-03.jpg',712,483)"><img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/reference/pro/0782124488/ch21/images/21-03t.jpg"></A>
<br><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/0782124488/ch21/images/21-03.jpg',712,483)"><font color="#000077"><b>Figure 21.3</B></FONT></A>&nbsp;&nbsp;Subkeys of <tt>CurrentControlSet\Services</TT>
</P>
<p>One of those keys, Browser, contains the subkeys Linkage, Parameters, and Security. Once we get to Parameters, however, it&#146;s the end of the line&#151;no subkeys from there. As a quick review of Registry navigation, the key that we&#146;re looking at now is in <tt>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Browser\Parameters</TT>.</P>
<p>The following two lines appear in the right pane of the Registry Editor:</P>
<!-- CODE SNIP //-->
<pre>
   IsDomainMaster : REG_SZ : FALSE
   MaintainServerList : REG_SZ : AUTO
</PRE>
<!-- END CODE SNIP //-->
<p>In the old <tt>.ini</TT>-type files, the Registry would have looked something like this:</P>
<!-- CODE SNIP //-->
<pre>
   IsDomainMasterBrowser=Yes
   MaintainServerList=Yes
</PRE>
<!-- END CODE SNIP //-->
<p>Each line is called a <i>value entry</I>. For example, <tt>IsDomainMaster:REG_SZ:FALSE</TT> is a value entry. Its three parts are called <i>name</I>, <i>data type</I>, and <i>value</I>. In this example, <tt>IsDomainMaster</TT> is the <i>name</I>, <tt>REG_SZ</TT> is the <i>data type</I>, and <tt>FALSE</TT> is the <i>value</I>.</P>
<p>Microsoft notes that each value entry cannot exceed about 1MB in size. It&#146;s hard to imagine an entry that long, but it&#146;s worth mentioning.</P>
<p>What is that REG_SZ stuff? It tells the Registry what <i>kind</I> of data to expect: numbers, messages, yes/no values, and the like. The Registry Editor has five data types (although you can define other data types later):</P>
<dl>
<dt><b>REG_BINARY</B>
<dd>Raw binary data. Data of this type usually doesn&#146;t make sense when you look at it with the Registry Editor. Binary data shows up in hardware setup information. If you can enter this data in a way other than via the Registry Editor&#151;and we discuss that in a page or two&#151;then do it. Editing binary data can get you in trouble if you don&#146;t know what you&#146;re doing. The data is usually represented in hex for simplicity&#146;s sake.
<dt><b>REG_DWORD</B>
<dd>Another binary data type, but it&#146;s 4 bytes long.
<dt><b>REG_EXPAND_SZ</B>
<dd>A character string of variable size. It&#146;s often information understandable by humans, such as path statements or messages. It is &#147;expandable,&#148; in that it may contain information that will change at runtime like %username%&#151;a system batch variable that will be of different sizes for different people&#146;s names.
<dt><b>REG_MULTI_SZ</B>
<dd>Another string type, but it enables you to enter a number of parameters on this single value entry. The parameters are separated by binary zeroes (nulls).
<dt><b>REG_SZ</B>
<dd>A simple string.
</DL>

<p>Those who first met a Registry with Windows 95 will notice a few differences here: Windows 95 has six subtrees, but only three data types&#151;<i>string,</I> which is like REG_SZ, REG_MULTI_SZ, and REG_EXPAND_SZ; <i>dword,</I> which is like REG_DWORD; and <i>binary</I>, which is like REG_BINARY.</P>
<p>And if you&#146;re wondering how you&#146;ll figure out what data type to assign to a new Registry value, don&#146;t worry about it. If you read somewhere to use a particular new value entry, you&#146;ll be told what data type to use.</P>
<h3><a name="Heading7"></A><font color="#000077">Working with the Registry: An Example</FONT></H3>
<p>Now, we know that despite the warnings, you want to get in there and try the Registry out, so here&#146;s an innocuous example. Remember, it&#146;s only innocuous if you follow the example to the letter; otherwise it&#146;ll be time to get out your installation disks.
</P>
<p>That&#146;s not just boilerplate. Don&#146;t get mad at <i>us</I> if you blow up your workstation because you didn&#146;t pay attention. Actually, you <i>may</I> be able to avoid a reinstallation if the setting that you modified was in the CurrentControlSet key. Windows 2000 knows that you&#146;ll often be messing around in there and so it keeps a spare. In that case, you can reboot the workstation and wait for the message that says &#147;Press spacebar now to restore last known good menu.&#148; That&#146;s NT-ese for &#147;Press the spacebar, and I&#146;ll restore the last control set that booted well for you.&#148; Again, however, that step won&#146;t restore the entire Registry, just the control set; fortunately, the CurrentControlSet is a <i>lot</I> of the Registry.</P>
<p>In any case, let&#146;s try something relatively harmless: changing the name of the company that you told Windows 2000 when you installed it. For example, say your firm changed its name back in 1995 from Mark Minasi and Company to TechTeach International, but all the Help/About dialog boxes still say that you work for Mark Minasi and Company; you&#146;d like to make the change without reinstalling.</P>
<dl>
<dd><b>1.</B>&nbsp;&nbsp;Open the Registry Editor. From the Start menu, choose Run.
<dd><b>2.</B>&nbsp;&nbsp;Type <b>REGEDT32</B> in the command line and press Enter.
<dd><b>3.</B>&nbsp;&nbsp;Click Window and choose HKEY_LOCAL_MACHINE. Maximize that window, and you&#146;ll see a screen somewhat like Figure 21.4.
<p><a name="Fig4"></A><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/0782124488/ch21/images/21-04.jpg',712,483)"><img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/reference/pro/0782124488/ch21/images/21-04t.jpg"></A>
<br><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/0782124488/ch21/images/21-04.jpg',712,483)"><font color="#000077"><b>Figure 21.4</B></FONT></A>&nbsp;&nbsp;The Registry Editor&#151;HKEY_LOCAL_ MACHINE on Local Machine dialog box.</P>
<dd><b>4.</B>&nbsp;&nbsp;You&#146;re going to modify the value entry in <tt>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion</TT>. Double-click the Software key, then double-click the Microsoft key, then double-click the Windows NT key, and finally double-click the CurrentVersion key. You&#146;ll see the Control Panel screen shown in Figure 21.5. On the left pane, you still see the Registry structure. On the right, you see the value entries in the RegisteredOrganization subkey.
<p><a name="Fig5"></A><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/0782124488/ch21/images/21-05.jpg',712,483)"><img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/reference/pro/0782124488/ch21/images/21-05t.jpg"></A>
<br><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/0782124488/ch21/images/21-05.jpg',712,483)"><font color="#000077"><b>Figure 21.5</B></FONT></A>&nbsp;&nbsp;Control Panel&#151;RegisteredOrganization</P>
<dd><b>5.</B>&nbsp;&nbsp;Double-click RegisteredOrganization, and you&#146;ll see the String Editor dialog box, shown below.
<p><a name="Fig6"></A><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/0782124488/ch21/images/21-06.jpg',378,116)"><img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/reference/pro/0782124488/ch21/images/21-06t.jpg"></A></P>
<dd><b>6.</B>&nbsp;&nbsp;Highlight the old value and replace it with TechTeach International. Click OK and close the Registry Editor.
</DL>
<p>Now click Help and About for any program&#151;even the Registry Editor will do&#151;and you&#146;ll see that the organization is now TechTeach International.
</P>
<p>Neat, eh?</P>
<blockquote>
<p><font size="-1"><hr><b>WARNING:&nbsp;&nbsp;</B>Click all you like, you will not find a Save button, or an Undo button. When you edit the Registry, it&#146;s immediate and it&#146;s forever (at least, until you change it again). So, once again, be <i>careful</I> when you&#146;re messing with the Registry.<hr></FONT>
</BLOCKQUOTE>
<p><br></P>
<center>
<table border>
<tr>
<td><a href="660-662.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="666-668.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>


</font></BODY></HTML>