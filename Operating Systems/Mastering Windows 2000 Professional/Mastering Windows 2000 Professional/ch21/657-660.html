<html>
<head>
<meta name=vsisbn content="0782124488">
<meta name=vstitle content="Mastering Windows 2000 Professional">
<meta name=vsauthor content="Mark Minasi, Todd Phillips">
<meta name=vspublisher content="Sybex, Inc.">
<meta name=vspubdate content="01/01/00">
<meta name=vscategory content="Operations Systems: Windows 2000">



<title>Mastering Windows 2000 Professional:The Registry</TITLE>
<!-- BEGIN HEADER -->
<meta name="ROBOTS" content="NOINDEX, NOFOLLOW">
<script>
<!--
function displayWindow(url, width, height) {
        var Win = window.open(url,"displayWindow",'width=' + width +
',height=' + height + ',resizable=1,scrollbars=yes');
}
//--></SCRIPT>

<!-- HEADER -->
<style type="text/css">
<!--
A:hover { color:red }
-->
</STYLE>

<!-- HEADER -->
<style type="text/css"> 
 <!--
 A:hover  {
 	color : Red;
 }
 -->
 </STYLE>

<script language="JavaScript1.2">
<!--
function checkForQuery(fm) {
  /* get the query value */
  var i = escape(fm.query.value);
  if (i == "") {
      alert('Please enter a search word or phrase');
      return false;
  }                  /* query is blank, dont run the .jsp file */
  else return true;  /* execute the .jsp file */
}
//--></script>

</HEAD>
<BODY bgcolor=#FFFFFF><FONT size=2 face="Arial, verdana, helvetica"><table width=100% border=0 cellspacing=0 cellpadding=2><tr bgcolor=#000000><td width=100% align=right><b><font color=#FFFFFF>Gotcha</font></b></td></tr></table><br><!--Begin Content Column -->

<table border=0 cellspacing=0 cellpadding=0>
<tr>
<td width=75 valign=top>
<img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/images/sm_covers/0782124488.gif" width=60 height=73 alt="Mastering Windows 2000 Professional" border="1">
</td>
<td align="left">
    <font face="arial, helvetica" size="-1" color="#336633"><b>Mastering Windows 2000 Professional</b></font>
    <br>
    <font face="arial, helvetica" size="-1"><i>by Mark Minasi, Todd Phillips</i>
    <br>
    Sybex, Inc.
    <br>
    <b>ISBN:</b>&nbsp;0782124488<b>&nbsp;&nbsp;&nbsp;Pub Date:</b>&nbsp;01/01/00</font>
</td>
</tr>
</table>
<p>
<!-- Empty Reference Subhead-->

<!--ISBN=0782124488//-->
<!--TITLE=Mastering Windows 2000 Professional//-->
<!--AUTHOR=Mark Minasi//-->
<!--AUTHOR=Todd Phillips//-->
<!--PUBLISHER=SYBEX//-->
<!--CHAPTER=21//-->
<!--PAGES=657-660//-->
<!--UNASSIGNED1//-->
<!--UNASSIGNED2//-->

<center>
<table border>
<tr>
<td><a href="../ch20/651-656.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="660-662.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<p><br></P>
<h2><a name="Heading1"></A><font color="#000077">Chapter 21<br>The Registry
</FONT></H2>
<dl>
<dt><b>Featuring:</B>
<dt>Understanding Registry Terminology
<dt>Working with the Registry: An Example
<dt>Finding the Registry in Hives
<dt>Modifying a Remote Registry
<dt>Backing Up and Restoring the Registry
</DL>
<p><big><big>N</BIG></BIG>o two Windows 2000 Professional installations are the same. Machine names vary from machine to machine, as do wallpaper, background colors, network adapter card types ...; we could spend hours listing the ways in which workstations can vary.</P>
<p>All that machine-specific stuff must live <i>somewhere</I>. You probably know that, back in Windows 3.<i>x</I> days, configuration information was all housed in a set of ASCII files with the extension <tt>.ini</TT>. In contrast, Windows 2000 stores configuration data in a structure called the <i>Registry</I> (Microsoft always uses a capital <i>R,</I> so we will also), which is housed in several files on the disk. Those files are called <i>hives</I> and they&#146;re in a binary format rather than in ASCII format.</P>
<p>The Registry is terrific in that it&#146;s one big database that contains all the Windows 2000 configuration information. Everything&#146;s there, from color settings to your users&#146; passwords. (In case you&#146;re wondering, you can&#146;t directly access the part with the passwords.) Even better, the Registry uses a fault-tolerant approach to writing data that ensures that the Registry remains intact even if a power failure occurs in the middle of an update.</P>
<p>Those features sound like good things, and they are. But the Registry has a dark side, as well; it&#146;s cryptically organized and has a structure that seems excessively complex. In addition, the Registry is not well documented in the pile of manuals that are available for Windows 2000 Professional, even though many Microsoft Help files and bug-fix reports refer to it. You&#146;re just supposed to <i>understand</I> cryptic phrases such as &#147;You can...force a computer to be a Browse Master by opening <tt>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Browser\Parameters</TT>, and creating an IsDomainMasterBrowser value, defining it as type REG_SZ, and specifying the text TRUE for the value of the string.&#148;</P>
<p>We wrote this chapter to help you interpret these jargon-laden passages. They contain much useful advice, and understanding how to carry out that advice will make you a better network administrator. Our goal for this chapter, then, is to give you a feel for the Registry&#151;how to edit it and when to leave it alone.</P>
<blockquote>
<p><font size="-1"><hr><b>WARNING:&nbsp;&nbsp;</B>Always use extreme caution when editing the Registry. There is no &#147;Undo&#148; command for changes you make, and one mistake can prevent your computer from booting. It will be helpful to always double-check your work <i>before</I> you click the OK button to enter the data into the Registry. It is also prudent to create a current Emergency Repair Disk prior to changing the Registry.<hr></FONT>
</BLOCKQUOTE>
<h3><a name="Heading2"></A><font color="#000077">Understanding Registry Terminology</FONT></H3>
<p>The Registry is a hierarchical database of settings, much like <tt>.ini</TT> files, describing your user account, your applications, and the hardware of the server machine. Knowing how to work with the Registry is an important key to being able to fine-tune and control your Windows 2000 Servers and Windows 2000 Professional computers. The Registry in Windows 2000 is <i>not</I>, by the way, the same as the Registry that is part of Windows 9<i>x</I>, although it has some similarities. For example, Windows 9<i>x</I> experts know that you can perform a multitude of powerful tasks under Windows 9<i>x</I> by exporting the Registry to an external file, modifying that file, and then importing it back to the Windows 9<i>x</I> Registry. You can&#146;t do anything like that with the Windows 2000 Registry.</P>
<p>What did that stuff with all the backslashes a couple of paragraphs back mean? To get a first insight, let&#146;s look at the Registry. You can see it by running the program <tt>regedt32.exe</TT> (it&#146;s in the <tt>C:\Winnt35\System32</TT> directory) or by accessing it through <tt>winmsd.exe</TT>&#151;just click File <img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/reference/pro/0782124488/ch21/images/21-01i.jpg"> Run, and a list of programs to run appears. One of those is <i>Registry Editor (Please use caution)</I>. Watch for the Registry Editor dialog box, shown in Figure 21.1.</P>
<p><a name="Fig1"></A><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/0782124488/ch21/images/21-01.jpg',712,483)"><img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/reference/pro/0782124488/ch21/images/21-01t.jpg"></A>
<br><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/0782124488/ch21/images/21-01.jpg',712,483)"><font color="#000077"><b>Figure 21.1</B></FONT></A>&nbsp;&nbsp;Registry Editor window</P>
<p>To pick that window apart, you&#146;ll need to learn some new terms: <i>subtree, key, value, data type,</I> and <i>hive</I>. But before you go any further, we suggest that you put the Editor in Read-Only mode by clicking Options <img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/reference/pro/0782124488/ch21/images/21-02i.jpg"> Read Only Mode.</P>
<blockquote>
<p><font size="-1"><hr><b>WARNING:&nbsp;&nbsp;</B>Making a potentially fatal error is easy in the Registry Editor. Read-Only mode prevents you from accidentally blasting some important data. You can always reverse the read-only state by clicking Options <img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/reference/pro/0782124488/ch21/images/21-03i.jpg"> Read Only Mode again.<hr></FONT>
</BLOCKQUOTE>
<p>While you&#146;ll always see a note like that one around anything that talks about the Registry, <i>don&#146;t</I> ignore it! It is truly simple to render your computer completely unusable with some unthinking Registry edits; so be careful, please.</P><p><br></P>
<center>
<table border>
<tr>
<td><a href="../ch20/651-656.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="660-662.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>


</font></BODY></HTML>