<html>
<head>
<meta name=vsisbn content="0782124488">
<meta name=vstitle content="Mastering Windows 2000 Professional">
<meta name=vsauthor content="Mark Minasi, Todd Phillips">
<meta name=vspublisher content="Sybex, Inc.">
<meta name=vspubdate content="01/01/00">
<meta name=vscategory content="Operations Systems: Windows 2000">



<title>Mastering Windows 2000 Professional:Administrative and Diagnostic Tools</TITLE>
<!-- BEGIN HEADER -->
<meta name="ROBOTS" content="NOINDEX, NOFOLLOW">
<script>
<!--
function displayWindow(url, width, height) {
        var Win = window.open(url,"displayWindow",'width=' + width +
',height=' + height + ',resizable=1,scrollbars=yes');
}
//--></SCRIPT>

<!-- HEADER -->
<style type="text/css">
<!--
A:hover { color:red }
-->
</STYLE>

<!-- HEADER -->
<style type="text/css"> 
 <!--
 A:hover  {
 	color : Red;
 }
 -->
 </STYLE>

<script language="JavaScript1.2">
<!--
function checkForQuery(fm) {
  /* get the query value */
  var i = escape(fm.query.value);
  if (i == "") {
      alert('Please enter a search word or phrase');
      return false;
  }                  /* query is blank, dont run the .jsp file */
  else return true;  /* execute the .jsp file */
}
//--></script>

</HEAD>
<BODY bgcolor=#FFFFFF><FONT size=2 face="Arial, verdana, helvetica"><table width=100% border=0 cellspacing=0 cellpadding=2><tr bgcolor=#000000><td width=100% align=right><b><font color=#FFFFFF>Gotcha</font></b></td></tr></table><br><!--Begin Content Column -->

<table border=0 cellspacing=0 cellpadding=0>
<tr>
<td width=75 valign=top>
<img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/images/sm_covers/0782124488.gif" width=60 height=73 alt="Mastering Windows 2000 Professional" border="1">
</td>
<td align="left">
    <font face="arial, helvetica" size="-1" color="#336633"><b>Mastering Windows 2000 Professional</b></font>
    <br>
    <font face="arial, helvetica" size="-1"><i>by Mark Minasi, Todd Phillips</i>
    <br>
    Sybex, Inc.
    <br>
    <b>ISBN:</b>&nbsp;0782124488<b>&nbsp;&nbsp;&nbsp;Pub Date:</b>&nbsp;01/01/00</font>
</td>
</tr>
</table>
<p>
<!-- Empty Reference Subhead-->

<!--ISBN=0782124488//-->
<!--TITLE=Mastering Windows 2000 Professional//-->
<!--AUTHOR=Mark Minasi//-->
<!--AUTHOR=Todd Phillips//-->
<!--PUBLISHER=SYBEX//-->
<!--CHAPTER=30//-->
<!--PAGES=963-967//-->
<!--UNASSIGNED1//-->
<!--UNASSIGNED2//-->

<center>
<table border>
<tr>
<td><a href="960-963.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="967-970.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<p><br></P>
</P>
<p>Disk Defragmenter can analyze the file structure on your disk to see if the files and folders are being stored efficiently. Fragmentation occurs when a hard-drive controller writes pieces, or fragments, of larger files to different parts of the hard drive. Though economical on disk space, fragmentation can slow overall system performance because the hard drive&#146;s read head has to jump to different places on the disk platter to read the file fragments. Even NTFS volumes will fragment over time, eroding the overall performance of your computer.
</P>
<p>You can get to Disk Defragmenter two ways. The first way is useful when you are browsing in My Computer. Simply right-click the volume you want to defragment, and select Properties from the context menu. In the drive Properties, click the Tools menu and click the Defragment button. The second method is to use the Computer Management console in Administrative Tools, as noted earlier in this section.</P>
<h3><a name="Heading6"></A><font color="#000077">Running Event Viewer</FONT></H3>
<p>One of Windows 2000&#146;s more handy tools is the Event Viewer, which can be helpful for troubleshooting a misbehaving PC or for getting a better handle on what Windows 2000 is doing behind the scenes. To open Event Viewer, choose Start <img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/reference/pro/0782124488/ch30/images/30-08i.jpg"> Programs <img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/reference/pro/0782124488/ch30/images/30-09i.jpg"> Administrative Tools <img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/reference/pro/0782124488/ch30/images/30-10i.jpg"> Computer Management, expand the System Tools console tree, and then click the Event Viewer icon. Windows 2000 displays the Event Viewer window, as shown in Figure 30.5.</P>
<p><a name="Fig5"></A><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/0782124488/ch30/images/30-05.jpg',638,452)"><img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/reference/pro/0782124488/ch30/images/30-05t.jpg"></A>
<br><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/0782124488/ch30/images/30-05.jpg',638,452)"><font color="#000077"><b>Figure 30.5</B></FONT></A>&nbsp;&nbsp;Event Viewer is often a good place to start diagnosing problems.</P>
<p>Event Viewer can display three event logs: System, Security, and Application. System events are logged by Windows 2000&#146;s system components, including hardware drivers. For instance, if a driver fails to load, it will write a system event to the System log. Or if a Windows 2000 service fails to initialize, the service reports its failure in the System log. There are three types of System log events:
</P>
<dl>
<dt><b>Information</B>
<dd>Logged when a driver or service starts successfully. For example, each time you boot up Windows 2000, a System event is logged, indicating that the Event Log service was started.
<dt><b>Warning</B>
<dd>Logged when a condition occurs that could mean future trouble, for example, a nearly full hard drive.
<dt><b>Error</B>
<dd>Logged when a service or a driver fails to start or load. For example, if your network card driver fails, that error is logged, as is an error indicating that any network protocols communicating with that network card have failed.
</DL>

<p>Security events occur if you&#146;ve enabled auditing on a shared disk, subfolder, or file. Auditing events are written to the Security log when someone accesses your shared area and logs in. There are two types of Security log events:
</P>
<dl>
<dt><b>Audit Success</B>
<dd>Logged when a user successfully logs on to one of your shared areas: a disk, a subfolder, or a file.
<dt><b>Audit Failure</B>
<dd>Logged when a user fails to log on to one of your shared areas.
</DL>

<p>Windows 2000 applications write status and error messages in the Application log. If an application is crashing or behaving oddly, it&#146;s usually a good idea to check the Application log for error messages. The Application log uses the same three event types as the System log: Information, Warning, and Error.
</P>
<p>Each time you boot Windows 2000, it runs CHKDSK (Check Disk) on the volume containing the system files and logs the report to the Application Log. The event is called Autochk.</P>
<p>With Event Viewer, you can look at only one event log at a time. To change views, click the Log menu, and select the log you want to see.</P>
<blockquote>
<p><font size="-1"><hr><b>TIP:&nbsp;&nbsp;</B>When opening old log files, be careful not to confuse them with your system&#146;s actual logs. The system log files live in the <tt>C:\Winnt\System32\Config</TT> subfolder. If you&#146;ve opened a log other than one of your system&#146;s three primary ones, its name will be displayed in the title bar of the Event Viewer window. Each time you open Event Viewer, it loads the system&#146;s three event logs.<hr></FONT>
</BLOCKQUOTE>
<p>For any of your three logs, Event Viewer supports two viewing modes: All Events and Filter Events. Figure 30.6 shows the Filter view. The default view for the Event Viewer logs is the All Events view. This means that you would be seeing all of the events currently stored in the log. If you wanted to find specific events, you would use the Filter View and set your criteria for the filter. To change the view type, right-click in the right pane of the Event Viewer and select either All Events or Filter Events from the context menu.
</P>
<p><a name="Fig6"></A><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/0782124488/ch30/images/30-06.jpg',404,448)"><img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/reference/pro/0782124488/ch30/images/30-06t.jpg"></A>
<br><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/0782124488/ch30/images/30-06.jpg',404,448)"><font color="#000077"><b>Figure 30.6</B></FONT></A>&nbsp;&nbsp;Using the Event Filter, you can see if specific types of system events are occurring.</P>
<p>Event Viewer&#146;s filter enables you to find events using these search criteria:
</P>
<dl>
<dd><b>&#149;</B>&nbsp;&nbsp;A specified period of time
<dd><b>&#149;</B>&nbsp;&nbsp;Types of events, such as warnings
<dd><b>&#149;</B>&nbsp;&nbsp;Devices
<dd><b>&#149;</B>&nbsp;&nbsp;A specific type of event on a given device
<dd><b>&#149;</B>&nbsp;&nbsp;An event generated by a specific user logged on to your machine
<dd><b>&#149;</B>&nbsp;&nbsp;Events generated by a specific machine (if you have administrative access to other computers on your network)
<dd><b>&#149;</B>&nbsp;&nbsp;Event IDs
</DL>
<p>For instance, if your Network Interface Card (NIC) isn&#146;t initializing correctly, an error event is logged in the System log indicating that the NIC driver isn&#146;t loaded, and any protocols that communicated with that NIC would also fail to load. All these events are entered in the System log.
</P>
<p>If you know a hardware device isn&#146;t loading or is behaving oddly, one of the first places to look for the cause is the Event Viewer because a misbehaving device will likely document its problems in the System log. And even though Warning and Error events are sometimes short on specifics, they can often be good indicators of where to begin looking. Here&#146;s what a troubleshooting session might look like.</P>
<p>On start-up, the driver for a Sound Blaster card fails to initialize; the result is a lack of wave audio in Windows 2000. The first indicator you get is a message like the one below informing you that at least one Windows 2000 service failed to start.</P>
<p><a name="Fig7"></A><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/0782124488/ch30/images/30-07.jpg',485,100)"><img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/reference/pro/0782124488/ch30/images/30-07t.jpg"></A><p><br></P>
<center>
<table border>
<tr>
<td><a href="960-963.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="967-970.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>


</font></BODY></HTML>