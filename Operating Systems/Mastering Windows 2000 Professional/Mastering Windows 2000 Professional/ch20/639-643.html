<html>
<head>
<meta name=vsisbn content="0782124488">
<meta name=vstitle content="Mastering Windows 2000 Professional">
<meta name=vsauthor content="Mark Minasi, Todd Phillips">
<meta name=vspublisher content="Sybex, Inc.">
<meta name=vspubdate content="01/01/00">
<meta name=vscategory content="Operations Systems: Windows 2000">



<title>Mastering Windows 2000 Professional:Installing Windows 2000 (and Automating Installation)</TITLE>
<!-- BEGIN HEADER -->
<meta name="ROBOTS" content="NOINDEX, NOFOLLOW">
<script>
<!--
function displayWindow(url, width, height) {
        var Win = window.open(url,"displayWindow",'width=' + width +
',height=' + height + ',resizable=1,scrollbars=yes');
}
//--></SCRIPT>

<!-- HEADER -->
<style type="text/css">
<!--
A:hover { color:red }
-->
</STYLE>

<!-- HEADER -->
<style type="text/css"> 
 <!--
 A:hover  {
 	color : Red;
 }
 -->
 </STYLE>

<script language="JavaScript1.2">
<!--
function checkForQuery(fm) {
  /* get the query value */
  var i = escape(fm.query.value);
  if (i == "") {
      alert('Please enter a search word or phrase');
      return false;
  }                  /* query is blank, dont run the .jsp file */
  else return true;  /* execute the .jsp file */
}
//--></script>

</HEAD>
<BODY bgcolor=#FFFFFF><FONT size=2 face="Arial, verdana, helvetica"><table width=100% border=0 cellspacing=0 cellpadding=2><tr bgcolor=#000000><td width=100% align=right><b><font color=#FFFFFF>Gotcha</font></b></td></tr></table><br><!--Begin Content Column -->

<table border=0 cellspacing=0 cellpadding=0>
<tr>
<td width=75 valign=top>
<img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/images/sm_covers/0782124488.gif" width=60 height=73 alt="Mastering Windows 2000 Professional" border="1">
</td>
<td align="left">
    <font face="arial, helvetica" size="-1" color="#336633"><b>Mastering Windows 2000 Professional</b></font>
    <br>
    <font face="arial, helvetica" size="-1"><i>by Mark Minasi, Todd Phillips</i>
    <br>
    Sybex, Inc.
    <br>
    <b>ISBN:</b>&nbsp;0782124488<b>&nbsp;&nbsp;&nbsp;Pub Date:</b>&nbsp;01/01/00</font>
</td>
</tr>
</table>
<p>
<!-- Empty Reference Subhead-->

<!--ISBN=0782124488//-->
<!--TITLE=Mastering Windows 2000 Professional//-->
<!--AUTHOR=Mark Minasi//-->
<!--AUTHOR=Todd Phillips//-->
<!--PUBLISHER=SYBEX//-->
<!--CHAPTER=20//-->
<!--PAGES=639-643//-->
<!--UNASSIGNED1//-->
<!--UNASSIGNED2//-->

<center>
<table border>
<tr>
<td><a href="636-638.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="643-646.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<p><br></P>
</P>
<h3><a name="Heading26"></A><font color="#000077">Special Topic: Using Batch Routines for Multiple Installations</FONT></H3>
<p>If you&#146;re like many people, you actually prefer the sense of certainty that comes with typing commands into a program file. Some people will always distrust software &#147;wizards&#148; to a certain extent, and will usually opt for the hands-on approach to administrative tasks like installing to multiple machines. For the rest of the chapter, then, allow us to present the batch-file approach to multiple installations.
</P>
<p>To create a batch routine, you will need to do the following:</P>
<dl>
<dd><b>1.</B>&nbsp;&nbsp;Place the Windows 2000 Professional files on a server or in a directory on your hard drive. Make sure you have plenty of space available.
<dd><b>2.</B>&nbsp;&nbsp;Create an answer file for each computer that will have Windows 2000 Professional. Each machine will have different components and/or settings, especially the computer&#146;s name. Therefore, you need to create an answer file that is unique to each machine.
<dd><b>3.</B>&nbsp;&nbsp;Start Setup from the directory where Windows 2000 Professional is located.
</DL>
<p>All you need to create the answer file is a text editor and, of course, the necessary parameters required by WINNT32 or WINNT. The answers you put in this file will depend on what you require to operate your workstation. Make sure your answer file is error-free; if the file contains mistakes, the computer will drop out of unattended mode. You will have to manually input the remainder of the information needed to finish installation.
</P>
<p>Any answer file must include the following sections even if the only information the section contains is the section name. Otherwise, Setup will pause for user input. For new installations, all the parameters must be specified in the answer file because the system does not have existing information for Setup to use. The parameters to perform upgrades are noted in the description of each parameter.</P>
<p>Each parameter includes the following information:</P>
<dl>
<dd><b>&#149;</B>&nbsp;&nbsp;Key name = key value
<dd><b>&#149;</B>&nbsp;&nbsp;Description of key values. The description also includes whether the key must be specified in the answer file for upgrades.
<dd><b>&#149;</B>&nbsp;&nbsp;Default behavior
</DL>
<p>You must apply the following conventions when creating or editing your answer file:
</P>
<dl>
<dd><b>&#149;</B>&nbsp;&nbsp;Surround section headings with brackets [ ]&#151;for example, [Unattended]. You must include all section headings, even if they do not contain any information.
<dd><b>&#149;</B>&nbsp;&nbsp;Surround user-defined keys, values, and headings with angle brackets &lt; &gt;. The bracketed item can be replaced by anything you wish as long as it conforms to the rules under that heading, key, or value.
<dd><b>&#149;</B>&nbsp;&nbsp;Precede each line of a comment with a semicolon (;).
<dd><b>&#149;</B>&nbsp;&nbsp;Do not delete section names even if the section does not contain any information.
<dd><b>&#149;</B>&nbsp;&nbsp;Do not change key names.
<dd><b>&#149;</B>&nbsp;&nbsp;Leave a space before and after equal signs. For example, keyname = value.
<dd><b>&#149;</B>&nbsp;&nbsp;Use two double quotes (<tt>&#147;&#148;</TT>) to indicate an empty value.
<dd><b>&#149;</B>&nbsp;&nbsp;Type all entries <i>exactly</I> as they appear below in the Answer File Parameters section that follows, except for those options shown in italic. Italicized entries are choices that the user can make for each parameter. Items between angle brackets (&lt;&gt;) should be replaced with the appropriate information ( for example, &lt;path&gt; should be replaced with a hard disk path to the files).
</DL>
<p>With those rules in mind, we can now explain the answer file parameters.
</P>
<p><font size="+1"><b>Answer File Parameters</B></FONT></P>
<p>The following parameters are the ones usually used during an unattended installation or upgrade. Consult the <tt>unattend.txt</TT> file for further information.</P>
<p><b>[Unattended]</B>&nbsp;&nbsp;[Unattended] is used to indicate that an unattended installation is being performed. A bit redundant, but if the header isn&#146;t included, the file will be ignored and you&#146;ll have to install Windows 2000 manually. The following parameters can exist in this section:</P>
<dl>
<dd><b>&#149;</B>&nbsp;&nbsp;OemPreinstall = <i>yes</I> | <i>no</I>
<p>Indicates whether an OEM preinstallation is being performed. If the value is <i>yes</I>, other subdirectories will be copied. A value of <i>no</I> indicates that a regular unattended installation will be performed.
</P>
<dd><b>&#149;</B>&nbsp;&nbsp;NoWaitAfterTextMode = <i>0</I> | <i>1</I>
<p>Indicates whether the GUI portion of the unattended installation should automatically boot after preinstallation. Note: This command is valid only when OemPreinstall = <i>yes.</I> If this command is missing, the default is to halt after preinstallation.
</P>
<p><i>0</I> indicates that the setup program will stop after preinstallation. <i>1</I> means that setup will reboot the system into GUI mode when the preinstallation is complete.
</P>
<dd><b>&#149;</B>&nbsp;&nbsp;FileSystem = <i>ConvertNTFS</I> | <i>LeaveAlone</I>
<p>Specifies how the Windows 2000 partition will be formatted. Generally, you should convert any partition greater than 512MB to NTFS.
</P>
<dd><b>&#149;</B>&nbsp;&nbsp;ExtendOemPartition = <i>0</I> |<i> 1</I>
<p>Used to install Windows 2000 on a disk bigger than 2GB. Setup extends the partition containing the temporary Windows 2000 files into any unpartitioned space that follows it on the disk. This disk must be a primary partition no larger than 1024 cylinders. If writing occurs beyond the 1024th cylinder, the installation will crash.
</P>
<p><i>0</I> indicates that no extension will take place. <i>1</I> means that you want to extend the partition. If you set ExtendOemPartition to <i>1</I>, FileSystem must also be set to ConvertNTFS.
</P>
<dd><b>&#149;</B>&nbsp;&nbsp;ConfirmHardware = <i>yes</I> | <i>no</I>
<p>The ConfirmHardware key determines whether users must confirm hardware and mass storage devices detected by Setup. A mass storage device includes anything that is controlled by a SCSI mini port driver. For example, all CD-ROM drives, SCSI adapters, and hard drive controllers, except Atdisk, abiodisk, and standard floppy disks, are mass storage devices.
</P>
<p><i>Yes</I> indicates that the user must confirm hardware and mass storage devices detected by Setup.
</P>
<p><i>No</I> indicates that Setup should use the hardware it detects.
</P>
<dd><b>&#149;</B>&nbsp;&nbsp;NtUpgrade = <i>manual</I> | <i>yes</I> | <i>no</I> | <i>single</I>
<p>The NtUpgrade key determines whether a previous installation of Windows NT Workstation is upgraded. It should be set if a previous version of NT exists.
</P>
<p><i>Manual</I> indicates that users must specify whether a previous installation of NT Workstation is upgraded. Users can also specify where the latest version of NT Workstation should be installed.
</P>
<p><i>Yes</I> indicates upgrade if a previous installation of NT Workstation is detected. If multiple installations are detected, upgrade the first one. On <i>x</I>86-based systems, the first NT installation is the one that is listed first in the <tt>boot.ini</TT> file. On Alpha systems, the first installation is the first one listed in the Startup environment.
</P>
<p><i>No</I> indicates do not upgrade if a previous installation of NT Workstation is detected.
</P>
<p><i>Single</I> indicates upgrade only if a single previous installation of NT is detected. If multiple installations are detected, users must indicate which installation to upgrade. If a previous installation of NT Workstation is detected and the NtUpgrade key value is specified incorrectly, the user is required to specify whether an upgrade should be performed.
</P>
<dd><b>&#149;</B>&nbsp;&nbsp;Win31UpGrade = <i>yes</I> | <i>no</I>
<p>The Win31Upgrade key determines whether previous installations of Windows for Workgroups or Windows 3.1 should be upgraded if detected on your system.
</P>
<p><i>Yes</I> indicates that previous Windows installations should be upgraded. <i>No</I> indicates that previous Windows installations should not be upgraded if they exist.
</P>
<dd><b>&#149;</B>&nbsp;&nbsp;OverwriteOemFilesOnUpgrade = <i>yes</I> | <i>no</I>
<p>Indicates whether OEM-supplied files having the same name as Windows 2000 system files should be overwritten during an unattended upgrade.
</P>
<p><i>Yes</I> implies that the OEM-supplied files should be overwritten, which is also the default. <i>No</I> indicates that the files should not be overwritten.
</P>
<dd><b>&#149;</B>&nbsp;&nbsp;TargetPath = <i>Manual</I> | <i>*</I> | <i>&lt;path&gt;</I>
<p>Indicates the directory where Windows 2000 Professional will be installed.
</P>
<p><i>Manual</I> implies that the user will be prompted to enter the path where the files will be installed.
</P>
<p>* indicates that Setup will automatically generate a unique directory name and install the files there. Usually, the path name is <tt>\WINNT.x</TT>, where <i>x</I> is 0, 1, etc., depending on how many installations are present.
</P>
<p><i>&lt;path&gt;</I> is a user-defined install directory. For example, TargetPath = <tt>C:\W2kPro</TT>.
</P>
<dd><b>&#149;</B>&nbsp;&nbsp;ComputerType = &lt;<i>HAL description</I>&gt; [<i>RETAIL</I> | <i>OEM</I>]
<p>Determines the type of Hardware Abstraction Layer (HAL) to be loaded and installed during Setup. If this key is absent, then Setup will try to detect the computer type and install the corresponding HAL. This key is valid only when OemPreinstall = Yes.
</P>
<p><i>&lt;HAL description&gt;</I> indicates the HAL to be installed. This string must match one of the strings in the [Computer] section of <tt>txtsetup.sif</TT> (retail HAL) or <tt>txtsetup.oem</TT> (OEM HAL).
</P>
<p><i>RETAIL</I> implies that the HAL to be installed is supplied as part of the Windows NT installation.
</P>
<p><i>OEM</I> means that the HAL to be installed is OEM-supplied. The driver name must also be listed in the [OemBootFiles] section of the <tt>unattend.txt</TT> file as well.
</P>
<dd><b>&#149;</B>&nbsp;&nbsp;KeyboardLayout = &lt;<i>layout description</I>&gt;
<p>Determines the type of keyboard layout that will be installed. If this key is missing, the layout will be detected and installed.
</P>
<p><i>&lt;layout description&gt;</I> needs to match one of the strings on the right side in the [KeyboardLayout] section of <tt>txtsetup.sif</TT>.
</DL>
<p><br></P>
<center>
<table border>
<tr>
<td><a href="636-638.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="643-646.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>


</font></BODY></HTML>