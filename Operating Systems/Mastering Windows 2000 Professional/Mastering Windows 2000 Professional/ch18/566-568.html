<html>
<head>
<meta name=vsisbn content="0782124488">
<meta name=vstitle content="Mastering Windows 2000 Professional">
<meta name=vsauthor content="Mark Minasi, Todd Phillips">
<meta name=vspublisher content="Sybex, Inc.">
<meta name=vspubdate content="01/01/00">
<meta name=vscategory content="Operations Systems: Windows 2000">



<title>Mastering Windows 2000 Professional:Understanding the Architecture</TITLE>
<!-- BEGIN HEADER -->
<meta name="ROBOTS" content="NOINDEX, NOFOLLOW">
<script>
<!--
function displayWindow(url, width, height) {
        var Win = window.open(url,"displayWindow",'width=' + width +
',height=' + height + ',resizable=1,scrollbars=yes');
}
//--></SCRIPT>

<!-- HEADER -->
<style type="text/css">
<!--
A:hover { color:red }
-->
</STYLE>

<!-- HEADER -->
<style type="text/css"> 
 <!--
 A:hover  {
 	color : Red;
 }
 -->
 </STYLE>

<script language="JavaScript1.2">
<!--
function checkForQuery(fm) {
  /* get the query value */
  var i = escape(fm.query.value);
  if (i == "") {
      alert('Please enter a search word or phrase');
      return false;
  }                  /* query is blank, dont run the .jsp file */
  else return true;  /* execute the .jsp file */
}
//--></script>

</HEAD>
<BODY bgcolor=#FFFFFF><FONT size=2 face="Arial, verdana, helvetica"><table width=100% border=0 cellspacing=0 cellpadding=2><tr bgcolor=#000000><td width=100% align=right><b><font color=#FFFFFF>Gotcha</font></b></td></tr></table><br><!--Begin Content Column -->

<table border=0 cellspacing=0 cellpadding=0>
<tr>
<td width=75 valign=top>
<img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/images/sm_covers/0782124488.gif" width=60 height=73 alt="Mastering Windows 2000 Professional" border="1">
</td>
<td align="left">
    <font face="arial, helvetica" size="-1" color="#336633"><b>Mastering Windows 2000 Professional</b></font>
    <br>
    <font face="arial, helvetica" size="-1"><i>by Mark Minasi, Todd Phillips</i>
    <br>
    Sybex, Inc.
    <br>
    <b>ISBN:</b>&nbsp;0782124488<b>&nbsp;&nbsp;&nbsp;Pub Date:</b>&nbsp;01/01/00</font>
</td>
</tr>
</table>
<p>
<!-- Empty Reference Subhead-->

<!--ISBN=0782124488//-->
<!--TITLE=Mastering Windows 2000 Professional//-->
<!--AUTHOR=Mark Minasi//-->
<!--AUTHOR=Todd Phillips//-->
<!--PUBLISHER=SYBEX//-->
<!--CHAPTER=18//-->
<!--PAGES=566-568//-->
<!--UNASSIGNED1//-->
<!--UNASSIGNED2//-->

<center>
<table border>
<tr>
<td><a href="564-566.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="568-570.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<p><br></P>
<p>For one thing, no matter how poorly behaved your Windows 3.1 application is, no matter how much of a CPU thief it is, it still can&#146;t affect your 32-bit applications. A rude application <i>can</I> keep your other Windows 3.1 applications from getting CPU time&#151;but there&#146;s even a way to work around that. Think about it for a minute, and you&#146;ll see what it is: running separate WOWEXECs.</P>
<p>Separate WOWEXECs cost you in memory, yes, but they also get separate CPU time allocations from Windows 2000, which means that you can use Windows 2000 to get around Windows 3.1&#146;s uncooperative multitasking nature. Put each one of your Windows 3.1 applications in its own separate memory space, and they&#146;ll multitask like a charm. Oh, by the way, that cooperative multitasking problem doesn&#146;t pop up with Win32 applications; you might say that they&#146;re all built with a preinstalled hook.</P>
<p><font size="+1"><b>OS/2 and POSIX</B></FONT></P>
<p>Windows 2000 is a platform for client-server applications, and many client-server applications were built to run atop LAN Manager or Unix. LAN Manager ran on OS/2 version 1.3, so backward compatibility with Microsoft&#146;s previous network product required that Windows 2000 be able to run LAN Manager applications. The OS/2 subsystem makes sure that happens.
</P>
<p>Similarly, Unix is a platform for many client-server applications. Windows 2000 would like to be able to support those applications, but, sadly, Unix isn&#146;t one operating system; it&#146;s an umbrella name for many different companies&#146; implementations of the whole idea of Unix. The closest we come to a &#147;standard&#148; Unix is a government implementation called POSIX, and so Windows 2000 supports POSIX applications.</P>
<p><font size="+1"><b>Virtual DOS Machines (VDMs)</B></FONT></P>
<p>No operating system could call itself Windows compatible if it didn&#146;t support DOS programs; Windows 2000 does that through a system called Virtual DOS Machine, or VDM. <i>How</I> Windows 2000 achieves compatibility is an interesting story.</P>
<p>DOS programs have two basic needs: unrestricted access to 1MB of memory and unrestricted access to 64K of I/O addresses.</P>
<p>We&#146;re sure you know what a memory address is, so we&#146;ll lay aside for the moment discussion of how Windows 2000 solves that problem for DOS. But many people don&#146;t understand I/O addresses, so let&#146;s take a minute to explain them. All hardware devices, both chips on the motherboard and add-in cards, have hardware or I/O addresses. It&#146;s not unusual for us to say something like, &#147;The communications program uses COM1,&#148; when we mean that the communications program sometimes needs to send data out of a serial port. It finds that serial port somewhere. From the CPU&#146;s point of view, nothing is actually called COM1. Instead, the CPU recognizes a piece of hardware at a particular address&#151;hexadecimal address 3F8, in the case of COM1.</P>
<p>Windows 2000 programs don&#146;t control a communications port by directly sending data to I/O address 3F8. Instead, they let the operating system do the controlling. Rather than sending the commands to COM1 to tell the modem to dial, for example, Windows 2000 programs instruct the operating system to tell the modem to dial a particular number. Windows 2000 applications, therefore, don&#146;t have to control hardware directly. DOS programs see the matter differently.</P>
<p>Virtually all DOS programs choose not to leave hardware control to the operating system, and instead twiddle the hardware directly via that hardware&#146;s I/O addresses. Now, that could be a problem for Windows 2000 because Windows 2000 doesn&#146;t want any software addressing hardware directly except for the operating system itself. Disallowing DOS programs from communicating directly with I/O addresses, however, would make about 99 percent of the DOS programs crash, which would damage somewhat Windows 2000&#146;s claim to be DOS compatible. What, then, to do? The answer: Make use of <i>virtual device drivers</I>, or VxDs.</P>
<p>A VxD is a piece of operating system software that essentially shields the hardware from the program. When an application program, such as a DOS program, tries to access I/O address 3F8 directly, the action triggers a VxD for that address. As the VxD was attached by Windows 2000&#146;s designers to I/O address 3F8, that particular VxD is designed to handle serial port I/O. VxDs exist for the keyboard, the display screen, the hardware timer circuitry, the parallel port, you name it&#151;just about all the standard PC hardware.</P>
<p>But what about the <i>not-</I>so-standard hardware? What kind of VxD support does Windows 2000 have for it? Well, that&#146;s sort of a problem. Keyboards, mice, parallel ports, and the like are all pretty standard, so writing VxDs for them was possible. But no real market leader or standard in fax boards exists, so Windows 2000 can&#146;t include a VxD for fax boards. Result: A number of DOS-based or Windows 3.1-based fax programs don&#146;t run under Windows 2000. (Actually, Windows 2000 has a VxD that handles many fax boards, but not all of them.) Other examples of devices that lack VxD support: factory automation interfaces or proprietary boards. If Windows 2000 runs across a DOS program that tries to access an address that Windows 2000 doesn&#146;t have a VxD for, Windows 2000 terminates the DOS program. This inability to run some DOS apps costs Windows 2000 in terms of compatibility, but it&#146;s the price to pay for stability.</P><p><br></P>
<center>
<table border>
<tr>
<td><a href="564-566.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="568-570.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>


</font></BODY></HTML>