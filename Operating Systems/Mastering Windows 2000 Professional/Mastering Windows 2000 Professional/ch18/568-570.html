<html>
<head>
<meta name=vsisbn content="0782124488">
<meta name=vstitle content="Mastering Windows 2000 Professional">
<meta name=vsauthor content="Mark Minasi, Todd Phillips">
<meta name=vspublisher content="Sybex, Inc.">
<meta name=vspubdate content="01/01/00">
<meta name=vscategory content="Operations Systems: Windows 2000">



<title>Mastering Windows 2000 Professional:Understanding the Architecture</TITLE>
<!-- BEGIN HEADER -->
<meta name="ROBOTS" content="NOINDEX, NOFOLLOW">
<script>
<!--
function displayWindow(url, width, height) {
        var Win = window.open(url,"displayWindow",'width=' + width +
',height=' + height + ',resizable=1,scrollbars=yes');
}
//--></SCRIPT>

<!-- HEADER -->
<style type="text/css">
<!--
A:hover { color:red }
-->
</STYLE>

<!-- HEADER -->
<style type="text/css"> 
 <!--
 A:hover  {
 	color : Red;
 }
 -->
 </STYLE>

<script language="JavaScript1.2">
<!--
function checkForQuery(fm) {
  /* get the query value */
  var i = escape(fm.query.value);
  if (i == "") {
      alert('Please enter a search word or phrase');
      return false;
  }                  /* query is blank, dont run the .jsp file */
  else return true;  /* execute the .jsp file */
}
//--></script>

</HEAD>
<BODY bgcolor=#FFFFFF><FONT size=2 face="Arial, verdana, helvetica"><table width=100% border=0 cellspacing=0 cellpadding=2><tr bgcolor=#000000><td width=100% align=right><b><font color=#FFFFFF>Gotcha</font></b></td></tr></table><br><!--Begin Content Column -->

<table border=0 cellspacing=0 cellpadding=0>
<tr>
<td width=75 valign=top>
<img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/images/sm_covers/0782124488.gif" width=60 height=73 alt="Mastering Windows 2000 Professional" border="1">
</td>
<td align="left">
    <font face="arial, helvetica" size="-1" color="#336633"><b>Mastering Windows 2000 Professional</b></font>
    <br>
    <font face="arial, helvetica" size="-1"><i>by Mark Minasi, Todd Phillips</i>
    <br>
    Sybex, Inc.
    <br>
    <b>ISBN:</b>&nbsp;0782124488<b>&nbsp;&nbsp;&nbsp;Pub Date:</b>&nbsp;01/01/00</font>
</td>
</tr>
</table>
<p>
<!-- Empty Reference Subhead-->

<!--ISBN=0782124488//-->
<!--TITLE=Mastering Windows 2000 Professional//-->
<!--AUTHOR=Mark Minasi//-->
<!--AUTHOR=Todd Phillips//-->
<!--PUBLISHER=SYBEX//-->
<!--CHAPTER=18//-->
<!--PAGES=568-570//-->
<!--UNASSIGNED1//-->
<!--UNASSIGNED2//-->

<center>
<table border>
<tr>
<td><a href="566-568.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="570-572.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<p><br></P>
<h3><a name="Heading21"></A><font color="#000077">Managing Memory in Windows 2000</FONT></H3>
<p>Let&#146;s wrap up this chapter with a quick look at how Windows 2000 allocates memory to applications in its quest to be the most stable operating system around.
</P>
<p>All Windows 2000 applications start life being told that they have access to 2GB of RAM. Not only is that not true (we&#146;ve seen Windows 2000 machines with more than 2GB of RAM, but not many), but NT keeps on telling this little lie to <i>all</I> of the applications running under NT!</P>

<table border="2" bordercolor="#0000" align="CENTER">
<tr><td><font size="+1"><b>The Virtual Memory Manager as Producer</B></FONT>
<p>Have you ever seen Mel Brooks&#146; movie <i>The Producers</I>? It&#146;s a farce about a crooked producer who comes up with a surefire way to make a pile of money. He finds a number of rich people who&#146;d like to back a Broadway play and, talking to each person privately, sells 90 percent of the interest in the play over and over again. By the time he&#146;s done, he&#146;s probably sold 1,000 percent of the play to unsuspecting investors. Then he sets off to create a play that will definitely flop, allowing him to tell the unwitting investors that oh, well, that&#146;s how it goes, as the play closes on its first night&#151;and the crooked producer walks away with all the investment money. Of course, the plan backfires; the play is a big hit and the producer encounters an endless string of problems.</P>
<p>Windows 2000&#146;s Virtual Memory Manager is kind of like that producer.</P>
</TABLE>

<blockquote>
<p><font size="-1"><hr><b>NOTE:&nbsp;&nbsp;</B>To be precise, Windows 2000 applications (or, rather, Win32 applications, as there&#146;s really no such thing as a Windows 2000 application) can work within a memory space equal to 2048MB, <i>minus</I> 128K. You&#146;ll see in a moment why that 128K is reserved.<hr></FONT>
</BLOCKQUOTE>
<h4 align="LEFT"><a name="Heading22"></A><font color="#000077">The Numbers behind Windows 2000&#146;s Memory Requirements</FONT></H4>
<p>Windows 2000 requires that any machine it uses support a 32-bit memory structure, and 232 bits is 4096MB, or 4GB. The first chip on which Microsoft implemented NT, however, was the MIPS chip, which supports 4GB but with a requirement&#151;applications can&#146;t have more than 2GB of that 4GB total, and the operating system must get the other 2GB. It&#146;s dumb, but it&#146;s not the dumbest thing we&#146;ve ever seen built into an operating system. Microsoft decided to follow suit and designed Windows 2000 to require the same thing.
</P>
<blockquote>
<p><font size="-1"><hr><b>NOTE:&nbsp;&nbsp;</B>Just as an aside here, in our opinion the decision to restrict apps to 2GB max was a severely dumb move. No other 32-bit CPU that we know of imposes this limitation, and there&#146;s no <i>a priori</I> good reason to impose the limitation. Incorporating it into NT&#146;s architecture makes about as much sense as saying that my Honda Civic is a hatchback and gets good mileage, so you should buy only hatchback cars for good mileage.<hr></FONT>
</BLOCKQUOTE>
<p>Remember we mentioned in a previous note that, to be precise, 128K of that 2GB is not available? That&#146;s because Microsoft defines the memory space of each Win32 program as 2GB but restricts the bottom 64K and top 64K of that memory; no program can address it. <i>Why</I> Microsoft restricts that space reflects a small stroke of genius, and the story is told in the following section.</P>
<h4 align="LEFT"><a name="Heading23"></A><font color="#000077">Memory Mistakes That Programmers Make</FONT></H4>
<p>Every programmer makes mistakes. Some mistakes are, however, more likely and more prevalent than others. Here&#146;s two of them: accidentally filling a memory address pointer to all zeroes and then trying to write data, and accidentally filling a memory address pointer to all ones and then trying to write data.
</P>
<p>The first error would lead a program to damage data in the bottom 64K of its memory space. The second error would lead a program to damage data in the top 64K of its memory space. By including those two memory address areas but marking them off-limits to a program, Microsoft guarantees that any accidental attempts at writing in the bottom or top 64K&#151;a symptom of a common programming error&#151;<i>must</I> trigger an error message. A very clever feature.</P><p><br></P>
<center>
<table border>
<tr>
<td><a href="566-568.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="570-572.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>


</font></BODY></HTML>