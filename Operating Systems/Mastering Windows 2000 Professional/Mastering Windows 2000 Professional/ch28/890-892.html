<html>
<head>
<meta name=vsisbn content="0782124488">
<meta name=vstitle content="Mastering Windows 2000 Professional">
<meta name=vsauthor content="Mark Minasi, Todd Phillips">
<meta name=vspublisher content="Sybex, Inc.">
<meta name=vspubdate content="01/01/00">
<meta name=vscategory content="Operations Systems: Windows 2000">



<title>Mastering Windows 2000 Professional:Running Windows 3.x and DOS Programs</TITLE>
<!-- BEGIN HEADER -->
<meta name="ROBOTS" content="NOINDEX, NOFOLLOW">
<script>
<!--
function displayWindow(url, width, height) {
        var Win = window.open(url,"displayWindow",'width=' + width +
',height=' + height + ',resizable=1,scrollbars=yes');
}
//--></SCRIPT>

<!-- HEADER -->
<style type="text/css">
<!--
A:hover { color:red }
-->
</STYLE>

<!-- HEADER -->
<style type="text/css"> 
 <!--
 A:hover  {
 	color : Red;
 }
 -->
 </STYLE>

<script language="JavaScript1.2">
<!--
function checkForQuery(fm) {
  /* get the query value */
  var i = escape(fm.query.value);
  if (i == "") {
      alert('Please enter a search word or phrase');
      return false;
  }                  /* query is blank, dont run the .jsp file */
  else return true;  /* execute the .jsp file */
}
//--></script>

</HEAD>
<BODY bgcolor=#FFFFFF><FONT size=2 face="Arial, verdana, helvetica"><table width=100% border=0 cellspacing=0 cellpadding=2><tr bgcolor=#000000><td width=100% align=right><b><font color=#FFFFFF>Gotcha</font></b></td></tr></table><br><!--Begin Content Column -->

<table border=0 cellspacing=0 cellpadding=0>
<tr>
<td width=75 valign=top>
<img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/images/sm_covers/0782124488.gif" width=60 height=73 alt="Mastering Windows 2000 Professional" border="1">
</td>
<td align="left">
    <font face="arial, helvetica" size="-1" color="#336633"><b>Mastering Windows 2000 Professional</b></font>
    <br>
    <font face="arial, helvetica" size="-1"><i>by Mark Minasi, Todd Phillips</i>
    <br>
    Sybex, Inc.
    <br>
    <b>ISBN:</b>&nbsp;0782124488<b>&nbsp;&nbsp;&nbsp;Pub Date:</b>&nbsp;01/01/00</font>
</td>
</tr>
</table>
<p>
<!-- Empty Reference Subhead-->

<!--ISBN=0782124488//-->
<!--TITLE=Mastering Windows 2000 Professional//-->
<!--AUTHOR=Mark Minasi//-->
<!--AUTHOR=Todd Phillips//-->
<!--PUBLISHER=SYBEX//-->
<!--CHAPTER=28//-->
<!--PAGES=890-892//-->
<!--UNASSIGNED1//-->
<!--UNASSIGNED2//-->

<center>
<table border>
<tr>
<td><a href="885-889.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="892-896.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<p><br></P>
<p><font size="+1"><b>Setting Conventional Memory</B></FONT></P>
<p>The Conventional Memory setting contains two parts, Total and Initial Environment:
</P>
<dl>
<dt><b>Total</B>
<dd>Sets the number of kilobytes that <tt>command.com</TT> needs to work. If you&#146;re trying to reduce the amount of memory that a program uses, you can tweak this amount to see the point at which the application no longer runs. To let the application take as much conventional memory as it needs, select Auto from the drop-down list.
<dt><b>Initial Environment</B>
<dd>Sets the number of bytes (not kilobytes) reserved for <tt>command.com</TT>, the part of DOS that understands what to do when you type a command. Windows 2000&#146;s Help says that if this amount is set to Auto, then this parameter is set by your <tt>SHELL=</TT> statement, but we don&#146;t have one in our <tt>config.sys</TT> files and all the programs we tested still work fine.
</DL>

<blockquote>
<p><font size="-1"><hr><b>WARNING:&nbsp;&nbsp;</B>Be careful when adjusting the Initial Environment setting! Sometimes, if you set this number too low, all of Windows 2000 will crash and you&#146;ll have to reboot to get the system back.<hr></FONT>
</BLOCKQUOTE>
<p>Notice the small Protected check box below the Total text box. Checking the Protected box keeps the application from affecting other programs if it crashes. As you probably know, one downed application in Windows 2000 often starts a domino effect of crashing applications, so although this setting may slow down your program a little, it might not be a bad idea to check this option if you <i>know</I> that an application is buggy and liable to go down in flames. The difference in speed is not always noticeable.</P>
<p><font size="+1"><b>Setting Expanded (EMS) Memory</B></FONT></P>
<p>Expanded (EMS) Memory sets the amount of paged memory available to the application. Auto is the default, but because a lot of DOS applications have started using extended memory rather than expanded, this setting doesn&#146;t mean much for these applications. Check your application&#146;s documentation to see if it can use expanded memory&#151;if not, then you can select None from the list box.
</P>
<p><font size="+1"><b>Setting Extended (XMS) Memory</B></FONT></P>
<p>The Extended (XMS) Memory setting determines how much memory above 1024K is available to the application. Many recent applications support extended memory, but check the documentation to be sure.
</P>
<blockquote>
<p><font size="-1"><hr><b>WARNING:&nbsp;&nbsp;</B>Do <i>not</I> set the XMS memory to a number greater than the memory physically in the machine, or the program won&#146;t run.<hr></FONT>
</BLOCKQUOTE>
<p>Although there&#146;s a check box in this section permitting a program to use the high memory area (HMA), most of the time there&#146;s no point in enabling this option. The default <tt>config.sys</TT> specifies that DOS is loaded high, and the HMA has room for only one program. Unless you remove the <tt>DOS=HIGH</TT> line from <tt>config.sys</TT>, then nothing else can use the HMA&#151;even if you give the program permission.</P>
<p><font size="+1"><b>Setting MS-DOS Protected-Mode Memory</B></FONT></P>
<p>The MS-DOS Protected Mode Interface (DPMI) Memory setting describes the amount of <i>managed</I> extended memory that you allocate to the application. The difference between normal extended memory and DPMI memory is this: In normal extended memory, nothing prevents one application from attempting to access the extended memory that another application is using&#151;with predictable results. Unless you know the specific amount of extended memory that the application will need, just leave this set to Auto and the application will take what it needs.</P>
<p>Interestingly, although allocating more extended memory than physically exists on the machine will prevent the application from running, allocating more DPMI memory than exists on the machine doesn&#146;t seem to affect the application.</P>
<p><font size="+1"><b>Troubleshooting Memory Settings</B></FONT></P>
<p>To a significant extent, memory settings determine how a DOS app will run and even whether it will run at all. Generally speaking, Windows 2000 handles your program&#146;s memory requirements without needing too much guidance. If your programs aren&#146;t working right, however, here are some things to check:
</P>
<p><b>Is Enough Conventional Memory Allocated to the Application?</B>&nbsp;&nbsp;If you play around with the conventional memory settings and set them lower than the amount of memory required, the program won&#146;t run. There&#146;s no warning system in place, so if you change the settings in the Properties box, you won&#146;t know that anything&#146;s wrong until you try to start up the application and see an error message warning that you do not have enough conventional memory to run the application.</P>
<p>If the program settings allocate enough memory (or are set on Auto) but you&#146;re still getting this message, see if the program will run if you unload some programs from memory.</P>
<p><b>Is More Expanded Memory Allocated than Exists on the Computer?</B>&nbsp;&nbsp;Expanded memory won&#146;t hurt programs not equipped to use it (although it wastes memory). However, if you allocate more memory than exists on the machine (for example, telling an 8MB machine that Lotus gets 16MB of expanded memory), then the program won&#146;t run. Unless you watch <i>very</I> carefully, it&#146;s not easy to tell what&#146;s going on, but in between the welcome screen for your application and being ignominiously dumped back in Windows 2000 Professional, a brief &#147;insufficient memory&#148; message flashes.</P>
<p>If your DOS program seems to start up and then fail, check the settings for expanded memory. Set them to None if the program can&#146;t use the memory (check the documentation) or Auto if it can.</P>
<p><b>Have You Allocated More Extended Memory than Exists on the Computer?</B>&nbsp;&nbsp;The Extended Memory setting determines the maximum amount of memory above 1024K that the program can use. If you specify a number greater than the amount in your PC, then your program will start up and then fail, with the message &#147;Cannot initialize memory manager.&#148; If you see this message, press Esc to clear the screen and then adjust the extended memory settings to Auto or a lower number.</P>
<p>Some programs don&#146;t cope well with having an unlimited amount of memory available, so if your programs don&#146;t work, try designating a specific extended memory quota.</P>
<p><b>Is There Sufficient Memory for the Operating Environment?</B>&nbsp;&nbsp;We recommend that you leave the settings for the initial environment alone. Auto, the default setting, ensures that the application can take up as many bytes in memory as it needs for its operating environment, the <tt>command.com</TT> file. The <tt>command.com</TT> file doesn&#146;t require much memory. However, if you set this value too low, then the application may run normally but crash when you attempt to exit.</P><p><br></P>
<center>
<table border>
<tr>
<td><a href="885-889.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="892-896.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>


</font></BODY></HTML>