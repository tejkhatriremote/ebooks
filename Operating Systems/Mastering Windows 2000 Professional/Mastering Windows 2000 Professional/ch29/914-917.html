<html>
<head>
<meta name=vsisbn content="0782124488">
<meta name=vstitle content="Mastering Windows 2000 Professional">
<meta name=vsauthor content="Mark Minasi, Todd Phillips">
<meta name=vspublisher content="Sybex, Inc.">
<meta name=vspubdate content="01/01/00">
<meta name=vscategory content="Operations Systems: Windows 2000">



<title>Mastering Windows 2000 Professional:Fixing Windows 2000 Professional When It Breaks</TITLE>
<!-- BEGIN HEADER -->
<meta name="ROBOTS" content="NOINDEX, NOFOLLOW">
<script>
<!--
function displayWindow(url, width, height) {
        var Win = window.open(url,"displayWindow",'width=' + width +
',height=' + height + ',resizable=1,scrollbars=yes');
}
//--></SCRIPT>

<!-- HEADER -->
<style type="text/css">
<!--
A:hover { color:red }
-->
</STYLE>

<!-- HEADER -->
<style type="text/css"> 
 <!--
 A:hover  {
 	color : Red;
 }
 -->
 </STYLE>

<script language="JavaScript1.2">
<!--
function checkForQuery(fm) {
  /* get the query value */
  var i = escape(fm.query.value);
  if (i == "") {
      alert('Please enter a search word or phrase');
      return false;
  }                  /* query is blank, dont run the .jsp file */
  else return true;  /* execute the .jsp file */
}
//--></script>

</HEAD>
<BODY bgcolor=#FFFFFF><FONT size=2 face="Arial, verdana, helvetica"><table width=100% border=0 cellspacing=0 cellpadding=2><tr bgcolor=#000000><td width=100% align=right><b><font color=#FFFFFF>Gotcha</font></b></td></tr></table><br><!--Begin Content Column -->

<table border=0 cellspacing=0 cellpadding=0>
<tr>
<td width=75 valign=top>
<img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/images/sm_covers/0782124488.gif" width=60 height=73 alt="Mastering Windows 2000 Professional" border="1">
</td>
<td align="left">
    <font face="arial, helvetica" size="-1" color="#336633"><b>Mastering Windows 2000 Professional</b></font>
    <br>
    <font face="arial, helvetica" size="-1"><i>by Mark Minasi, Todd Phillips</i>
    <br>
    Sybex, Inc.
    <br>
    <b>ISBN:</b>&nbsp;0782124488<b>&nbsp;&nbsp;&nbsp;Pub Date:</b>&nbsp;01/01/00</font>
</td>
</tr>
</table>
<p>
<!-- Empty Reference Subhead-->

<!--ISBN=0782124488//-->
<!--TITLE=Mastering Windows 2000 Professional//-->
<!--AUTHOR=Mark Minasi//-->
<!--AUTHOR=Todd Phillips//-->
<!--PUBLISHER=SYBEX//-->
<!--CHAPTER=29//-->
<!--PAGES=914-917//-->
<!--UNASSIGNED1//-->
<!--UNASSIGNED2//-->

<center>
<table border>
<tr>
<td><a href="912-914.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="917-920.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<p><br></P>
<p>In general, remember that a Windows 2000 computer runs different kinds of user accounts&#151;administrators, users, power users, and so on. You&#146;ll make your life easiest if you remember to log on as an administrator for that particular workstation before trying to change permissions on files or do anything with the Control Panel or User Manager.
</P>
<h3><a name="Heading10"></A><font color="#000077">Restoring a Configuration</FONT></H3>
<p>Sometimes, no matter how vigilant you&#146;ve been, mistakes happen or something just goes wrong, and you need to fix your system. These fixes range from easy to horrific.
</P>
<p>We&#146;ll start with a relatively easy one. What happens if you successfully install Windows 2000, try to adjust your system configuration, and render your PC unusable or even unbootable? Something as simple as changing the video driver to something that your system can&#146;t handle will do that, and it&#146;s hard to restore the original driver if you can&#146;t read what&#146;s on your screen. If you&#146;ve messed up your system&#146;s configuration, what do you do?</P>
<p>One thing that you <i>could</I> do is reinstall Windows 2000. But not only do you have to do the installation process itself, you have to set up all services and user accounts again, and this gets very boring and/or frustrating very quickly. Fortunately, there are other ways to fix your setup when something&#146;s gone wrong.</P>
<h4 align="LEFT"><a name="Heading11"></A><font color="#000077">Using the &#147;Last Known Good&#148; Menu</FONT></H4>
<p>If you&#146;ve changed your system so that it can&#146;t boot Windows 2000, one of these better solutions can be seen while you&#146;re rebooting. If you watch while your machine&#146;s booting up, you&#146;ll see a message on a black screen that says &#147;For troubleshooting and advanced startup options for Windows 2000, press F8.&#148; If you press the F8 key, you&#146;ll see a menu asking you whether you want to
</P>
<dl>
<dd><b>&#149;</B>&nbsp;&nbsp;Boot into Safe Mode
<dd><b>&#149;</B>&nbsp;&nbsp;Boot into Safe Mode with Networking enabled
<dd><b>&#149;</B>&nbsp;&nbsp;Boot to Safe Mode with a Command Prompt
<dd><b>&#149;</B>&nbsp;&nbsp;Enable Boot Logging
<dd><b>&#149;</B>&nbsp;&nbsp;Enable VGA Mode
<dd><b>&#149;</B>&nbsp;&nbsp;Use the <i>Last Known Good configuration</I>&#151;the configuration that was used the last time the machine booted successfully
<dd><b>&#149;</B>&nbsp;&nbsp;Enable Debugging Mode
</DL>
<p>These options cover most of the possible troubleshooting scenarios involving the boot process. If your machine won&#146;t boot, you probably don&#146;t want to use the current configuration; so choose the Last Known Good configuration. This should make your machine bootable.
</P>
<p><font size="+1"><b>When Does (and Doesn&#146;t) It Work?</B></FONT></P>
<p>What are the criteria for a configuration being the Last Known Good one? To qualify, a configuration must not have produced any critical errors involving a driver or a system file, and a user must have been able to log on to the system at least once.
</P>
<p>The Last Known Good configuration can&#146;t always help you. If any of the following are true, you&#146;ll have to use another solution:</P>
<dl>
<dd><b>&#149;</B>&nbsp;&nbsp;You made a change more than one successful boot ago and want to restore things as they were before the change.
<dd><b>&#149;</B>&nbsp;&nbsp;The information that you want to change is not related to control-set information&#151;user profiles and file permissions fall into the category of information that can&#146;t be changed with the Last Known Good menu.
<dd><b>&#149;</B>&nbsp;&nbsp;The system boots, a user logs on, and then the system hangs.
<dd><b>&#149;</B>&nbsp;&nbsp;You change your video driver to an incompatible driver, restart the system, and then log on with the bad driver (you can still type, even if you can&#146;t see).
</DL>
<blockquote>
<p><font size="-1"><hr><b>NOTE:&nbsp;&nbsp;</B>The key to getting Last Known Good to work is knowing what constitutes a successful logon. A <i>successful logon</I> is when you have entered your username and password and <i>have been authenticated</I>. Ever seen the message that a domain controller could not be found but you have been logged on with cached credentials? NT considers that a successful logon. If you suspect even for a moment that the change you made might not work, don&#146;t log on. Let the computer sit at the Ctrl&#43;Alt&#43;Del prompt for a couple of minutes. If you do not receive any messages about failed services, then log on.<hr></FONT>
</BLOCKQUOTE>
<h4 align="LEFT"><a name="Heading12"></A><font color="#000077">Using the Emergency Repair Disk</FONT></H4>
<p>If you&#146;ve screwed up your operating system setup in a way that using the Last Known Good configuration can&#146;t help you, you still have another option before (groan) reinstalling the operating system. Every time that you make a successful change to your system&#146;s configuration, you should back it up (you&#146;ll see how to do that in a minute). This backup disk, on which your system&#146;s configuration information is stored, is your emergency repair disk (ERD).
</P>
<p>To use the ERD, insert the CD-ROM into your CD-ROM drive, pop the installation floppies into the floppy drive, and work as though you planned to reinstall. If you installed from a local directory or across the network, simply start the setup as you did originally. You can even start the setup from a local CD-ROM if you originally installed across the network. That doesn&#146;t really matter, just run the Setup program.</P>
<p>After the files have copied to the hard drive, and your computer has been rebooted, you&#146;ll come to the Setup screen, on which the installation program appears, prompting you to begin installation, begin a custom installation, leave Setup, or repair a damaged system. Press <b>R</B> to repair your system. You&#146;ll be asked whether you want to perform a Manual Repair, in which you will select the repair options you want to run, or a Fast Repair in which all of the actions will be performed.</P>
<p>When you select the Manual Repair option, you&#146;ll see a message prompting you to insert the ERD in drive A. Do so, and you&#146;ll see a message along the status bar at the bottom of the screen saying that Setup is reading <tt>repair.inf</TT>. After it&#146;s done, it prompts you to insert Setup Disk 1 in drive A.</P>
<p>After you insert Disk 1, Setup asks if you want to do the following:</P>
<dl>
<dd><b>&#149;</B>&nbsp;&nbsp;Inspect startup environment
<dd><b>&#149;</B>&nbsp;&nbsp;Verify Windows 2000 system files
<dd><b>&#149;</B>&nbsp;&nbsp;Inspect boot sector
</DL>
<blockquote>
<p><font size="-1"><hr><b>NOTE:&nbsp;&nbsp;</B>Windows 2000 also gives you the option of using a Recovery Console. If you choose this option, you will be booted to a command prompt from which you can copy in new files to replace damaged or missing files, change your <tt>boot.ini</TT> file, or any other option that would repair your installation.<hr></FONT>
</BLOCKQUOTE>
<p><br></P>
<center>
<table border>
<tr>
<td><a href="912-914.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="917-920.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>


</font></BODY></HTML>