<html>
<head>
<meta name=vsisbn content="0782124488">
<meta name=vstitle content="Mastering Windows 2000 Professional">
<meta name=vsauthor content="Mark Minasi, Todd Phillips">
<meta name=vspublisher content="Sybex, Inc.">
<meta name=vspubdate content="01/01/00">
<meta name=vscategory content="Operations Systems: Windows 2000">



<title>Mastering Windows 2000 Professional:Fixing Windows 2000 Professional When It Breaks</TITLE>
<!-- BEGIN HEADER -->
<meta name="ROBOTS" content="NOINDEX, NOFOLLOW">
<script>
<!--
function displayWindow(url, width, height) {
        var Win = window.open(url,"displayWindow",'width=' + width +
',height=' + height + ',resizable=1,scrollbars=yes');
}
//--></SCRIPT>

<!-- HEADER -->
<style type="text/css">
<!--
A:hover { color:red }
-->
</STYLE>

<!-- HEADER -->
<style type="text/css"> 
 <!--
 A:hover  {
 	color : Red;
 }
 -->
 </STYLE>

<script language="JavaScript1.2">
<!--
function checkForQuery(fm) {
  /* get the query value */
  var i = escape(fm.query.value);
  if (i == "") {
      alert('Please enter a search word or phrase');
      return false;
  }                  /* query is blank, dont run the .jsp file */
  else return true;  /* execute the .jsp file */
}
//--></script>

</HEAD>
<BODY bgcolor=#FFFFFF><FONT size=2 face="Arial, verdana, helvetica"><table width=100% border=0 cellspacing=0 cellpadding=2><tr bgcolor=#000000><td width=100% align=right><b><font color=#FFFFFF>Gotcha</font></b></td></tr></table><br><!--Begin Content Column -->

<table border=0 cellspacing=0 cellpadding=0>
<tr>
<td width=75 valign=top>
<img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/images/sm_covers/0782124488.gif" width=60 height=73 alt="Mastering Windows 2000 Professional" border="1">
</td>
<td align="left">
    <font face="arial, helvetica" size="-1" color="#336633"><b>Mastering Windows 2000 Professional</b></font>
    <br>
    <font face="arial, helvetica" size="-1"><i>by Mark Minasi, Todd Phillips</i>
    <br>
    Sybex, Inc.
    <br>
    <b>ISBN:</b>&nbsp;0782124488<b>&nbsp;&nbsp;&nbsp;Pub Date:</b>&nbsp;01/01/00</font>
</td>
</tr>
</table>
<p>
<!-- Empty Reference Subhead-->

<!--ISBN=0782124488//-->
<!--TITLE=Mastering Windows 2000 Professional//-->
<!--AUTHOR=Mark Minasi//-->
<!--AUTHOR=Todd Phillips//-->
<!--PUBLISHER=SYBEX//-->
<!--CHAPTER=29//-->
<!--PAGES=917-920//-->
<!--UNASSIGNED1//-->
<!--UNASSIGNED2//-->

<center>
<table border>
<tr>
<td><a href="914-917.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="920-923.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<p><br></P>
<p>By default, all these options are checked. To deselect them, use the up and down arrows and then press Enter. When you&#146;ve finished, select Continue (perform selected tasks). After this screen, you&#146;ll be prompted to either provide the ERD or to press L if you don&#146;t have one. If you started Setup from floppy disks, press Enter to detect your adapters, and you will be asked to insert Setup Disk 3 to load various device drivers. When that&#146;s done, you&#146;ll be prompted to insert the ERD. You&#146;ll see messages along the status bar at the bottom of the screen telling you that Setup is checking and then examining drive C (or whatever your system drive is). You&#146;ll see a screen saying Setup has completed repairs. Press Enter to restart your computer.
</P>
<p>What if you didn&#146;t create an ERD? (Shame on you.) Windows 2000 creates a <tt>Repair</TT> subdirectory in the <tt>Winnt</TT> directory; you can simply refer the Repair program to that directory, and it will get the same information it would get from the ERD.</P>
<blockquote>
<p><font size="-1"><hr><b>NOTE:&nbsp;&nbsp;</B>Some of the most painful support calls that Microsoft receives on NT Workstation involve people who understand emergency repair but who used an ERD that was made six months before when they installed NT. The poor Microsoft support engineer then gets to explain that doing so erased all the user and application data they added since installing NT. This is usually followed by the question: &#147;How good are your backups?&#148;<hr></FONT>
</BLOCKQUOTE>
<p>The ERD contains a Registry based on your initial setup. The only users in the Registry are the Administrator and the Guest. None of the permissions that you&#146;ve established are on the ERD. You can, however, update your ERD (or create a completely new disk) with the Windows 2000 Backup program in the System Tools group. Figure 29.1 shows the opening window of the Backup program.
</P>
<p><a name="Fig1"></A><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/0782124488/ch29/images/29-01.jpg',642,479)"><img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/reference/pro/0782124488/ch29/images/29-01t.jpg"></A>
<br><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/0782124488/ch29/images/29-01.jpg',642,479)"><font color="#000077"><b>Figure 29.1</B></FONT></A>&nbsp;&nbsp;Windows 2000 Backup uses wizards to help create backup or restore jobs, and to create an Emergency Repair Disk.</P>
<p>Simply run it and follow the instructions. By default, however, it will not update the entire ERD (and Repair directory)&#151;it doesn&#146;t update the SECURITY and SAM hives. If you want to back up all of the Registry, run the Emergency Repair Diskette wizard and check the box to also back up the Registry as shown in Figure 29.2.
</P>
<p><a name="Fig2"></A><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/0782124488/ch29/images/29-02.jpg',341,184)"><img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/reference/pro/0782124488/ch29/images/29-02t.jpg"></A>
<br><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/0782124488/ch29/images/29-02.jpg',341,184)"><font color="#000077"><b>Figure 29.2</B></FONT></A>&nbsp;&nbsp;The Emergency Repair Diskette option in Backup lets you easily back up the entire Registry.</P>
<h4 align="LEFT"><a name="Heading13"></A><font color="#000077">Recovering from Bad Video Drivers</FONT></H4>
<p>You may recall from the earlier discussion of the Last Known Good configuration that if you change the video drivers to something that your system can&#146;t handle and then reboot and log on with the bad drivers (you can still type a password even if the screen is messed up), the Last Known Good solution can no longer help you. You have, after all, successfully rebooted and logged on to the system; the fact that you can&#146;t <i>see</I> anything is immaterial.</P>
<p>Under NT 3.1, this was something of a rigmarole. But NT 4 built into <tt>boot.ini</TT> the option NT Workstation 4.0 (VGA Drivers). All you had to do was shut down the PC, restart it, and choose the setup with VGA drivers. Then, after you got the system back up, you would have simply selected Display from the Control Panel and then you could have taken a second shot at choosing a video driver. Even better, Control Panel included a Test button that NT forced you to use <i>before</I> you committed yourself to whether the video drivers work.</P>
<p>Windows 2000 takes this safety net a bit further. When you change a video driver in Windows 2000, you are forced to test the new driver for 15 seconds before the change will be made permanent. The system will apply the change and try the new configuration for 15 seconds. During this time, you are prompted to decide whether you want to keep this new setting. If you answer no, or let the timer expire, the system reverts back to its previous setting with no harm done. If you select Yes, the setting is made permanent. The really nice part is that you won&#146;t even have to reboot the computer to make the change!</P>
<h4 align="LEFT"><a name="Heading14"></A><font color="#000077">Backing Up the Registry (and the SAM)</FONT></H4>
<p>You&#146;ll recall that backing up open files is a bit of a pain, even impossible sometimes. Few files on an NT machine are more important than the Registry hives. Registry hives are the files named SAM, SECURITY, SOFTWARE, and SYSTEM, all of which live in <tt>\Winnt\System32\Config</TT>.</P>
<p><font size="+1"><b>Finding Alternatives for Backing Up the Registry</B></FONT></P>
<p>Unfortunately, the Registry hives are constantly open. You can&#146;t back them up with a simple <tt>copy</TT> or <tt>xcopy</TT> command, but there are several tools that you can use.</P>
<p>First, there&#146;s Windows 2000 Backup (<tt>ntbackup)</TT>. You&#146;ll recall that there is a check box or a command line option (<tt>/SystemState</TT>) that instructs <tt>ntbackup</TT> to back up the Registry and other configuration information vital to the operating system. You can restore it using <tt>ntbackup</TT> as well.</P>
<p>The Resource Kit includes two programs&#151;<tt>regback</TT> and <tt>regrest</TT>&#151;that will back up and restore the Registry to a floppy.</P>
<p>As we said, the ERD contains a copy of the Registry as it looked when you first installed your PC. If you run Windows 2000 Setup and choose the Repair option, you can restore the Registry to its state on the ERD.</P>
<p>That may not sound like an especially attractive option because a lot of water has no doubt gone under the bridge between the time that you installed the PC and now, but it <i>is</I> one way to restore a damaged Registry to a &#147;known good&#148; state. Of course, it would be more desirable to simply keep the copy of the Registry on the ERD up-to-date&#151;and you can.</P>
<p>Windows 2000 Backup gives you the ability to easily create an ERD, we&#146;ve mentioned that before, but it also gives you a way to backup the <i>entire</I> Registry to the <tt>Winnt\Repair</TT> folder on the hard drive. When you open Backup, you&#146;ll be presented with three options for wizards to help you save or restore your system configuration. The third one is to create an ERD. Click that button, and you will be prompted to insert a formatted floppy into drive A. You will also be asked if you want to backup all of the Registry to the Repair folder. Check the box beside this option and click the OK button to proceed. You now have a copy of the Registry, including all account information, stored safely on your hard disk where there is plenty of room.</P><p><br></P>
<center>
<table border>
<tr>
<td><a href="914-917.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="920-923.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>


</font></BODY></HTML>