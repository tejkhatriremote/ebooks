<html>
<head>
<meta name=vsisbn content="0782124488">
<meta name=vstitle content="Mastering Windows 2000 Professional">
<meta name=vsauthor content="Mark Minasi, Todd Phillips">
<meta name=vspublisher content="Sybex, Inc.">
<meta name=vspubdate content="01/01/00">
<meta name=vscategory content="Operations Systems: Windows 2000">



<title>Mastering Windows 2000 Professional:Fixing Windows 2000 Professional When It Breaks</TITLE>
<!-- BEGIN HEADER -->
<meta name="ROBOTS" content="NOINDEX, NOFOLLOW">
<script>
<!--
function displayWindow(url, width, height) {
        var Win = window.open(url,"displayWindow",'width=' + width +
',height=' + height + ',resizable=1,scrollbars=yes');
}
//--></SCRIPT>

<!-- HEADER -->
<style type="text/css">
<!--
A:hover { color:red }
-->
</STYLE>

<!-- HEADER -->
<style type="text/css"> 
 <!--
 A:hover  {
 	color : Red;
 }
 -->
 </STYLE>

<script language="JavaScript1.2">
<!--
function checkForQuery(fm) {
  /* get the query value */
  var i = escape(fm.query.value);
  if (i == "") {
      alert('Please enter a search word or phrase');
      return false;
  }                  /* query is blank, dont run the .jsp file */
  else return true;  /* execute the .jsp file */
}
//--></script>

</HEAD>
<BODY bgcolor=#FFFFFF><FONT size=2 face="Arial, verdana, helvetica"><table width=100% border=0 cellspacing=0 cellpadding=2><tr bgcolor=#000000><td width=100% align=right><b><font color=#FFFFFF>Gotcha</font></b></td></tr></table><br><!--Begin Content Column -->

<table border=0 cellspacing=0 cellpadding=0>
<tr>
<td width=75 valign=top>
<img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/images/sm_covers/0782124488.gif" width=60 height=73 alt="Mastering Windows 2000 Professional" border="1">
</td>
<td align="left">
    <font face="arial, helvetica" size="-1" color="#336633"><b>Mastering Windows 2000 Professional</b></font>
    <br>
    <font face="arial, helvetica" size="-1"><i>by Mark Minasi, Todd Phillips</i>
    <br>
    Sybex, Inc.
    <br>
    <b>ISBN:</b>&nbsp;0782124488<b>&nbsp;&nbsp;&nbsp;Pub Date:</b>&nbsp;01/01/00</font>
</td>
</tr>
</table>
<p>
<!-- Empty Reference Subhead-->

<!--ISBN=0782124488//-->
<!--TITLE=Mastering Windows 2000 Professional//-->
<!--AUTHOR=Mark Minasi//-->
<!--AUTHOR=Todd Phillips//-->
<!--PUBLISHER=SYBEX//-->
<!--CHAPTER=29//-->
<!--PAGES=930-933//-->
<!--UNASSIGNED1//-->
<!--UNASSIGNED2//-->

<center>
<table border>
<tr>
<td><a href="928-930.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="933-936.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<p><br></P>
<h4 align="LEFT"><a name="Heading25"></A><font color="#000077">Setting Up Your Machine for Kernel Debugging</FONT></H4>
<p>If you favor the Kernel Debugger over the dump analysis utilities, you&#146;ll need to set up two computers: the one on which the error occurred and another with a working version of Windows 2000. The only other additional equipment needed is a modem or a null-modem cable. And before you start debugging, you need to do the following:
</P>
<dl>
<dd><b>1.</B>&nbsp;&nbsp;Set up the modem connection.
<dd><b>2.</B>&nbsp;&nbsp;Set up the target computer (the one with the error).
<dd><b>3.</B>&nbsp;&nbsp;Set up a symbol tree on the host computer.
<dd><b>4.</B>&nbsp;&nbsp;Set up the debugger program on the host computer.
<dd><b>5.</B>&nbsp;&nbsp;Start the debugger program on the host computer.
</DL>
<p><font size="+1"><b>Connecting the Modem</B></FONT></P>
<p>You need a connection between the host and the target computers if you want to do either remote or local debugging.
</P>
<p><b>Remote Debugging</B>&nbsp;&nbsp;You need to use a modem for remote debugging. Which communications port you use (either COM1 or COM2) depends on how the two computers are configured. The default configuration for the target computer depends on which platform the computer uses. The COM port on the host computer is set up as an environment variable. Your modem&#146;s documentation should provide information on the signals.</P>
<p>Connect the modem on the host first. (See the &#147;Setting Up the Debugger on the Host System&#148; section for how to connect the modem to the target computer.) To set the modem on the target computer, you need to</P>
<dl>
<dd><b>1.</B>&nbsp;&nbsp;Connect the modem to one of the target computer&#146;s communications ports.
<dd><b>2.</B>&nbsp;&nbsp;Turn on auto-answer.
<dd><b>3.</B>&nbsp;&nbsp;Turn off flow control, hardware compression, and error detection.
</DL>
<p><b>Local Debugging</B>&nbsp;&nbsp;To connect the target and the host computers, you need a null-modem serial cable. The procedure for setting up the cable is the same on both computers. However, there&#146;s one caveat: You must start the host computer before you can restart the target computer. Don&#146;t worry. Nothing bad will happen if you don&#146;t do this&#151;you&#146;ll just have to restart the debugger on the host computer.</P>
<p>The cable can be plugged into different ports on either computer&#151;for example, the cable can be connected to COM1 on the host computer and COM2 on the target computer. Just be sure to make a note about to which ports the cable is connected.</P>
<p><font size="+1"><b>Setting Up the Target Computer for Debugging</B></FONT></P>
<p>Usually, your computer runs in normal mode, which is the default when you install Windows 2000 Professional. When a Kernel STOP Error occurs, the debugger is not enabled. To enable debug mode, you have to edit the start-up file and set some variables.
</P>
<p>The start-up file for <i>x</I>86-based systems is <tt>boot.ini</TT>. You need to edit the file with a text editor and include either of two switches: <tt>/debug</TT> or <tt>/crashdebug</TT>. On a RISC-based computer, you edit the firmware environment variable <tt>osloadoptions</TT> to include <tt>debug</TT> or <tt>crashdebug</TT>.</P>
<p>When you use <tt>crashdebug</TT> on either system, the debugger remains inactive until a Kernel STOP Error occurs. This mode is useful if errors occur randomly. If you&#146;re using <tt>debug</TT>, the debugger can be activated at any time by a host computer connected to the target computer. This is typically used when errors continue to occur.</P>
<p>Other options that can be added to the start-up file are the communications port and baud rate. The defaults for these options can vary from computer to computer, so you may want to add these just in case.</P>
<p>Of course, you should always create a backup of your start-up file to be safe. After you&#146;ve finished debugging, you should then return the start-up file to its original state.</P>
<p><b>Setting Up an <i>x</I>86-Based Computer for Debugging</B>&nbsp;&nbsp;The default communications port for each computer varies. Some are set to COM1, and others are set to COM2. The default baud rate is 9600 if you&#146;re using a modem and 19,200 if you&#146;re using a null-modem serial cable. You shouldn&#146;t normally have to worry about setting these rates&#151;they&#146;re set at the fastest reliable speeds already.</P>
<p>After your modem or serial cable is connected, you&#146;ll need to perform the following steps:</P>
<dl>
<dd><b>1.</B>&nbsp;&nbsp;If a Kernel STOP Error occurs every time you boot the target computer, you can boot MS-DOS from a boot floppy and use the <tt>edit</TT> command to edit <tt>boot.ini</TT>.
<dd><b>2.</B>&nbsp;&nbsp;If the boot partition is NTFS, you&#146;ll have to install Windows 2000 in a different folder and boot from that folder because the host computer will not be able to access files on an NTFS partition from MS-DOS.
<dd><b>3.</B>&nbsp;&nbsp;Turn off the read-only attribute of <tt>boot.ini</TT> by choosing Properties from the File menu in Windows 2000 Explorer. The file is usually in the root directory on the partition from which <tt>ntldr</TT> is loaded, which is usually drive C.
<dd><b>4.</B>&nbsp;&nbsp;Use a text editor such as Notepad to edit <tt>boot.ini</TT>. The file will look something like the following example:
<!-- CODE SNIP //-->
<pre>
   [boot loader]
   timeout=30
   default=multi(0)disk(0)rdisk(0)partition(1)\winnt
   [operating systems]
   multi(0)disk(0)rdisk(0)partition(1)\winnt="Microsoft Windows 2000
       Professional" /fastdetect

   C:\="MS-DOS"
</PRE>
<!-- END CODE SNIP //-->
<dd><b>5.</B>&nbsp;&nbsp;Add either <tt>/debug</TT> or <tt>/crashdebug</TT> to the end of the line containing the start-up option that you normally use.
<blockquote>
<p><font size="-1"><hr><b>NOTE:&nbsp;&nbsp;</B>The options being added to the start-up path must all be on one line. Do not place a return anywhere on the line.<hr></FONT>
</BLOCKQUOTE>
<dd><b>6.</B>&nbsp;&nbsp;To specify the communications port, add the switch <tt>/debugport=comx</TT>, where <tt>x</TT> is the communications port that you want to use.
<dd><b>7.</B>&nbsp;&nbsp;To specify the baud rate, add the switch <tt>/baudrate=&lt;baudrate&gt;.</TT>
<p>Here is an example of a line setting the communications port and baud rate:
<!-- CODE SNIP //-->
<pre>
   multi(0)disk(0)rdisk(0)partition(1)\winnt="Microsoft Windows 2000
       Professional" /debugport=com1 /baudrate=19200
</PRE>
<!-- END CODE SNIP //-->
</P>
<dd><b>8.</B>&nbsp;&nbsp;Save the file and quit the text editor or the MS-DOS editor. If you&#146;re using a text editor, be sure to use the Save As option and <i>specifically</I> name the file <tt>boot.ini</TT>. Otherwise, the file will automatically become a <tt>.txt</TT> file.
<dd><b>9.</B>&nbsp;&nbsp;Restart the computer and run Windows 2000 Professional.
</DL>
<p><br></P>
<center>
<table border>
<tr>
<td><a href="928-930.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="933-936.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>


</font></BODY></HTML>