<html>
<head>
<meta name=vsisbn content="0782124488">
<meta name=vstitle content="Mastering Windows 2000 Professional">
<meta name=vsauthor content="Mark Minasi, Todd Phillips">
<meta name=vspublisher content="Sybex, Inc.">
<meta name=vspubdate content="01/01/00">
<meta name=vscategory content="Operations Systems: Windows 2000">



<title>Mastering Windows 2000 Professional:Fixing Windows 2000 Professional When It Breaks</TITLE>
<!-- BEGIN HEADER -->
<meta name="ROBOTS" content="NOINDEX, NOFOLLOW">
<script>
<!--
function displayWindow(url, width, height) {
        var Win = window.open(url,"displayWindow",'width=' + width +
',height=' + height + ',resizable=1,scrollbars=yes');
}
//--></SCRIPT>

<!-- HEADER -->
<style type="text/css">
<!--
A:hover { color:red }
-->
</STYLE>

<!-- HEADER -->
<style type="text/css"> 
 <!--
 A:hover  {
 	color : Red;
 }
 -->
 </STYLE>

<script language="JavaScript1.2">
<!--
function checkForQuery(fm) {
  /* get the query value */
  var i = escape(fm.query.value);
  if (i == "") {
      alert('Please enter a search word or phrase');
      return false;
  }                  /* query is blank, dont run the .jsp file */
  else return true;  /* execute the .jsp file */
}
//--></script>

</HEAD>
<BODY bgcolor=#FFFFFF><FONT size=2 face="Arial, verdana, helvetica"><table width=100% border=0 cellspacing=0 cellpadding=2><tr bgcolor=#000000><td width=100% align=right><b><font color=#FFFFFF>Gotcha</font></b></td></tr></table><br><!--Begin Content Column -->

<table border=0 cellspacing=0 cellpadding=0>
<tr>
<td width=75 valign=top>
<img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/images/sm_covers/0782124488.gif" width=60 height=73 alt="Mastering Windows 2000 Professional" border="1">
</td>
<td align="left">
    <font face="arial, helvetica" size="-1" color="#336633"><b>Mastering Windows 2000 Professional</b></font>
    <br>
    <font face="arial, helvetica" size="-1"><i>by Mark Minasi, Todd Phillips</i>
    <br>
    Sybex, Inc.
    <br>
    <b>ISBN:</b>&nbsp;0782124488<b>&nbsp;&nbsp;&nbsp;Pub Date:</b>&nbsp;01/01/00</font>
</td>
</tr>
</table>
<p>
<!-- Empty Reference Subhead-->

<!--ISBN=0782124488//-->
<!--TITLE=Mastering Windows 2000 Professional//-->
<!--AUTHOR=Mark Minasi//-->
<!--AUTHOR=Todd Phillips//-->
<!--PUBLISHER=SYBEX//-->
<!--CHAPTER=29//-->
<!--PAGES=936-940//-->
<!--UNASSIGNED1//-->
<!--UNASSIGNED2//-->

<center>
<table border>
<tr>
<td><a href="933-936.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="941-944.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<p><br></P>
<p><font size="+1"><b>Starting the Debugger Using the <i>remote</I> Utility
</B></FONT></P>
<p>If the host and target computers are on a network and are not easily accessible to each other, you may want to use the <tt>remote</TT> utility. The command line for starting the debugger from the host is as follows:</P>
<!-- CODE SNIP //-->
<pre>
   <b>remote <i>/s</I> "<i>command</I>" Unique_ID</B>
</PRE>
<!-- END CODE SNIP //-->
<p>For instance, if you were debugging an <i>x</I>86-based computer and wanted the results displayed in verbose mode, type</P>
<!-- CODE SNIP //-->
<pre>
   <b>remote /s "i386kd -v" debug</B>
</PRE>
<!-- END CODE SNIP //-->
<p>We used the word <i>debug</I> as the unique ID, but you can use anything you like. When you&#146;re ready to end your session, type <b>&#64;K</B> to return to the command prompt.</P>
<p>You can also interact with the host computer from a workstation that is not connected to the session. To connect to the session, type</P>
<!-- CODE SNIP //-->
<pre>
   <b>remote /c ComputerName Unique_ID</B>
</PRE>
<!-- END CODE SNIP //-->
<p>where <i>ComputerName</I> is the name of the host computer. For example, if a debugging session was started on the host computer WS1 by using the <tt>remote/s</TT> command, you could connect to it by typing:</P>
<!-- CODE SNIP //-->
<pre>
   <b>remote /c WS1 debug</B>
</PRE>
<!-- END CODE SNIP //-->
<blockquote>
<p><font size="-1"><hr><b>NOTE:&nbsp;&nbsp;</B>You can&#146;t access a debugging session started on another computer unless the host computer started the session with the <tt>remote/s</TT> command.<hr></FONT>
</BLOCKQUOTE>
<h4 align="LEFT"><a name="Heading29"></A><font color="#000077">Using Debugger Commands</FONT></H4>
<p>Several commands are available that enable you to do the following:
</P>
<dl>
<dd><b>&#149;</B>&nbsp;&nbsp;Load symbols from the symbol tree
<dd><b>&#149;</B>&nbsp;&nbsp;Create a log file
<dd><b>&#149;</B>&nbsp;&nbsp;View device drivers on your system
<dd><b>&#149;</B>&nbsp;&nbsp;Display all locks held on resources
<dd><b>&#149;</B>&nbsp;&nbsp;Obtain a description of memory usage
<dd><b>&#149;</B>&nbsp;&nbsp;Display virtual memory usage
<dd><b>&#149;</B>&nbsp;&nbsp;View the Kernel error log
<dd><b>&#149;</B>&nbsp;&nbsp;Display a list of pending Interrupt Request Packets (IRPs)
<dd><b>&#149;</B>&nbsp;&nbsp;List all processes and threads
<dd><b>&#149;</B>&nbsp;&nbsp;List currently active processes and threads
</DL>
<p>Tables 29.5 and 29.6 list the commands available to you.
</P>
<table width="100%"><caption align=LEFT><b>Table 29.5</B> Kernel Debugger Commands
<tr>
<th width="40%" align="LEFT">Command
<th width="15%" align="LEFT">Flag (If Needed)
<th width="45%" align="LEFT">Description
<tr>
<td colspan="3"><hr>
<tr>
<td><tt>!bugdump</TT>
<td>
<td>Displays bug checkdump data
<tr>
<td><tt>!calldata &lt;table name&gt;</TT>
<td>
<td>Dumps call data hash table
<tr>
<td><tt>!db &lt;physical address&gt;</TT>
<td>
<td>Displays physical memory
<tr>
<td><tt>!dd &lt;physical address&gt;</TT>
<td>
<td>Displays physical memory
<tr>
<td valign="TOP"><tt>!devobj &lt;device address&gt;</TT>
<td>
<td>Dumps the device object and IRP queue
<tr>
<td valign="TOP"><tt>!drvobj &lt;driver address&gt;</TT>
<td>
<td>Dumps the driver object and related information
<tr>
<td valign="TOP"><tt>!drivers</TT>
<td>
<td>Displays information about all loaded system modules
<tr>
<td><tt>!eb &lt;physical address&gt;</TT>
<td>
<td>Modifies physical memory
<tr>
<td><tt>&lt;byte, byte ,...&gt;</TT>
<td>
<td>
<tr>
<td><tt>!ed &lt;physical address&gt;</TT>
<td>
<td>Modifies physical memory
<tr>
<td><tt>&lt;dword,dword,&#133;&gt;</TT>
<td>
<td>
<tr>
<td><tt>!errlog</TT>
<td>
<td>Dumps the error log contents
<tr>
<td valign="TOP"><tt>!exr &lt;address&gt;</TT>
<td>
<td>Dumps exception record at specified address
<tr>
<td valign="TOP"><tt>!filecache</TT>
<td>
<td>Dumps information about the file system cache
<tr>
<td><tt>!frag [flags]</TT>
<td>
<td>Lists Kernel mode pool fragmentation
<tr>
<td>
<td>1
<td>Lists all fragment information
<tr>
<td>
<td>2
<td>Lists allocation information
<tr>
<td>
<td valign="TOP">3
<td>Lists all fragment and allocation information
<tr>
<td><tt>!handle &lt;addr&gt; &lt;flags&gt;</TT>
<td>
<td>Dumps handle for a process
<tr>
<td><tt>&lt;process&gt; &lt;TypeName&gt;</TT>
<td>
<td>
<tr>
<td>
<td>2
<td>Dumps nonpaged object
<tr>
<td><tt>!heap &lt;addr&gt; [flags]</TT>
<td>
<td>Dumps heap for a process
<tr>
<td>
<td>-v
<td>Verbose
<tr>
<td>
<td>-f
<td>Free List entries
<tr>
<td>
<td>-a
<td>All entries
<tr>
<td>
<td>-s
<td>Summary
<tr>
<td>
<td>-x
<td>Forces a dump even if the data is bad
<tr>
<td>
<td>0
<td>Dumps all heaps.
<tr>
<td><tt>!help</TT>
<td>
<td>Displays this table.
<tr>
<td><tt>!ib &lt;port&gt;</TT>
<td>
<td>Reads a byte from an I/O port.
<tr>
<td><tt>!id &lt;port&gt;</TT>
<td>
<td>Reads a double-word from an I/O port.
<tr>
<td><tt>!iw &lt;port&gt;</TT>
<td>
<td>Reads a word from an I/O port.
<tr>
<td><tt>!irp &lt;address&gt;</TT>
<td>
<td>Dumps IRP at specified address.
<tr>
<td valign="TOP"><tt>!irpzone</TT>
<td>
<td>Walks the IRP zones looking for active IRPs.
<tr>
<td><tt>!locks [-v]</TT> <tt>&lt;address&gt;</TT>
<td>
<td>Dumps Kernel mode resource locks.
<tr>
<td><tt>!lpc</TT>
<td>
<td>Dumps lpc ports and messages.
<tr>
<td><tt>!memusage</TT>
<td>
<td>Dumps the page frame database table.
<tr>
<td><tt>!ob &lt;port&gt;</TT>
<td>
<td>Writes a byte to an I/O port.
<tr>
<td valign="TOP"><tt>!obja &lt;TypeName&gt;</TT>
<td>
<td>Dumps an Object Manager object&#146;s attributes.
<tr>
<td><tt>!object &lt;TypeName&gt;
<td>
<td>Dumps an Object Manager object.</TT>
<tr>
<td><tt>!od &lt;port&gt;</TT>
<td>
<td>Writes a double-word to an I/O port.
<tr>
<td><tt>!ow &lt;port&gt;</TT>
<td>
<td>Writes a word to an I/O port.
<tr>
<td valign="TOP"><tt>!pfn</TT>
<td>
<td>Dumps the page frame database entry for the physical page.
<tr>
<td><tt>!pool &lt;address&gt; [detail]</TT>
<td>
<td>Dumps Kernel mode heap.
<tr>
<td>
<td>0 or blank
<td valign="TOP">Dumps only the process heap.
<tr>
<td>
<td>1
<td>Dumps all heaps in the process.
<tr>
<td><tt>!pool &lt;address&gt; [detail]</TT>
<td>0
<td>Summary information.
<tr>
<td>
<td>1
<td>Above &#43; location/size of regions.
<tr>
<td>
<td valign="TOP">3
<td>Above &#43; allocated/free blocks in committed regions.
<tr>
<td>
<td>4
<td>Above &#43; free lists.
<tr>
<td><tt>!poolfind Tag [pooltype]</TT>
<td>
<td>Finds occurrences of the specified Tag.
<tr>
<td>
<td>
<td><i>Tag</I> is a 4-character tag; * and ? are wild cards.
<tr>
<td>
<td>
<td><i>Pooltype</I> is 0 for nonpaged (default), and 1 for paged. Note: This can take a long time!
<tr>
<td><tt>!poolused [flags]</TT>
<td>
<td>Dumps usage by pool tag
<tr>
<td>
<td>1
<td>Verbose
<tr>
<td>
<td>2
<td>Sorts by nonpaged pool usage
<tr>
<td>
<td>4
<td>Sorts by paged pool usage
<tr>
<td><tt>!process [flags]</TT>
<td>
<td>Dumps process at specified address
<tr>
<td><tt>!processfields</TT>
<td>
<td>Shows offsets to all fields in a process
<tr>
<td valign="TOP"><tt>!ptov Physical Page Number</TT>
<td>
<td>Dumps all valid physical and virtual mappings for the given page directory
<tr>
<td valign="TOP"><tt>!ready</TT>
<td>
<td>Dumps state of all READY system threads
<tr>
<td><tt>!regkcb</TT>
<td>
<td>Dumps Registry key-control blocks
<tr>
<td><tt>!regpool [s|r]</TT>
<td>
<td>Dumps Registry allocated paged pool
<tr>
<td>
<td valign="TOP">s
<td>Saves list of Registry pages to temporary file
<tr>
<td valign="TOP"><tt>!regpool [s|r]</TT>
<td valign="TOP">r
<td>Restores list of Registry pages from temporary file
<tr>
<td><tt>!reload</TT>
<td>
<td>Loads the symbol files
<tr>
<td><tt>!srb &lt;address&gt;</TT>
<td>
<td>Dumps Srb at specified address
<tr>
<td><tt>!sympath</TT>
<td>
<td>Displays the current symbol path
<tr>
<td><tt>!sysptes</TT>
<td>
<td>Dumps the system PTEs
<tr>
<td><tt>!thread [flags]</TT>
<td>
<td>Dumps thread at specified address
<tr>
<td><tt>!threadfields</TT>
<td>
<td>Shows offsets to all fields in a thread
<tr>
<td valign="TOP"><tt>!time</TT>
<td>
<td>Reports PerformanceCounterRate and <tt>TimerDifference</TT>
<tr>
<td><tt>!timer</TT>
<td>
<td>Dumps timer tree
<tr>
<td><tt>!token [flags]</TT>
<td>
<td>Dumps token at specified address
<tr>
<td><tt>!tokenfields</TT>
<td>
<td>Shows offsets to all fields in a token
<tr>
<td><tt>!trap &lt;address&gt;</TT>
<td>
<td>Dumps a trap frame
<tr>
<td><tt>!vad</TT>
<td>
<td>Dumps VADs
<tr>
<td><tt>!version</TT>
<td>
<td>Version of extension <tt>.dll</TT>
<tr>
<td><tt>!vm</TT>
<td>
<td>Dumps virtual management values
<tr>
<td colspan="3"><hr>
</TABLE>
<p>
</P>
<table width="100%"><caption align=LEFT><b>Table 29.6</B> Kernel Debugger Commands Specific to <i>x</I>86 Machines
<tr>
<th width="30%" align="LEFT">Command
<th width="70%" align="LEFT">Description
<tr>
<td colspan="2"><hr>
<tr>
<td><tt>!apic [base]</TT>
<td>Dumps local apic
<tr>
<td><tt>!cxr</TT>
<td>Dumps context record at specified address
<tr>
<td><tt>!ioapic [base]</TT>
<td>Dumps io apic
<tr>
<td><tt>!mtrr</TT>
<td>Dumps MTTR
<tr>
<td><tt>!npx [base]</TT>
<td>Dumps NPX save area
<tr>
<td><tt>!pcr</TT>
<td>Dumps the PCR
<tr>
<td valign="TOP"><tt>!pte</TT>
<td>Dumps the corresponding PDE and PTE for the entered address
<tr>
<td><tt>!sel [selector]</TT>
<td>Examines selector values
<tr>
<td><tt>!trap [base]</TT>
<td>Dumps trap frame
<tr>
<td><tt>!tss [register]</TT>
<td>DumpsTSS
<tr>
<td colspan="2"><hr>
</TABLE>
<p><br></P>
<center>
<table border>
<tr>
<td><a href="933-936.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="941-944.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>


</font></BODY></HTML>