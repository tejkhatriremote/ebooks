<html>
<head>
<meta name=vsisbn content="0782124488">
<meta name=vstitle content="Mastering Windows 2000 Professional">
<meta name=vsauthor content="Mark Minasi, Todd Phillips">
<meta name=vspublisher content="Sybex, Inc.">
<meta name=vspubdate content="01/01/00">
<meta name=vscategory content="Operations Systems: Windows 2000">



<title>Mastering Windows 2000 Professional:Advanced Troubleshooting Methodology</TITLE>
<!-- BEGIN HEADER -->
<meta name="ROBOTS" content="NOINDEX, NOFOLLOW">
<script>
<!--
function displayWindow(url, width, height) {
        var Win = window.open(url,"displayWindow",'width=' + width +
',height=' + height + ',resizable=1,scrollbars=yes');
}
//--></SCRIPT>

<!-- HEADER -->
<style type="text/css">
<!--
A:hover { color:red }
-->
</STYLE>

<!-- HEADER -->
<style type="text/css"> 
 <!--
 A:hover  {
 	color : Red;
 }
 -->
 </STYLE>

<script language="JavaScript1.2">
<!--
function checkForQuery(fm) {
  /* get the query value */
  var i = escape(fm.query.value);
  if (i == "") {
      alert('Please enter a search word or phrase');
      return false;
  }                  /* query is blank, dont run the .jsp file */
  else return true;  /* execute the .jsp file */
}
//--></script>

</HEAD>
<BODY bgcolor=#FFFFFF><FONT size=2 face="Arial, verdana, helvetica"><table width=100% border=0 cellspacing=0 cellpadding=2><tr bgcolor=#000000><td width=100% align=right><b><font color=#FFFFFF>Gotcha</font></b></td></tr></table><br><!--Begin Content Column -->

<table border=0 cellspacing=0 cellpadding=0>
<tr>
<td width=75 valign=top>
<img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/images/sm_covers/0782124488.gif" width=60 height=73 alt="Mastering Windows 2000 Professional" border="1">
</td>
<td align="left">
    <font face="arial, helvetica" size="-1" color="#336633"><b>Mastering Windows 2000 Professional</b></font>
    <br>
    <font face="arial, helvetica" size="-1"><i>by Mark Minasi, Todd Phillips</i>
    <br>
    Sybex, Inc.
    <br>
    <b>ISBN:</b>&nbsp;0782124488<b>&nbsp;&nbsp;&nbsp;Pub Date:</b>&nbsp;01/01/00</font>
</td>
</tr>
</table>
<p>
<!-- Empty Reference Subhead-->

<!--ISBN=0782124488//-->
<!--TITLE=Mastering Windows 2000 Professional//-->
<!--AUTHOR=Mark Minasi//-->
<!--AUTHOR=Todd Phillips//-->
<!--PUBLISHER=SYBEX//-->
<!--CHAPTER=32//-->
<!--PAGES=10461048//-->
<!--UNASSIGNED1//-->
<!--UNASSIGNED2//-->

<center>
<table border>
<tr>
<td><a href="1044-1046.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="1048-1051.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<p><br></P>
<p>It is possible to repair the MBR if you have a bootable floppy that you know is clean of any virus infection. (That&#146;s the hard part in getting rid of a virus). An emergency boot disk from Windows 9<i>x</I> is especially helpful for this because you need <tt>fdisk.exe</TT>. After booting the infected computer with the boot floppy, (you did write-protect the floppy, didn&#146;t you?), run <tt>mem.exe</TT> at the command prompt. The total bytes of memory (before anything is subtracted) should equal 640K. Next, run <tt>chkdsk.exe</TT> and look at the line for Total Bytes Memory (it&#146;s near the bottom), which should read 655,360. If either amount of memory is off, and especially if only <i>one</I> of them is off, you probably have a boot-sector virus loaded in memory. If both of these programs correctly report the amount of conventional memory, you can be reasonably certain that the virus is not in memory. If that&#146;s the case, you can type <tt>FDISK/MBR</TT> at the command prompt to rebuild the MBR. This command won&#146;t do anything else, provided the virus is not in memory. If the virus is in memory, this command may be fatal to your data.</P>
<blockquote>
<p><font size="-1"><hr><b>WARNING:&nbsp;&nbsp;</B>The <tt>FDISK/MBR</TT> command is dangerous and should never be used without being absolutely positive that the boot-sector virus is not loaded in memory. <i>The result could be total data loss.</I> Most boot-sector viruses work by moving the MBR elsewhere on the disk, then replacing it with their own code. Anything that tries to scan the MBR is first infected by the virus, then redirected out to the real MBR in its new location.<hr></FONT>
</BLOCKQUOTE>
<blockquote>
<p><font size="-1"><hr><b>NOTE:&nbsp;&nbsp;</B>It&#146;s interesting to note that the Master Boot Record is operating-system independent. It&#146;s quite possible to rebuild the MBR for a Windows 2000 computer using an emergency boot disk from Windows 98.<hr></FONT>
</BLOCKQUOTE>
<p><font size="+1"><b>Miscellaneous Setup Issues</B></FONT></P>
<p>If your computer hangs during the final reboot of NT Setup, try removing the CD-ROM from the drive. Windows 2000 supports the &#147;El Torrito&#148; standard of bootable CD-ROMs using the No Emulation mode. If the BIOS of your computer supports bootable CD-ROMs but not the No Emulation mode, your system may hang. It may also give the error message below:
</P>
<!-- CODE SNIP //-->
<pre>
   BOOT: Couldn't find NTLDR
   Please insert another disk.
</PRE>
<!-- END CODE SNIP //-->
<p>This is fixed the same way. Just remove the CD-ROM from the drive and reboot the computer. Setup should continue normally after booting.
</P>
<h4 align="LEFT"><a name="Heading16"></A><font color="#000077">Addressing GUI Mode and Initial Boot Issues</FONT></H4>
<p>During this phase of Setup, Windows 2000 installs drivers and configures the system. Problems in this portion of Setup are typically fewer and generally related to configuration rather than failing hardware or drivers. This is also where Windows 2000 will try to load the network for the first time in a full configuration.
</P>
<p>It is possible to encounter video problems at this phase of Setup. On some computers the display will not reset correctly during a warm boot under Windows 2000. If this occurs, your display will be black or very distorted. Try turning off the power to the computer, (yes, this is one of those rare cases where you power down without shutting down first), then restarting it. If this resolves the issue, you will have to power down the computer every time you reboot. This is a hardware issue related to the video and system BIOS and not a Windows 2000 problem. If you&#146;ve tried this and the display is still distorted, then you will need to boot Windows 2000 with the VGA option and change your display properties (and possibly the driver) to one that does work with your hardware. Now let&#146;s apply this information to a common troubleshooting issue for Setup. In this scenario, you are again the support person installing Windows 2000 Professional, but this time the CD-ROM drive is not supported by Windows 2000.</P>
<p><font size="+1"><b>Scenario 4: Unsupported CD-ROM</B></FONT></P>
<p>You are installing Windows 2000 Professional on your computer. Your machine is running NT 3.51 and has a SCSI CD-ROM attached to a MediaVision Pro Audio Spectrum-16 sound card with built-in SCSI controller. This configuration was supported under your old version of NT Workstation so you begin Setup by running <tt>Winnt32/makelocalsource</TT> from the I386 folder on the CD-ROM. Setup copies all the files from the I386 folder to the hard drive and then reboots your computer.</P>
<p>Setup proceeds normally until you reach the GUI mode and need to install a network adapter driver ROM provided by the NIC&#146;s manufacturer from the CD. When you attempt to load the driver, you receive the following error message:</P>
<!-- CODE SNIP //-->
<pre>
   NONCRITICAL ERROR
   The external library procedure, CopySingleFile, reported the following
   error: Unable to do the specified file copy operation.
</PRE>
<!-- END CODE SNIP //-->
<p>If you choose to continue, the driver would not be installed correctly.
</P>
<p>You load the Windows 2000 Professional CD-ROM on another computer to look for the file that is missing and notice that it is located in the <tt>Drvlib</TT> folder, which contains third-party drivers. You also happen to notice that the driver for your Trantor MediaVision sound card is not supported in the Windows 2000 Setup program, but has instead been &#147;retired.&#148; Microsoft occasionally retires drivers for devices that are not very common although were once supported on NT. In these cases, they move the driver out of the installation folders into the <tt>Drvlib\Retired</TT> folders.</P>
<blockquote>
<p><font size="-1"><hr><b>NOTE:&nbsp;&nbsp;</B>In this particular case, the driver is not provided for Windows 2000. You will have to either acquire a new driver or replace the sound card with a newer, supported card.<hr></FONT>
</BLOCKQUOTE>
<p>Returning to the first computer, you complete the installation, ignoring the errors. When Setup has completed and the system has rebooted, you find that your CD-ROM is no longer available even though the sound card is installed. Why not?
</P>
<p>When you chose to perform the upgrade using the <tt>Winnt32 /makelocalsource</TT> command, all the files from the I386 folder were copied to your hard drive, but no files from <tt>Drvlib</TT> were copied. In addition, although you could find the options to install the drivers from <tt>Drvlib</TT>, you could no longer access that folder because the driver for the controller was never installed. This error occurs when you try to install optional drivers from the CD-ROM that are no longer accessible in Setup. It can be caused by either an unsupported CD-ROM drive (as in this scenario) or by a network install.</P><p><br></P>
<center>
<table border>
<tr>
<td><a href="1044-1046.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="1048-1051.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>


</font></BODY></HTML>