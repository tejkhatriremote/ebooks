<html>
<head>
<meta name=vsisbn content="0782124488">
<meta name=vstitle content="Mastering Windows 2000 Professional">
<meta name=vsauthor content="Mark Minasi, Todd Phillips">
<meta name=vspublisher content="Sybex, Inc.">
<meta name=vspubdate content="01/01/00">
<meta name=vscategory content="Operations Systems: Windows 2000">



<title>Mastering Windows 2000 Professional:Running Windows 3.x and DOS Programs</TITLE>
<!-- BEGIN HEADER -->
<meta name="ROBOTS" content="NOINDEX, NOFOLLOW">
<script>
<!--
function displayWindow(url, width, height) {
        var Win = window.open(url,"displayWindow",'width=' + width +
',height=' + height + ',resizable=1,scrollbars=yes');
}
//--></SCRIPT>

<!-- HEADER -->
<style type="text/css">
<!--
A:hover { color:red }
-->
</STYLE>

<!-- HEADER -->
<style type="text/css"> 
 <!--
 A:hover  {
 	color : Red;
 }
 -->
 </STYLE>

<script language="JavaScript1.2">
<!--
function checkForQuery(fm) {
  /* get the query value */
  var i = escape(fm.query.value);
  if (i == "") {
      alert('Please enter a search word or phrase');
      return false;
  }                  /* query is blank, dont run the .jsp file */
  else return true;  /* execute the .jsp file */
}
//--></script>

</HEAD>
<BODY bgcolor=#FFFFFF><FONT size=2 face="Arial, verdana, helvetica"><table width=100% border=0 cellspacing=0 cellpadding=2><tr bgcolor=#000000><td width=100% align=right><b><font color=#FFFFFF>Gotcha</font></b></td></tr></table><br><!--Begin Content Column -->

<table border=0 cellspacing=0 cellpadding=0>
<tr>
<td width=75 valign=top>
<img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/images/sm_covers/0782124488.gif" width=60 height=73 alt="Mastering Windows 2000 Professional" border="1">
</td>
<td align="left">
    <font face="arial, helvetica" size="-1" color="#336633"><b>Mastering Windows 2000 Professional</b></font>
    <br>
    <font face="arial, helvetica" size="-1"><i>by Mark Minasi, Todd Phillips</i>
    <br>
    Sybex, Inc.
    <br>
    <b>ISBN:</b>&nbsp;0782124488<b>&nbsp;&nbsp;&nbsp;Pub Date:</b>&nbsp;01/01/00</font>
</td>
</tr>
</table>
<p>
<!-- Empty Reference Subhead-->

<!--ISBN=0782124488//-->
<!--TITLE=Mastering Windows 2000 Professional//-->
<!--AUTHOR=Mark Minasi//-->
<!--AUTHOR=Todd Phillips//-->
<!--PUBLISHER=SYBEX//-->
<!--CHAPTER=28//-->
<!--PAGES=873-876//-->
<!--UNASSIGNED1//-->
<!--UNASSIGNED2//-->

<center>
<table border>
<tr>
<td><a href="../ch27/866-872.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="876-879.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<p><br></P>
<h2><a name="Heading1"></A><font color="#000077">Chapter 28<br>Running Windows 3.x and DOS Programs
</FONT></H2>
<dl>
<dt><b>Featuring:</B>
<dt>Understanding How Windows 2000 Supports Older Applications
<dt>Setting the Properties of DOS Apps
<dt>Managing DOS Memory under Windows 2000
<dt>Running DOS Diagnostic Programs
</DL>
<p><big><big>S</BIG></BIG>oon after the release of Windows NT, 32-bit applications began hitting the shelves. The problem is that you or your company has made a massive investment in existing DOS and Windows apps. Unless you&#146;re prepared to replace all your applications, you&#146;ll need to know how to keep those legacy applications up and running on Windows 2000.</P>
<p>Windows applications under Windows 2000 Professional require about the same fine-tuning as they did under Windows 3.<i>x</I>: not much. DOS applications, on the other hand, have special needs because they are in an alien environment. In this chapter, we talk about getting DOS and Windows apps to work under Windows 2000 Professional.</P>
<h3><a name="Heading2"></A><font color="#000077">Understanding How Windows 2000 Supports Older Applications</FONT></H3>
<p>Windows 2000 supports 32-bit applications natively. These applications are able to communicate with the Kernel of Windows 2000 Professional and access the full multitasking and multithreading capabilities of the operating system. Consequently, your programs will start taking advantage of these features to increase their performance.
</P>
<p>Except for one problem.</P>
<p>DOS and Windows 3.<i>x</I> applications aren&#146;t 32-bit programs. How are they supposed to use Windows 2000&#146;s 32-bit API for communicating with the system hardware?</P>
<p>The answer is that they don&#146;t. Windows 2000 comes with a 16-bit subsystem that tricks the applications into believing that they are running on a 16-bit machine. When you launch a 16-bit application, Windows 2000&#146;s first reaction is to say, &#147;Oh, here we go again.&#148; Windows 2000 pulls out the 16-bit subsystem (that it was holding onto for just such an occasion) and loads it into memory. Windows 2000 then loads the 16-bit application into the subsystem. Every time the 16-bit application makes an attempt to talk to the hardware, Windows 2000 intercepts the request. Next, Windows 2000 Professional finds its own 32-bit version of the request and makes the request of the hardware on behalf of the 16-bit application. Finally, Windows 2000 translates any response from the hardware request to a 16-bit response and passes it back to the 16-bit application. The goal of this entire interception and conversion routine is to be transparent to the 16-bit application.</P>
<blockquote>
<p><font size="-1"><hr><b>NOTE:&nbsp;&nbsp;</B>The Virtual DOS Machine that Windows 2000 uses to run 16-bit programs is actually a 32-bit process. It simulates a 16-bit environment to provide the 16-bit programs with what they need to operate normally.<hr></FONT>
</BLOCKQUOTE>
<p>The routine <i>is</I> transparent to the application, but often not transparent to the user. All of this smoke and mirrors has to take its toll somewhere. And the price that is paid, as we are sure many of you have already guessed, is speed. Almost all your 16-bit applications will run more slowly in this environment.</P>
<p>The advantage of this arrangement is that Windows 2000 does separate the 16-bit applications from other applications that are running in Windows 2000 Professional. If a 16-bit application crashes, as they are prone to do from time to time, the only applications that are affected are the other 16-bit applications that were running in the subsystem with it. The process of isolating 16-bit applications is handled by the WOWEXECs.</P>
<h4 align="LEFT"><a name="Heading3"></A><font color="#000077">WOWEXEC&#151;Windows on Windows</FONT></H4>
<p>One of the biggest frustrations in working with Windows 3.<i>x</I> and Windows 95 is losing all programs because one program chooses to be uncooperative. We have lost our share of information because one Windows 3.<i>x</I> application crashed and all the other applications that were open at the same time become unusable. One of our greatest joys with Windows 2000 Professional has been the independence that 32-bit applications have from each other. We have crashed and hung many 32-bit applications (whose names shall remain nameless) but have been able to close them without any adverse effect to the other 32-bit applications that were open at the same time.</P>
<p>Unfortunately, when the time comes to run 16-bit Windows applications, it still seems like we&#146;re in Windows 3.<i>x</I>&#151;only sometimes slower. Many people have been looking for the same independence for their 16-bit applications that the 32-bit applications have enjoyed in Windows 2000. WOW, have we got something in store for you&#151;WOWEXECs.</P>
<p>WOWEXECs are your 16-bit applications&#146; way of separating themselves from other 16-bit applications in the memory of your system. By running a 16-bit application in its own memory space, you are allowing it to isolate itself from other 16-bit applications. Therefore, if the 16-bit application should crash, you can close the individual application without closing any other 16- or 32-bit applications.</P>
<p>Of course, all this power, flexibility, and application independence also comes with a price tag. The price you pay for this level of Win16 independence is speed. Your Win16 applications may already be suffering from performance degradation because they have to do certain input/output operations through the 16-bit subsystem. And now they will run even slower because you are running them in their own separate memory space.</P>
<p><font size="+1"><b>Starting WOWEXEC for a Particular Application</B></FONT></P>
<p>When you launch applications, the system will run your application in a separate memory space by default. There are several ways to start a 16-bit application in its own memory space. The possibilities include modifying the shortcut&#146;s properties to include a <tt>/separate</TT> option on the run command line, or starting the program from the command prompt by typing the name of the application followed by a <tt>/separate</TT> switch. Another possibility is to modify the association properties of the file extension to always start the program in a separate memory space. In this last case, use the same <tt>/separate</TT> switch at the end of the command line.</P><p><br></P>
<center>
<table border>
<tr>
<td><a href="../ch27/866-872.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="876-879.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>


</font></BODY></HTML>