<html>
<head>
<meta name=vsisbn content="0782124488">
<meta name=vstitle content="Mastering Windows 2000 Professional">
<meta name=vsauthor content="Mark Minasi, Todd Phillips">
<meta name=vspublisher content="Sybex, Inc.">
<meta name=vspubdate content="01/01/00">
<meta name=vscategory content="Operations Systems: Windows 2000">



<title>Mastering Windows 2000 Professional:Running Windows 3.x and DOS Programs</TITLE>
<!-- BEGIN HEADER -->
<meta name="ROBOTS" content="NOINDEX, NOFOLLOW">
<script>
<!--
function displayWindow(url, width, height) {
        var Win = window.open(url,"displayWindow",'width=' + width +
',height=' + height + ',resizable=1,scrollbars=yes');
}
//--></SCRIPT>

<!-- HEADER -->
<style type="text/css">
<!--
A:hover { color:red }
-->
</STYLE>

<!-- HEADER -->
<style type="text/css"> 
 <!--
 A:hover  {
 	color : Red;
 }
 -->
 </STYLE>

<script language="JavaScript1.2">
<!--
function checkForQuery(fm) {
  /* get the query value */
  var i = escape(fm.query.value);
  if (i == "") {
      alert('Please enter a search word or phrase');
      return false;
  }                  /* query is blank, dont run the .jsp file */
  else return true;  /* execute the .jsp file */
}
//--></script>

</HEAD>
<BODY bgcolor=#FFFFFF><FONT size=2 face="Arial, verdana, helvetica"><table width=100% border=0 cellspacing=0 cellpadding=2><tr bgcolor=#000000><td width=100% align=right><b><font color=#FFFFFF>Gotcha</font></b></td></tr></table><br><!--Begin Content Column -->

<table border=0 cellspacing=0 cellpadding=0>
<tr>
<td width=75 valign=top>
<img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/images/sm_covers/0782124488.gif" width=60 height=73 alt="Mastering Windows 2000 Professional" border="1">
</td>
<td align="left">
    <font face="arial, helvetica" size="-1" color="#336633"><b>Mastering Windows 2000 Professional</b></font>
    <br>
    <font face="arial, helvetica" size="-1"><i>by Mark Minasi, Todd Phillips</i>
    <br>
    Sybex, Inc.
    <br>
    <b>ISBN:</b>&nbsp;0782124488<b>&nbsp;&nbsp;&nbsp;Pub Date:</b>&nbsp;01/01/00</font>
</td>
</tr>
</table>
<p>
<!-- Empty Reference Subhead-->

<!--ISBN=0782124488//-->
<!--TITLE=Mastering Windows 2000 Professional//-->
<!--AUTHOR=Mark Minasi//-->
<!--AUTHOR=Todd Phillips//-->
<!--PUBLISHER=SYBEX//-->
<!--CHAPTER=28//-->
<!--PAGES=903-905//-->
<!--UNASSIGNED1//-->
<!--UNASSIGNED2//-->

<center>
<table border>
<tr>
<td><a href="901-903.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="905-908.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<p><br></P>
<p><font size="+1"><b>Editing an <i>.ini</I> File
</B></FONT></P>
<p>Because Win16 files can&#146;t see the Registry, to configure a Win16 application you need to edit its <tt>.ini</TT> file in Notepad (if the configuration you want is not available from the application itself). For example, imagine that you use a graphics program called Paint Shop Pro to edit screen captures. PSP remembers where you pulled your last file from and returns to that directory to open files. Most of the time, this &#147;bookmark&#148; is a convenience, but say that at one point your ISDN connection is having a bad-hair day and the last drive you&#146;d accessed was across the connection. Then, for all practical purposes, the program would be unusable. You could start it up, but when you tried to open a file, it would go looking for the inaccessible networked drive and keep on looking and looking and looking. The program would never admit that it couldn&#146;t find the drive but would keep searching until you shut the program down.</P>
<p>To get around this situation, you would need to change the default open drive, but there is no way to change this setting from within the program without opening a file&#151;which you couldn&#146;t do. Instead, you could open the Notepad (type <b>notepad</B> in the Run dialog box, accessible from the Start menu) to edit the <tt>.ini</TT> file.</P>
<p>The <tt>.ini</TT> files are usually in the program directory (or, if not there, the Windows 2000 directory), so you could open <tt>psp.ini</TT> to see the following:</P>
<!-- CODE SNIP //-->
<pre>
   [Paint Shop Pro]
   OpenDir=H:\WINDOW~1\PICS
   FileData=0,17
   Gamma=1.25
   Undo=1
   SaveDir=H:\WINDOW~1\PICS
</PRE>
<!-- END CODE SNIP //-->
<p>Many program&#146;s <tt>.ini</TT> files are pretty straightforward, as you can see here, and you should be able to see where to make the change. You could edit the <tt>OpenDir</TT> entry so that it reads from the local C drive and save the file. The next time you opened the application, it would be able to open files without any problem because it would no longer be looking for an inaccessible drive.</P>
<h3><a name="Heading20"></A><font color="#000077">Running DOS Diagnostic Programs</FONT></H3>
<p>Thus far in this chapter, we&#146;ve talked about memory management and how to set up DOS and Windows 3.<i>x</I> programs for best use under Windows 2000 Professional. To finish, we&#146;ll discuss how to use an unusual class of DOS programs&#151;diagnostics&#151;under Windows 2000.</P>
<h4 align="LEFT"><a name="Heading21"></A><font color="#000077">Use of DOS Diagnostics</FONT></H4>
<p>Our first advice about using DOS diagnostics is&#151;<i>don&#146;t</I>! Because of the proprietary nature of Windows 2000, it will not allow diagnostic utilities to talk directly to the hardware. Therefore, you will need to purchase a whole set of NT or Windows 2000 diagnostics that enables you to perform these functions in the Windows 2000 environment. This plan runs into only one problem; at this time, you won&#146;t find very many Windows 2000 diagnostic tools. Most vendors have worked so hard to provide Windows 95 solutions that NT Workstation diagnostics sort of fell to the wayside. We hope that will change as the popularity of Windows 2000 increases. What do you do until this time?</P>
<p>We are big proponents of using a FAT-based partition for Windows 2000&#146;s system partition. Then if anything critical happens to the operating system, you can boot up from a floppy disk and use your normal DOS diagnostic utilities. If you boot up from a floppy disk, you still will not be able to access your NTFS partitions on the hard drive. However, in the worst-case situation, you can reformat the Windows 2000 system partition, reinstall the operating system, and access your NTFS data partition.</P>
<blockquote>
<p><font size="-1"><hr><b>NOTE:&nbsp;&nbsp;</B>You can format your system partition with FAT32 in Windows 2000 and still have the ability to boot the system with an Emergency Boot Disk from Windows 98, if you have one. This is a great solution as the boot disk for Windows 98 has CD-ROM drivers that will enable you to restore files from the original CD-ROM in the event of a total failure of Windows 2000.<hr></FONT>
</BLOCKQUOTE>
<p><br></P>
<center>
<table border>
<tr>
<td><a href="901-903.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="905-908.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>


</font></BODY></HTML>