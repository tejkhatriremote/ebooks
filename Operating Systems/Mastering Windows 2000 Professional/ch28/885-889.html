<html>
<head>
<meta name=vsisbn content="0782124488">
<meta name=vstitle content="Mastering Windows 2000 Professional">
<meta name=vsauthor content="Mark Minasi, Todd Phillips">
<meta name=vspublisher content="Sybex, Inc.">
<meta name=vspubdate content="01/01/00">
<meta name=vscategory content="Operations Systems: Windows 2000">



<title>Mastering Windows 2000 Professional:Running Windows 3.x and DOS Programs</TITLE>
<!-- BEGIN HEADER -->
<meta name="ROBOTS" content="NOINDEX, NOFOLLOW">
<script>
<!--
function displayWindow(url, width, height) {
        var Win = window.open(url,"displayWindow",'width=' + width +
',height=' + height + ',resizable=1,scrollbars=yes');
}
//--></SCRIPT>

<!-- HEADER -->
<style type="text/css">
<!--
A:hover { color:red }
-->
</STYLE>

<!-- HEADER -->
<style type="text/css"> 
 <!--
 A:hover  {
 	color : Red;
 }
 -->
 </STYLE>

<script language="JavaScript1.2">
<!--
function checkForQuery(fm) {
  /* get the query value */
  var i = escape(fm.query.value);
  if (i == "") {
      alert('Please enter a search word or phrase');
      return false;
  }                  /* query is blank, dont run the .jsp file */
  else return true;  /* execute the .jsp file */
}
//--></script>

</HEAD>
<BODY bgcolor=#FFFFFF><FONT size=2 face="Arial, verdana, helvetica"><table width=100% border=0 cellspacing=0 cellpadding=2><tr bgcolor=#000000><td width=100% align=right><b><font color=#FFFFFF>Gotcha</font></b></td></tr></table><br><!--Begin Content Column -->

<table border=0 cellspacing=0 cellpadding=0>
<tr>
<td width=75 valign=top>
<img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/images/sm_covers/0782124488.gif" width=60 height=73 alt="Mastering Windows 2000 Professional" border="1">
</td>
<td align="left">
    <font face="arial, helvetica" size="-1" color="#336633"><b>Mastering Windows 2000 Professional</b></font>
    <br>
    <font face="arial, helvetica" size="-1"><i>by Mark Minasi, Todd Phillips</i>
    <br>
    Sybex, Inc.
    <br>
    <b>ISBN:</b>&nbsp;0782124488<b>&nbsp;&nbsp;&nbsp;Pub Date:</b>&nbsp;01/01/00</font>
</td>
</tr>
</table>
<p>
<!-- Empty Reference Subhead-->

<!--ISBN=0782124488//-->
<!--TITLE=Mastering Windows 2000 Professional//-->
<!--AUTHOR=Mark Minasi//-->
<!--AUTHOR=Todd Phillips//-->
<!--PUBLISHER=SYBEX//-->
<!--CHAPTER=28//-->
<!--PAGES=885-889//-->
<!--UNASSIGNED1//-->
<!--UNASSIGNED2//-->

<center>
<table border>
<tr>
<td><a href="879-885.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="890-892.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<p><br></P>
<p><font size="+1"><b>Using the Advanced Button</B></FONT></P>
<p>Clicking the Advanced button (as shown earlier in Figure 28.6) enables you to adjust the DOS environment for a particular DOS application. If you do not specify a specific DOS environment, Windows 2000 will use its default settings as specified in the <tt>autoexec.nt</TT> and <tt>config.nt</TT> files. You can set the locations for the files that you want to use by clicking the Advanced button. The Windows PIF Settings dialog box then appears, as shown in the following graphic.</P>
<p><a name="Fig7"></A><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/0782124488/ch28/images/28-07.jpg',453,131)"><img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/reference/pro/0782124488/ch28/images/28-07t.jpg"></A></P>
<p>Windows 2000 uses the <tt>*.nt</TT> files in lieu of the <tt>autoexec.bat</TT> and <tt>config.sys</TT> files that you are used to configuring in DOS. You place the command that you would normally place in the <tt>autoexec.bat</TT> and <tt>config.sys</TT> file in the <tt>*.nt</TT> files. The power of setting these files for each DOS session is that you can now specify different parameters for different applications. The <tt>*.nt</TT> files can be a powerful management tool for keeping your DOS applications under control, so let&#146;s take a closer look.</P>
<p><font size="+1"><b>Using config.nt and autoexec.nt</B></FONT></P>
<p>The <tt>*.nt</TT> files run every time that you launch a DOS application. They load themselves in the subsystem so that each DOS subsystem has its own copy of the TSRs and device drivers.</P>
<blockquote>
<p><font size="-1"><hr><b>NOTE:&nbsp;&nbsp;</B>The drivers and TSRs that get loaded in the <tt>*.nt</TT> files are 16-bit. If you are loading 32-bit drivers and software, Windows 2000 will handle them directly.<hr></FONT>
</BLOCKQUOTE>
<p>The <tt>*.nt</TT> files afford you the compatibility that you may need to run your 16-bit DOS application, while at the same time giving you added features to make life easier as you work with DOS applications.</P>
<p><font size="+1"><b>Special config.nt Commands</B></FONT></P>
<p>Listed here are some of the commands that can be entered into the <tt>config.nt</TT> file. These commands were new in Windows NT. (They do not exist in Windows 3.<i>x</I> or Windows 95.)</P>
<dl>
<dt><b>ECHOCONFIG</B>
<dd>Prints the <tt>config.sys</TT> commands on screen while they are being executed.
<dt><b>NTCMDPROMPT</B>
<dd>Loads a 32-bit Windows 2000 command interpreter with full functionality with Windows 2000 commands. The name of the Windows 2000 version of the command interpreter is called <tt>cmd.exe</TT>. Without this command, Windows 2000 Professional will use <tt>command.com</TT>, the 16-bit version of the command interpreter. A classic example of the difference between <tt>cmd.exe</TT> and <tt>command.com</TT> is a utility called DOSkey (traditionally a 16-bit utility). If you do not use the NTCMDPROMPT parameter, DOSkey will not load into the DOS subsystem. By turning this feature on, the DOSkey utility works just fine. The reason for the difference is that the new 32-bit version of DOSkey that comes with Windows 2000 cannot run under <tt>command.com</TT>.
<dt><b>DOSONLY</B>
<dd>Enables only MS-DOS applications to run in this subsystem. If you attempt to run an NT or 32-bit application, the following error message will occur:
</DL>

<!-- CODE SNIP //-->
<pre>
   This program cannot be run in DOS mode.
</PRE>
<!-- END CODE SNIP //-->
<p><font size="+1"><b>Setting autoexec.nt Features</B></FONT></P>
<p>The following features apply to <tt>autoexec.nt</TT>:</P>
<dl>
<dt><b>CD-ROM extensions</B>
<dd>Enables you to load the CD-ROM drivers into the subsystem. By default, Windows 2000 Professional places a 32-bit version of the driver in the subsystem so that Windows 2000 and DOS will use the same driver. This scheme should be transparent to the DOS application.
<dt><b>Microsoft Network redirector</B>
<dd>Enables you to access the drives on the Microsoft enterprise network from within the DOS subsystem.
<dt><b>DPMI support</B>
<dd>Loads the DOS Protected Mode Interface drivers for your DOS application that may support this standard.
<dt><b>Other network redirectors</B>
<dd>Enable you to communicate with non-Microsoft networks from within this DOS subsystem.
</DL>

<p><font size="+1"><b>Changing the Icon</B></FONT></P>
<p>When you first install any DOS application, it gets the default MS-DOS icon even if an icon file is included in the program directory. Boring, right? (Not to mention confusing, if all your DOS apps look alike.) To change the icon, click the Change Icon button in the Program tab and you&#146;ll see the Change Icon dialog box, as shown in Figure 28.7.
</P>
<p><a name="Fig8"></A><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/0782124488/ch28/images/28-08.jpg',324,350)"><img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/reference/pro/0782124488/ch28/images/28-08t.jpg"></A>
<br><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/0782124488/ch28/images/28-08.jpg',324,350)"><font color="#000077"><b>Figure 28.7</B></FONT></A>&nbsp;&nbsp;Change Icon dialog box</P>
<p>A veritable cornucopia of icons! If you want to use an icon associated with this application, you can browse for one instead of using one of the generic icons. Click the Browse button to display another Change Icon dialog box (see Figure 28.8). You can use any file with an .<tt>ico</TT> extension for your icon. Move to the directory containing your application files and choose an <tt>.ico</TT> file if you find one for that application. Click OK to return to the previous dialog, which now shows the new icon.</P>
<blockquote>
<p><font size="-1"><hr><b>NOTE:&nbsp;&nbsp;</B>The default library for icons is <tt>pifmgr.dll</TT>. However, if you have upgraded your system from an earlier version of NT, you will also find another library of icons called <tt>moricons.dll</TT>. Feel free to use either.<hr></FONT>
</BLOCKQUOTE>
<p><a name="Fig9"></A><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/0782124488/ch28/images/28-09.jpg',563,347)"><img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/reference/pro/0782124488/ch28/images/28-09t.jpg"></A>
<br><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/0782124488/ch28/images/28-09.jpg',563,347)"><font color="#000077"><b>Figure 28.8</B></FONT></A>&nbsp;&nbsp;Browsing for a new icon</P>
<h4 align="LEFT"><a name="Heading9"></A><font color="#000077">Fonts</FONT></H4>
<p>Click the Font tab to display the window in Figure 28.9.
</P>
<p><a name="Fig10"></A><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/0782124488/ch28/images/28-10.jpg',370,461)"><img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/reference/pro/0782124488/ch28/images/28-10t.jpg"></A>
<br><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/0782124488/ch28/images/28-10.jpg',370,461)"><font color="#000077"><b>Figure 28.9</B></FONT></A>&nbsp;&nbsp;Font tab in the Properties dialog box</P>
<p>From this dialog box, you can select the font that the DOS <i>window</I> will use, choosing from either bitmapped fonts or TrueType. You might find TrueType fonts very finely drawn and thus difficult to read in DOS windows, but you can see how a given font will look in the Font preview window and decide for yourself. Choosing Auto makes the font size correspond to the size of the window&#151;if you make the window bigger or smaller, the font size will adjust accordingly. If you select a specific font size, you won&#146;t be able to resize the window. Notice how, as you select different fonts, the image in the Window Preview box changes.</P>
<blockquote>
<p><font size="-1"><hr><b>NOTE:&nbsp;&nbsp;</B>Changing the font size here doesn&#146;t affect the font that the application uses. Whether you choose Auto or 16x12, a Lotus 1-2-3 spreadsheet, for example, will use the same font. Changing the font makes a difference only if the application uses the DOS command line.<hr></FONT>
</BLOCKQUOTE>
<h4 align="LEFT"><a name="Heading10"></A><font color="#000077">Memory</FONT></H4>
<p>The Memory tab and Program tab contain the most important settings for making sure that your DOS application is working properly. The Program tab controls how your application runs, whereas the Memory tab determines the amount and kind of memory that your application gets. You can see <tt>command.com</TT>&#146;s Memory tab in Figure 28.10.</P>
<p><a name="Fig11"></A><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/0782124488/ch28/images/28-11.jpg',370,461)"><img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/reference/pro/0782124488/ch28/images/28-11t.jpg"></A>
<br><a href="javascript:displayWindow('../WebStripper/protected.html#link=http://corpitk.earthweb.com/reference/pro/0782124488/ch28/images/28-11.jpg',370,461)"><font color="#000077"><b>Figure 28.10</B></FONT></A>&nbsp;&nbsp;Memory tab in <tt>command.com</TT>&#146;s Properties dialog box
</P>
<p>This dialog box is fairly complex, so let&#146;s look at each entry in turn.
</P><p><br></P>
<center>
<table border>
<tr>
<td><a href="879-885.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="890-892.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>


</font></BODY></HTML>