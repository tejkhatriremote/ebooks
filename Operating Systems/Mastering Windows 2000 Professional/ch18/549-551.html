<html>
<head>
<meta name=vsisbn content="0782124488">
<meta name=vstitle content="Mastering Windows 2000 Professional">
<meta name=vsauthor content="Mark Minasi, Todd Phillips">
<meta name=vspublisher content="Sybex, Inc.">
<meta name=vspubdate content="01/01/00">
<meta name=vscategory content="Operations Systems: Windows 2000">



<title>Mastering Windows 2000 Professional:Understanding the Architecture</TITLE>
<!-- BEGIN HEADER -->
<meta name="ROBOTS" content="NOINDEX, NOFOLLOW">
<script>
<!--
function displayWindow(url, width, height) {
        var Win = window.open(url,"displayWindow",'width=' + width +
',height=' + height + ',resizable=1,scrollbars=yes');
}
//--></SCRIPT>

<!-- HEADER -->
<style type="text/css">
<!--
A:hover { color:red }
-->
</STYLE>

<!-- HEADER -->
<style type="text/css"> 
 <!--
 A:hover  {
 	color : Red;
 }
 -->
 </STYLE>

<script language="JavaScript1.2">
<!--
function checkForQuery(fm) {
  /* get the query value */
  var i = escape(fm.query.value);
  if (i == "") {
      alert('Please enter a search word or phrase');
      return false;
  }                  /* query is blank, dont run the .jsp file */
  else return true;  /* execute the .jsp file */
}
//--></script>

</HEAD>
<BODY bgcolor=#FFFFFF><FONT size=2 face="Arial, verdana, helvetica"><table width=100% border=0 cellspacing=0 cellpadding=2><tr bgcolor=#000000><td width=100% align=right><b><font color=#FFFFFF>Gotcha</font></b></td></tr></table><br><!--Begin Content Column -->

<table border=0 cellspacing=0 cellpadding=0>
<tr>
<td width=75 valign=top>
<img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/images/sm_covers/0782124488.gif" width=60 height=73 alt="Mastering Windows 2000 Professional" border="1">
</td>
<td align="left">
    <font face="arial, helvetica" size="-1" color="#336633"><b>Mastering Windows 2000 Professional</b></font>
    <br>
    <font face="arial, helvetica" size="-1"><i>by Mark Minasi, Todd Phillips</i>
    <br>
    Sybex, Inc.
    <br>
    <b>ISBN:</b>&nbsp;0782124488<b>&nbsp;&nbsp;&nbsp;Pub Date:</b>&nbsp;01/01/00</font>
</td>
</tr>
</table>
<p>
<!-- Empty Reference Subhead-->

<!--ISBN=0782124488//-->
<!--TITLE=Mastering Windows 2000 Professional//-->
<!--AUTHOR=Mark Minasi//-->
<!--AUTHOR=Todd Phillips//-->
<!--PUBLISHER=SYBEX//-->
<!--CHAPTER=18//-->
<!--PAGES=549-551//-->
<!--UNASSIGNED1//-->
<!--UNASSIGNED2//-->

<center>
<table border>
<tr>
<td><a href="545-549.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="552-554.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<p><br></P>
<h4 align="LEFT"><a name="Heading9"></A><font color="#000077">Windows 2000&#146;s Baseline: the HAL, the Kernel, and the Drivers</FONT></H4>
<p>The HAL, the Kernel, and the Drivers&#151;sounds like a rock band, doesn&#146;t it? To keep Windows 2000 as architecture-independent as possible, Microsoft minimized the amount of the operating system that is hardware specific. Just three parts of the operating system must change with different computers:
</P>
<dl>
<dd><b>&#149;</B>&nbsp;&nbsp;The Hardware Abstraction Layer, <tt>hal.dll</TT>
<dd><b>&#149;</B>&nbsp;&nbsp;The Kernel, <tt>ntoskrnl.exe</TT>
<dd><b>&#149;</B>&nbsp;&nbsp;The device drivers for the computer&#146;s specific hardware, such as video drivers, network card drivers, and mouse drivers
</DL>
<p>Next, we take a brief look at each of these components.
</P>
<p><font size="+1"><b>&#147;Open the Drive Bay Door, HAL&#148;</B></FONT></P>
<p>Well, you never have to tell it that, really. The HAL exists to smooth out differences <i>within</I> the many implementations of a particular microprocessor. For example, the Motorola 68000 was the processor upon which the Apple Macintosh, the Amiga, and the Atari 520 ST were built. They were all desktop microcomputers with GUIs, but any other similarity ends there. Some of the computers made heavy use of interrupts; others used more programmed input-output and direct memory access (DMA). Additionally, a <i>huge</I> difference exists between the structure of a PC with one processor and a PC with two or more processors.</P>
<p>The HAL&#146;s job is to smooth out those differences, presenting to the operating system a standard-looking set of computer hardware. The HAL is implemented as a file called <tt>hal.dll</TT>. In the 68000 example, the Macintosh, Atari ST520, and Amiga versions would all have the same Kernel because they all use the same processor, but they&#146;d need different HALs.</P>
<p>The basic HAL that ships with Windows 2000 Professional supports two processors, and the HAL that ships with Windows 2000 Server supports up to four processors. NT can support up to 32 processors in theory, but you&#146;d need a new HAL to support them. Similarly, if a new peripheral bus were to appear, like a 128-bit version of PCI, Windows 2000 would need only a new HAL and then it would run with no problems.</P>
<p><font size="+1"><b>We Have a Kernel, but Not a General</B></FONT></P>
<p>Unix systems were built in pieces, somewhat similar to the way Windows 2000 is built today, and the central manager or heart of the operating system was called the <i>Kernel</I>. That name is used to describe the heart of virtually every operating system, and Windows 2000 is no exception.</P>
<p>The Kernel is mainly a piece of software that schedules tasks on your computer. If several programs all want to run at the same time, the Kernel locates the one that has the highest priority and runs that task. The Kernel also makes sure that all the processors in a multiprocessor system keep busy.</P>
<p>The Kernel also manages all the Windows 2000 subsystems, which are the subject of most of the remainder of this chapter. Managing subsystems turns out to be a key concept in understanding the notion of Windows 2000 borrowing from the microkernel and client-server models of operating systems, as you&#146;ll see in the section &#147;Designing Robustness.&#148;</P>
<p><font size="+1"><b>They&#146;re Called Drivers Because They Can Drive You Crazy</B></FONT></P>
<p>Support for particular pieces of hardware could be built into an operating system&#151;for example, Microsoft could have built support for a Microsoft mouse right into the Kernel&#151;but that isn&#146;t a particularly good idea. For one thing, if you had a computer that didn&#146;t include a Microsoft mouse, then the memory required to hold the Microsoft mouse support would be wasted.
</P>
<p>Instead, Windows 2000, like other operating systems, segregates support for hardware devices into separate software modules called <i>device drivers</I>. Although most descriptions of Windows 2000 do not include device drivers in the hardware-specific part of Windows 2000 (most just show the HAL and the Kernel), these drivers are quite hardware-specific. That fact is worth knowing; support for a particular network card on an Intel system doesn&#146;t necessarily mean that it&#146;s supported on an Alpha system. (<i>That&#146;s</I> the part that can drive you crazy.)</P>
<p>Perhaps the other reason that drivers can drive you crazy (and why you care about what they are in the first place) is that they&#146;re usually not written by the people who write the operating system. Instead, they&#146;re written by somebody at a company that makes a peripheral such as a video board, a mouse, a local area network board, or a SCSI host adapter. These people often don&#146;t understand Windows 2000 all that well, with the result that drivers are often not written very well.</P>
<p>Now, the scary part is that drivers pretty much <i>must</I> be Kernel mode programs, so a badly written driver can crash your system.</P>
<blockquote>
<p><font size="-1"><hr><b>WARNING:&nbsp;&nbsp;</B>In our experience, a bad driver is usually the cause of a Windows 2000 crash.<hr></FONT>
</BLOCKQUOTE>
<p>More than 90 percent of the Windows 2000 crashes we&#146;ve seen are caused either by bad SCSI drivers or bad Enhanced Integrated Drive Electronics (EIDE) drivers. Of course, the great strength about Windows 2000 is that when it dies, it points the finger at who killed it, so at least you can go back to the vendor who wrote the driver and ask the company to fix it. The vendor may not fix the driver, but at least they won&#146;t be able to do any finger-pointing at other vendors. The culprit&#146;s name is printed in black and white for anyone to see when you run the <tt>dumpexam.exe</TT> program. (You&#146;ll learn more about <tt>dumpexam.exe</TT> in Chapter 29, &#147;Fixing Windows 2000 Professional When It Breaks.&#148;)</P>
<p>&#147;But wait a minute,&#148; you cry, &#147;I thought Windows 2000 was stable.&#148; Well, yes, it&#146;s stable, but there&#146;s no such thing as a bulletproof operating system; as we&#146;ve already said, designing an operating system involves trade-offs&#151;which is the topic of the next section.</P>
<h3><a name="Heading10"></A><font color="#000077">Designing Robustness</FONT></H3>
<p>We&#146;ve made much of how Windows 2000&#146;s structure lends to it a stability that most of us haven&#146;t seen in desktop operating systems, but we haven&#146;t really gone too much into the details. Let&#146;s do that now.
</P><p><br></P>
<center>
<table border>
<tr>
<td><a href="545-549.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="552-554.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>


</font></BODY></HTML>