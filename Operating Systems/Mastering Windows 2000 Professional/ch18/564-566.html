<html>
<head>
<meta name=vsisbn content="0782124488">
<meta name=vstitle content="Mastering Windows 2000 Professional">
<meta name=vsauthor content="Mark Minasi, Todd Phillips">
<meta name=vspublisher content="Sybex, Inc.">
<meta name=vspubdate content="01/01/00">
<meta name=vscategory content="Operations Systems: Windows 2000">



<title>Mastering Windows 2000 Professional:Understanding the Architecture</TITLE>
<!-- BEGIN HEADER -->
<meta name="ROBOTS" content="NOINDEX, NOFOLLOW">
<script>
<!--
function displayWindow(url, width, height) {
        var Win = window.open(url,"displayWindow",'width=' + width +
',height=' + height + ',resizable=1,scrollbars=yes');
}
//--></SCRIPT>

<!-- HEADER -->
<style type="text/css">
<!--
A:hover { color:red }
-->
</STYLE>

<!-- HEADER -->
<style type="text/css"> 
 <!--
 A:hover  {
 	color : Red;
 }
 -->
 </STYLE>

<script language="JavaScript1.2">
<!--
function checkForQuery(fm) {
  /* get the query value */
  var i = escape(fm.query.value);
  if (i == "") {
      alert('Please enter a search word or phrase');
      return false;
  }                  /* query is blank, dont run the .jsp file */
  else return true;  /* execute the .jsp file */
}
//--></script>

</HEAD>
<BODY bgcolor=#FFFFFF><FONT size=2 face="Arial, verdana, helvetica"><table width=100% border=0 cellspacing=0 cellpadding=2><tr bgcolor=#000000><td width=100% align=right><b><font color=#FFFFFF>Gotcha</font></b></td></tr></table><br><!--Begin Content Column -->

<table border=0 cellspacing=0 cellpadding=0>
<tr>
<td width=75 valign=top>
<img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/images/sm_covers/0782124488.gif" width=60 height=73 alt="Mastering Windows 2000 Professional" border="1">
</td>
<td align="left">
    <font face="arial, helvetica" size="-1" color="#336633"><b>Mastering Windows 2000 Professional</b></font>
    <br>
    <font face="arial, helvetica" size="-1"><i>by Mark Minasi, Todd Phillips</i>
    <br>
    Sybex, Inc.
    <br>
    <b>ISBN:</b>&nbsp;0782124488<b>&nbsp;&nbsp;&nbsp;Pub Date:</b>&nbsp;01/01/00</font>
</td>
</tr>
</table>
<p>
<!-- Empty Reference Subhead-->

<!--ISBN=0782124488//-->
<!--TITLE=Mastering Windows 2000 Professional//-->
<!--AUTHOR=Mark Minasi//-->
<!--AUTHOR=Todd Phillips//-->
<!--PUBLISHER=SYBEX//-->
<!--CHAPTER=18//-->
<!--PAGES=564-566//-->
<!--UNASSIGNED1//-->
<!--UNASSIGNED2//-->

<center>
<table border>
<tr>
<td><a href="561-563.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="566-568.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<p><br></P>
<p>If you want to run a Win32 program on your IA64, then you&#146;ve got to find out if the software vendor has written it for the IA64 in the first place. Although virtually every Win32 application has been built to run on the <i>x</I>86 line, most Windows 2000 applications never get translated to IA64. Windows 2000&#146;s much-vaunted portability is of value only if software vendors take the short extra time needed to recompile their programs for both platforms&#151;and, sadly, most have not.</P>
<p>As Windows 95 programs are usually also Windows 2000 programs, RISC users are in the odd position of being pretty much guaranteed compatibility with Windows 3.1, but not with Windows 95. Too bad we don&#146;t have an <i>x</I>86 emulator for Win32 code, isn&#146;t it?</P>
<blockquote>
<p><font size="-1"><hr><b>NOTE:&nbsp;&nbsp;</B>Buggy and <i>x</I>86-only programs aside, a number of types of programs will not run under both NT and 95. But the Win32 API supports enough NT and 95 programs to be called a common programming interface.<hr></FONT>
</BLOCKQUOTE>
<p>The Win32 programming interface is a bit different in NT Workstation 4 and Windows 2000 than it was in previous versions; as mentioned earlier, Microsoft moved the Win32 programming interface from User mode to Kernel mode in version 4.
</P>
<p><font size="+1"><b>WOWEXEC</B></FONT></P>
<p>Windows 2000 doesn&#146;t run Windows 3.1 programs natively; rather, it runs a large program that supports old Windows 3.1 programs called the &#147;Win16 on Win32,&#148; or WOW. A program called WOWEXEC creates the WOW environment. You already know that Windows 2000 can run Windows 3.1 programs, and we don&#146;t intend to belabor the point here. But there are some useful side effects caused by the way that Windows 2000 runs Windows 3.1 programs that make 2000 <i>superior</I> to 3.1 for running its 3.1 programs. Specifically,</P>
<dl>
<dd><b>&#149;</B>&nbsp;&nbsp;Windows 2000 optionally provides separate memory spaces for each Windows program.
<dd><b>&#149;</B>&nbsp;&nbsp;Windows 2000 separates the Windows modules far enough from the system that a Windows 3.1 application basically <i>cannot</I> crash the system.
<dd><b>&#149;</B>&nbsp;&nbsp;Windows 2000 multitasks Windows 3.1 applications far better than does Windows 3.1 or Windows 95.
</DL>
<p><b>Separate WOWEXECs</B>&nbsp;&nbsp;By default, all Windows 3.1 programs run in the same WOWEXEC module. To make WOWEXEC as backward-compatible as possible, Windows 2000 enables Windows 3.1 applications to do a certain amount of fiddling around in their &#147;operating system&#148;&#151;that is, in WOWEXEC, not in Windows 2000. As a result, a Windows 3.1 application <i>could</I> trash WOWEXEC. For example, you might find that a Windows 3.1 application just stops responding. It doesn&#146;t change the screen, you can&#146;t choose menu items, and you can&#146;t close it down. You <i>can</I>, of course, always press Ctrl+Alt+Del and tell the Task Manager to shut down any application, whether it&#146;s a Windows 2000 or a Windows 3.1 application.</P>
<p>When you tell Windows 2000 to shut down an application, it often returns a dialog box that says &#147;This application is not responding&#148; and advises you to either wait a bit and try again (a fruitless endeavor in our experience) or tell it to force the application to shut down. The second choice often does the trick.</P>
<p>Sometimes, however, it doesn&#146;t, and Windows 2000 offers to go a step further, shutting down the whole of WOWEXEC. Be aware that this step shuts down not only the errant Windows 3.1 application, but also any other Windows 3.1 applications.</P>
<p>You have an option when running a Windows 3.1 application under Windows 2000 to run the application in a separate memory space. <i>Separate memory space</I> means that Windows 2000 creates a completely separate WOWEXEC for that one application. That&#146;s potentially good because no matter how crazy that application gets, it cannot damage anything except itself. That extra protection isn&#146;t without a cost, however. Each WOWEXEC takes up some memory, so running many Windows 3.1 applications, each in its own memory space, places a greater strain on your system&#146;s available RAM than if you run all of them in a single WOWEXEC.</P>
<p><b>Sturdier Multitasking</B>&nbsp;&nbsp;Those separate WOWEXECs obviously improve the crash-proof nature of Windows 2000. But they offer something else as well: better multitasking.</P>
<p>Under Windows 3.1, all applications multitask using a method called <i>cooperative multitasking</I>. Explaining cooperative multitasking works best when using an unlikely analogy&#151;a vaudeville show.</P>
<p>Windows 3.1 applications multitask in much the same way as vaudeville performers. The Kernel&#151;the stage manager in Windows 3.1&#151;shoves an application out onto the Desktop, hoping that it won&#146;t stay there for long. A cooperative application runs only for a few tenths of a second at most, yielding to the Kernel. The Kernel can then select the next application to get some CPU time, and so on. Some Windows 3.1 applications, however, aren&#146;t very cooperative. They just slap the hourglass up on the screen and continue to work away, oblivious to the other applications that are waiting to run.</P>
<p>In vaudeville, the stage manager had a course of action: <i>the hook</I>. With the hook, a stage manager could yank a performer off stage. Sadly, Windows 3.1 lacks a hook.</P>
<p>To maintain compatibility with Windows 3.1, Windows 2000 also lacks a hook in WOWEXEC. Consequently, a Windows 3.1 application can monopolize all the CPU power allocated to WOWEXEC. However, a Windows 3.1 application cannot take all the CPU time under Windows 2000 because Windows 2000 gives only a percentage of its CPU power to WOWEXEC&#151;and that restriction is very important.</P>

<table border="2" bordercolor="#0000" align="CENTER">
<tr><td><font size="+1"><b>A Short Detour into Vaudeville</B></FONT>
<p>Back before TV and movies were popular, but after Americans started getting more leisure time and more income, more and more road shows started popping up around the country. Around the turn of the century, the most common format for these road shows was the variety show, with a dozen or so acts, each running for three to six minutes. These became known as vaudeville shows.
</P>
<p>Now, the trick to managing a variety show is to understand that while <i>some</I> people will be spellbound by the guy who&#146;s balancing plates on poles, <i>others</I> came to see the woman whose dog can do square roots. As a result, each act can&#146;t go on for very long, or there won&#146;t be enough time for the other acts. The job of making sure that the schedule is rigidly adhered to falls to the stage manager. Standing just in the wings, he directs each act out onto the stage and, when time is up, he signals the performer to exit.</P>
<p>Now, here&#146;s where the cooperative part comes in.</P>
<p>The performer really <i>shouldn&#146;t</I> have to be reminded that his time is up, but sometimes it happens. Some performers, however, feel that they&#146;re making the crowd happy and should be allowed to overstay their time on stage. A cooperative performer puts those thoughts aside for the good of the show, however, and takes her bows. Less cooperative performers don&#146;t.</P>
</TABLE>

<p><br></P>
<center>
<table border>
<tr>
<td><a href="561-563.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="566-568.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>


</font></BODY></HTML>