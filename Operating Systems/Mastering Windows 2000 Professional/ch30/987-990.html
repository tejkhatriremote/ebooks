<html>
<head>
<meta name=vsisbn content="0782124488">
<meta name=vstitle content="Mastering Windows 2000 Professional">
<meta name=vsauthor content="Mark Minasi, Todd Phillips">
<meta name=vspublisher content="Sybex, Inc.">
<meta name=vspubdate content="01/01/00">
<meta name=vscategory content="Operations Systems: Windows 2000">



<title>Mastering Windows 2000 Professional:Administrative and Diagnostic Tools</TITLE>
<!-- BEGIN HEADER -->
<meta name="ROBOTS" content="NOINDEX, NOFOLLOW">
<script>
<!--
function displayWindow(url, width, height) {
        var Win = window.open(url,"displayWindow",'width=' + width +
',height=' + height + ',resizable=1,scrollbars=yes');
}
//--></SCRIPT>

<!-- HEADER -->
<style type="text/css">
<!--
A:hover { color:red }
-->
</STYLE>

<!-- HEADER -->
<style type="text/css"> 
 <!--
 A:hover  {
 	color : Red;
 }
 -->
 </STYLE>

<script language="JavaScript1.2">
<!--
function checkForQuery(fm) {
  /* get the query value */
  var i = escape(fm.query.value);
  if (i == "") {
      alert('Please enter a search word or phrase');
      return false;
  }                  /* query is blank, dont run the .jsp file */
  else return true;  /* execute the .jsp file */
}
//--></script>

</HEAD>
<BODY bgcolor=#FFFFFF><FONT size=2 face="Arial, verdana, helvetica"><table width=100% border=0 cellspacing=0 cellpadding=2><tr bgcolor=#000000><td width=100% align=right><b><font color=#FFFFFF>Gotcha</font></b></td></tr></table><br><!--Begin Content Column -->

<table border=0 cellspacing=0 cellpadding=0>
<tr>
<td width=75 valign=top>
<img webstripperattrwas="src" webstripperlinkwas="http://corpitk.earthweb.com/images/sm_covers/0782124488.gif" width=60 height=73 alt="Mastering Windows 2000 Professional" border="1">
</td>
<td align="left">
    <font face="arial, helvetica" size="-1" color="#336633"><b>Mastering Windows 2000 Professional</b></font>
    <br>
    <font face="arial, helvetica" size="-1"><i>by Mark Minasi, Todd Phillips</i>
    <br>
    Sybex, Inc.
    <br>
    <b>ISBN:</b>&nbsp;0782124488<b>&nbsp;&nbsp;&nbsp;Pub Date:</b>&nbsp;01/01/00</font>
</td>
</tr>
</table>
<p>
<!-- Empty Reference Subhead-->

<!--ISBN=0782124488//-->
<!--TITLE=Mastering Windows 2000 Professional//-->
<!--AUTHOR=Mark Minasi//-->
<!--AUTHOR=Todd Phillips//-->
<!--PUBLISHER=SYBEX//-->
<!--CHAPTER=30//-->
<!--PAGES=987-990//-->
<!--UNASSIGNED1//-->
<!--UNASSIGNED2//-->

<center>
<table border>
<tr>
<td><a href="985-987.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="990-993.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>
<p><br></P>
<h4 align="LEFT"><a name="Heading15"></A><font color="#000077">Editing Logon Scripts</FONT></H4>
<p>Logon scripts are handy tools that can be used instead of or in addition to user profiles. Given that user profiles encapsulate a user&#146;s program items, screen colors, network connections, printer connections, mouse settings, window size and position, and more, why would you want to use a logon script? Well, there are a couple of reasons:
</P>
<dl>
<dd><b>&#149;</B>&nbsp;&nbsp;If mixed client types connect to your system, such as users running Windows 95 or Windows 3.11, these clients can&#146;t use Windows 2000 user profiles.
<dd><b>&#149;</B>&nbsp;&nbsp;Because they&#146;re almost always text-based batch files, logon scripts are much easier to edit than a user profile, for which there is no editor. To edit a user profile, you have to add that user to the Administrators group, log on as that user, make the necessary changes, and log off. (Remember to remove the user from the Administrators group after logging off as that user.)
</DL>
<p>Logon scripts are especially useful for configuring network connections because one logon script can be applied to multiple users. When you change your system configuration and want to update users&#146; network connections, you need update only a single file. By the way, you can also use logon scripts to configure network connections for Windows 2000 clients.
</P>
<p>If you&#146;ve used the MS-DOS Net commands, you&#146;ll be familiar with how to write a batch file. If not, what a batch file might look like is listed below:</P>
<!-- CODE SNIP //-->
<pre>
   NET USE <i>drive letter</I>: | *] [\\<i>computer</I>\<i>directory</I> [<i>password</I> | ?]]
   [/SAVEPW: [/YES] [/NO]
</PRE>
<!-- END CODE SNIP //-->
<p>Here&#146;s the explanation of the above syntax:
</P>
<dl>
<dt><b>drive letter</B>
<dd>The drive letter you want to assign. (The * parameter instructs Windows 2000 to use the next drive letter available.)
<dt><b>\\computer</B>
<dd>The name of the computer.
<dt><b>\directory</B>
<dd>The directory name.
<dt><b>password</B>
<dd>Your password. (The ? instructs the server to prompt for a password if one is needed to gain access.)
<dt><b>/SAVEPW</B>
<dd>Instructs whether to save the password.
</DL>

<p>So a typical command might look something like the following:
</P>
<!-- CODE SNIP //-->
<pre>
   NET USE G: \\BigHonkinBox\Shared ? /SAVEPW:NO
</PRE>
<!-- END CODE SNIP //-->
<p>You can use commands such as the one above to assign network file server and printer connections. Admittedly, the syntax is somewhat kludgey. But batch files are easy to edit; so if you&#146;ve gone to the trouble of learning to use commands like those above, you can still use them. If you haven&#146;t bothered to learn to write these kinds of batch files and will have only Windows 2000 clients connecting to your system, you&#146;ll probably be better off with user profiles.
</P>
<p>You can also set a home directory for a user in the User Environment Profile dialog box. By default, the home directory is <tt>C:\Winnt\Profiles\Username</TT>. This directory will be the first directory to which all Open and Save dialog boxes will point. If, for example, a user is connecting to your system via the network, that user&#146;s home directory can be on his or her machine if you select the Connect To option and specify a path using the following syntax:</P>
<!-- CODE SNIP //-->
<pre>
   \\ComputerName\Directory
</PRE>
<!-- END CODE SNIP //-->
<p>If the user is logging on locally or if you want a network user&#146;s home directory to be on your system, select the Local Path option and specify the path.
</P>
<blockquote>
<p><font size="-1"><hr><b>NOTE:&nbsp;&nbsp;</B>When specifying a local home directory other than the default, you can type <b>%UserName%</B> in lieu of the user&#146;s name, and Windows 2000 will obtain the user&#146;s name from his or her logon information and set the home directory to that user. If the folder is located on an NTFS partition, Windows 2000 will create the home folder and set permissions for you. If it is on a FAT drive, you will need to manually create the subfolder for this home directory.<hr></FONT>
</BLOCKQUOTE>
<p>If you want to change a user&#146;s name (the username for logging on, that is), use the Rename command, which is in the context menu if you right-click an account.
</P>
<p>You can modify a user&#146;s properties and access rights in much the same way you initially create a new user, the only difference being that you double-click the specific user&#146;s name whose properties or access rights you want to modify.</P>
<h4 align="LEFT"><a name="Heading16"></A><font color="#000077">Creating a New Local Group</FONT></H4>
<p>Windows 2000 Professional has two levels of hierarchy for administering other users accessing your system locally or via your LAN. We covered users above, but you use the next level in the hierarchy, groups, to assign access rights&#151;what users can and cannot do on your system.
</P>
<blockquote>
<p><font size="-1"><hr><b>NOTE:&nbsp;&nbsp;</B>A local group that you create on your system is local to your system <i>only</I>. If your office runs Windows 2000 Server as your main network operating system, any local groups you create will <i>not</I> become part of your Windows 2000 Server file server&#146;s hierarchy.<hr></FONT>
</BLOCKQUOTE>
<p>Creating a new local group for your system is similar to creating a new user. Here&#146;s how to create a local group on your system:
</P>
<dl>
<dd><b>1.</B>&nbsp;&nbsp;In the Local Users and Groups console, right-click the Groups folder in the left pane and select New Group.
<dd><b>2.</B>&nbsp;&nbsp;In the New Group dialog box, name the new group and briefly describe it.
<dd><b>3.</B>&nbsp;&nbsp;Click the Add button to add new users to this group.
<dd><b>4.</B>&nbsp;&nbsp;In the Add Users and Groups dialog box, add users by selecting them and clicking the Add button. Note that you can see user lists from either your Windows 2000 machine, or from the domains on your network.
<dd><b>5.</B>&nbsp;&nbsp;Add users or global groups to your local group. To add users, you have a choice. You can browse through the list of users and groups, or as the note in the bottom pane tells you, you can type in the names directly. If there are multiple accounts to add, separate them by semicolons.
<dd><b>6.</B>&nbsp;&nbsp;After you add all the users to the new group, click OK to exit the Select Users or Groups dialog box and then click OK once more to close the group Properties dialog. Your group has now been created, and you&#146;re ready to grant rights to that group (and its members).
<dd><b>7.</B>&nbsp;&nbsp;From the Administrative Tools folder, open Local Security Policy. In the left pane of the Local Security Policy console, expand the Local Policies console tree and click User Rights Assignments.
<dd><b>8.</B>&nbsp;&nbsp;In the right pane, double-click the user right you want to modify, and click the Add button to open the Select Users or Groups dialog. Add the users or groups that you want to have this right, then click the OK button.
<dd><b>9.</B>&nbsp;&nbsp;In the Local Security Policy Setting dialog box, click the OK button to save your rights assignment.
<dd><b>10.</B>&nbsp;&nbsp;Repeat steps 8 and 9 for all additional rights you want to grant this new group. When you&#146;ve finished granting all desired rights to the new group, close the Local Security Policy console.
</DL>
<p><br></P>
<center>
<table border>
<tr>
<td><a href="985-987.html">Previous</A></TD>
<td><a href="../ewtoc.html">Table of Contents</A></TD>
<td><a href="990-993.html">Next</A></TD>
</TR>
</TABLE>
</CENTER>


</font></BODY></HTML>