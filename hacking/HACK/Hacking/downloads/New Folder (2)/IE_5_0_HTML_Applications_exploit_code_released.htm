<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<!-- Version = 2.0 TNG -->
<HEAD>
	<meta name="Description" content="SecuriTeam, a small group of people dedicated to bringing you the latest news and utilities in Computer Security.">
	<meta name="Keywords" content="security news exploits securiteam hack root intrusion detection windows windowsnt nt server unix linux solaris sunos aix audit firewall scanner internet intranet vulnerability phreak redhat suse debian rootshell maximum tcpip udp tcp cryptography hunt session hijack reset ack syn rst study guide">
	<!-- Please don't cache - The site is constantly updated -->
	<META HTTP-EQUIV="expires" content="01 Jan  1998 01:01:00 GMT">
	<TITLE>SecuriTeam.com (IE 5.0 HTML Applications exploit code released)</TITLE>
</HEAD>
<BODY bgColor=white>
<CENTER>
<TABLE border=0 cellPadding=0 cellSpacing=1 rules=rows width=700>
  <TR>
	<TD bgColor=black height=1><IMG border=0 height=1 src="http://www.securiteam.com/space.gif"></TD>
  </TR>
  <TR>
	<TD bgColor=blue style="font-size: 11pt">&nbsp;<FONT color=white><B>SecuriTeam.com</B></FONT></TD>
  </TR>
  <TR>
	<TD bgColor=black height=1><IMG border=0 height=1 src="http://www.securiteam.com/space.gif"></TD>
  </TR>
<!--  <TR>
	<TD>&nbsp;</TD>
  </TR>-->
  <TR>
	<TD bgColor=black height=1><IMG border=0 height=1 src="http://www.securiteam.com/space.gif"></TD>
  </TR>
  <TR>
	<TD>
	  <TABLE border=0 cellPadding=0 cellSpacing=2 rules=cols width=700 ALIGN=CENTER>
		<TR bgColor=silver>
		<td>
			<table cellspacing="0" cellpadding="0" border="0">
			<tr>
				<td style="font-size: 11pt">&nbsp;<A href="http://www.securiteam.com/">Home</A>&nbsp;|</td>
				<td style="font-size: 11pt">&nbsp;<A href="http://www.securiteam.com/search/">Search</A>&nbsp;|</td>
				<td style="font-size: 11pt">&nbsp;<A href="http://www.securiteam.com/aboutus.html">About Us</A>&nbsp;|</td>
				<td style="font-size: 11pt">&nbsp;<A href="http://www.securiteam.com/askus.html">Ask the Team</A>&nbsp;|</td>
				<td style="font-size: 11pt">&nbsp;<A href="http://www.securiteam.com/securitynews/">Security News</A>&nbsp;|</td>
				<td style="font-size: 11pt">&nbsp;<A href="http://www.securiteam.com/securityreviews/">Security Reviews</A>&nbsp;|</td>
				<td style="font-size: 11pt">&nbsp;<A href="http://www.securiteam.com/exploits/">Exploits</A>&nbsp;|</td>
				<td style="font-size: 11pt">&nbsp;<A href="http://www.securiteam.com/tools/">Tools</A>&nbsp;|</td>
			</tr>
			</table>
		</td>
		<TD bgColor=black width=1><IMG border=0 height=1 src="http://www.securiteam.com/space.gif" width=1></TD>
		  <TD style="font-size: 10pt" align="CENTER" width="70">
			<SCRIPT language=JavaScript>
				var now = new Date();
				var monthName = now.getMonth() + 1;
				var dayNumber = now.getDate();
				Year = now.getYear();
				if(monthName==1) Month="Jan";
				if(monthName==2) Month="Feb";
				if(monthName==3) Month="Mar";
				if(monthName==4) Month="Apr";
				if(monthName==5) Month="May";
				if(monthName==6) Month="Jun";
				if(monthName==7) Month="Jul";
				if(monthName==8) Month="Aug";
				if(monthName==9) Month="Sep";
				if(monthName==10) Month="Oct";
				if(monthName==11) Month="Nov";
				if(monthName==12) Month="Dec";
				document.open();
				document.write( "<font color=\"Black\">"+dayNumber + " " + Month + " " + Year+"</font>");
				</SCRIPT>
			</TD>
		</TR>
	  </TABLE>
	</TD>
  </TR>
  <TR>
	<TD bgColor=black height=1><IMG border=0 height=1 src="http://www.securiteam.com/space.gif"></TD>
  </TR>
  <TR>
	<TD align="middle">
	  <A name=top>&nbsp;</A>
	  <TABLE border=0 cellPadding=0 cellSpacing=0 rules=cols width=650>
		<TR>
		  <TD align="middle">
			<TABLE align=center border=0 cellPadding=0 cellSpacing=1 width=550>
			  <TR>
				<TD align=left bgColor=navy width=500>&nbsp;<FONT color=white><B style="font-size: 12pt">Article Title</B></FONT>
				</TD>
				<TD bgColor=navy><DIV ALIGN=RIGHT><FONT color=white><B style="font-size: 11pt">24/8/99</B></FONT></DIV>
 				</TD>
			  </TR>
			  <TR>
				<TD colSpan=2>
				  <CENTER>
				  <TABLE border=0>
					<TR>
					  <TD ALIGN=CENTER colSpan=2><B style="font-size: 15pt">IE 5.0 HTML Applications exploit code released<br>
<br>
					  </B></TD>
					</TR>
				  </TABLE>
				  </CENTER>
				</TD>
			  </TR>
			  <TR>
				<TD bgColor=black colSpan=2 height=1><IMG border=0 height=1 src="http://www.securiteam.com/space.gif"></TD>
			  </TR>
			  <TR>
				<TD>&nbsp;</TD>
			  </TR>
			  <TR>
				<TD align=left bgColor=navy colSpan=2>&nbsp;<FONT color=white><B style="font-size: 12pt">Article Summary</B></FONT>
				</TD>
			  </TR>
			  <TR>
				<TD colSpan=2>
				  <TABLE border=0>
					<TR>
					  <TD colSpan=2 style="font-size: 11pt">The dangers of using HTML applications (.hta) have been discussed 
previously. This theoretical threat has now been proven and can be 
tested for, by using the attached exploit code. <br>

The HTA exploit code displays a pop up frame that contains some 
trivial text and a VBScript that will download an executable from a 
specified web site. The script places the executable in the Windows 
98 startup group and uploads any .PWL (windows password) files that 
exist in the Windows Root directory.<br>
</TD>
					</TR>
				  </TABLE>
				</TD>
			  </TR>
			  <TR>
				<TD bgColor=black colSpan=2 height=1><IMG border=0 height=1 src="http://www.securiteam.com/space.gif"></TD>
			  </TR>
			  <TR>
				<TD>&nbsp;</TD>
			  </TR>
			  <TR>	
				<TD align=left bgColor=navy colSpan=2>&nbsp;<FONT color=white><B style="font-size: 12pt">Article Details</B></FONT>
				</TD>
			  </TR>
			  <TR>
				<TD colSpan=2>
				  <TABLE border=0>
					<TR>
					  <TD colSpan=2 style="font-size: 11pt"><b>Details:</b><br>
This application works by using the Internet Explorer 5 and 
FileSystemObject ActiveX controls and some very simple scripting. The 
first thing the HTA does is use IE to view an exe file (renamed to a 
txt extension) on the remote web server. This places the exe into 
IE's cache for later retrieval.  This had to do be done because 
Microsoft has apparently gone through (not so) great lengths to 
prevent the writing of binary files through HTAs. Then the exploit 
code uses the FileSystemObject to move and rename our cached exe to a 
more suitable location (In this case the startup directory). This 
same technique can be used to Trojan any file the current user has 
access too. There is no visible reason why this should not also work 
under Windows NT.<br>
<br>
<b>Solution:</b><br>
Disable File Downloads or disassociate .HTA files from MSHTA.exe.  
Disabling scripting does not eliminate the threat since the fact that 
the HTA is on the local system at the time of execution makes the 
script trusted.<br>
</TD>
						</TR>
				  </TABLE>
				</TD>
			  </TR>
			  <TR>
				<TD bgColor=black colSpan=2 height=1><IMG border=0 height=1 src="http://www.securiteam.com/space.gif"></TD>
			  </TR>
			  <TR>
				<TD>&nbsp;</TD>
			  </TR>
			  <TR>
				<TD align=left bgColor=navy colSpan=2>&nbsp;<FONT color=white><B style="font-size: 12pt">Additional information</B></FONT>
				</TD>
			  </TR>
			  <TR>
				<TD colSpan=2>
                  <TABLE border=0>
                    <TR>
                      <TD colSpan=2 style="font-size: 11pt">The HTA exploit (provided by <A 
HREF="mailto:steve.posick@ESPN.COM">Steve Posick</A>) can be 
downloaded here: <a 
href="http://www.securiteam.com/exploits/hta.zip">http://www.securiteam.com/exploits/hta.zip</a>
</TD>
                    </TR>
                  </TABLE>
				</TD>
			  </TR>
			  <TR>
				<TD bgColor=black colSpan=2 height=1><IMG border=0 height=1 src="http://www.securiteam.com/space.gif"></TD>
			  </TR>
			  <TR>
				<TD>&nbsp;</TD>
			  </TR>
			</TABLE>
		  </TD>
		  <TD bgColor=black width=1><IMG border=0 height=1 src="http://www.securiteam.com/space.gif" width=1></TD>
		  <TD>&nbsp;</td>
		  <TD vAlign=top width=150 style="font-size:10pt">
			1. <a class=sidereferences href="TFS_Gateway_4_0_vulnerable_to_a_Denial_of_Service_attack.html">TFS Gateway 4.0 vulnerable to a Denial of Service attack</a><br><br>
2. <a class=sidereferences href="Lotus_Notes_Domino_Server_4_6_vulnerable_to_Denial_of_Service_Attack.html">Lotus Notes Domino Server 4.6 vulnerable to Denial of Service Attack</a><br><br>
3. <a class=sidereferences href="Patch_released_for_Sun_s__rpc_cmsd__buffer_overflow_vulnerability.html">Patch released for Sun's 'rpc.cmsd' buffer overflow vulnerability</a><br><br>
4. <a class=sidereferences href="Lotus_Notes_vulnerable_to_a_Denial_of_Service_attack.html">Lotus Notes vulnerable to a Denial of Service attack</a><br><br>
5. <a class=sidereferences href="IE_5_0_HTML_Applications_exploit_code_released.html">IE 5.0 HTML Applications exploit code released</a><br><br>
</H2>
			<div align="center"><A style="font-size: 10pt" href="email/IE_5_0_HTML_Applications_exploit_code_released.html" class="sidereferences"><img src="http://www.securiteam.com/email.gif" alt="" border="0"><br>E-Mail this article to a friend</a> </div>
			<BR><BR>
			<div align="center"><A style="font-size: 10pt" href="mailto:comments@securiteam.com?subject=IE 5.0 HTML Applications exploit code released" class="sidereferences"><img src="http://www.securiteam.com/email.gif" alt="" border="0"><br>Send us comments</a> </div>
		  </TD>
		</TR>
	  </TABLE>
	</TD>
  </TR>
  <TR>
	<TD>&nbsp; <!-- Just a space --></TD>
  </TR>
  <TR>
	<TD bgColor=black height=1><IMG border=0 height=1 src="http://www.securiteam.com/space.gif"></TD>
  </TR>
  <TR>
	<TD>
	  <TABLE border=0 cellPadding=0 cellSpacing=0 rules=cols width=700 height=15>
		<TR>
		  <TD width=650>&nbsp; </TD>
		  <TD bgColor=black height=1 width=1><IMG border=0 height=1 src="http://www.securiteam.com/space.gif"></TD>
		  <TD width=21 ALIGN=CENTER><A href="#top"><IMG border=0 height=15 src="http://www.securiteam.com/top.gif" width=15></A></TD>
		</TR>
	  </TABLE>
	</TD>
  </TR>
  <TR>
	<TD bgColor=black height=1><IMG border=0 height=1 src="http://www.securiteam.com/space.gif"></TD>
  </TR>
</TABLE>
</CENTER>

<CENTER>
<ADDRESS>
  <FONT size=-3>COPYRIGHT &copy; 1998-9 - SECURITEAM.COM, - ALL RIGHTS RESERVED</FONT><BR>
</ADDRESS>
</CENTER>
</BODY>
</HTML>
